{
  "timestamp": "2026-02-11T20:25:01.125Z",
  "totalRules": 76,
  "validRules": 76,
  "invalidRules": 0,
  "avgQualityScore": 8.869736842105263,
  "qualityDistribution": {
    "1-3": 0,
    "4-6": 0,
    "7-10": 76
  },
  "effectiveness": {
    "avgTpRate": 0.8763157894736842,
    "avgFpRate": 0.002631578947368421,
    "avgFieldValidity": 0.9372493734335837,
    "passedRules": 59,
    "failedRules": 17
  },
  "commonInvalidFields": [
    {
      "field": "EventID",
      "count": 20
    }
  ],
  "logsourceDistribution": {
    "network_connection": 22,
    "process_creation": 23,
    "image_load": 2,
    "ps_script": 2,
    "registry_set": 5,
    "security": 20,
    "file_event": 2
  },
  "levelDistribution": {
    "high": 71,
    "critical": 4,
    "medium": 1
  },
  "ruleAnalyses": [
    {
      "filePath": "rules/groups/sigma/suspicious_network_connection_to_cloud_apis_via_non-browser_process.yml",
      "rule": {
        "id": "3214374f-db2c-4f8b-a760-408e5d24b974",
        "title": "Suspicious Network Connection to Cloud APIs via Non-Browser Process",
        "status": "experimental",
        "description": "Detects network connections to legitimate cloud service APIs (Microsoft Graph, Dropbox) initiated by suspicious or unusual processes. Attackers use these services for bidirectional Command and Control (C2) to blend in with legitimate enterprise traffic, often exfiltrating data or receiving commands via obfuscated file formats.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.command_and_control",
          "attack.t1102.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_cloud_api": {
            "DestinationHostname": [
              "graph.microsoft.com",
              "api.dropboxapi.com",
              "content.dropboxapi.com"
            ],
            "Initiated": [
              true
            ],
            "DestinationPort": [
              443
            ]
          },
          "selection_suspicious_processes": {
            "Image": [
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\wscript.exe",
              "*\\cscript.exe",
              "*\\mshta.exe",
              "*\\rundll32.exe",
              "*\\regsvr32.exe",
              "*\\certutil.exe",
              "*\\bitsadmin.exe",
              "*\\vbc.exe",
              "*\\csc.exe",
              "*\\scrcons.exe"
            ]
          },
          "filter_legitimate_apps": {
            "Image": [
              "*\\chrome.exe",
              "*\\msedge.exe",
              "*\\firefox.exe",
              "*\\brave.exe",
              "*\\iexplore.exe",
              "*\\Dropbox.exe",
              "*\\OneDrive.exe",
              "*\\Teams.exe",
              "*\\Outlook.exe"
            ]
          },
          "condition": "selection_cloud_api and selection_suspicious_processes and not filter_legitimate_apps"
        },
        "falsepositives": [
          "Administrative PowerShell scripts using Microsoft Graph SDK for automation or reporting",
          "Legitimate use of BITS or CertUtil by system administrators to download files from trusted cloud storage",
          "Custom line-of-business applications compiled with vbc.exe or csc.exe that integrate with Dropbox or Office 365"
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection to Cloud APIs via Non-Browser Process\nid: 3214374f-db2c-4f8b-a760-408e5d24b974\nstatus: experimental\ndescription: Detects network connections to legitimate cloud service APIs (Microsoft Graph, Dropbox) initiated by suspicious or unusual processes. Attackers use these services for bidirectional Command and Control (C2) to blend in with legitimate enterprise traffic, often exfiltrating data or receiving commands via obfuscated file formats.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.command_and_control\n  - attack.t1102.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_cloud_api:\n    DestinationHostname:\n      - graph.microsoft.com\n      - api.dropboxapi.com\n      - content.dropboxapi.com\n    Initiated:\n      - true\n    DestinationPort:\n      - 443\n  selection_suspicious_processes:\n    Image:\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\wscript.exe\"\n      - \"*\\\\cscript.exe\"\n      - \"*\\\\mshta.exe\"\n      - \"*\\\\rundll32.exe\"\n      - \"*\\\\regsvr32.exe\"\n      - \"*\\\\certutil.exe\"\n      - \"*\\\\bitsadmin.exe\"\n      - \"*\\\\vbc.exe\"\n      - \"*\\\\csc.exe\"\n      - \"*\\\\scrcons.exe\"\n  filter_legitimate_apps:\n    Image:\n      - \"*\\\\chrome.exe\"\n      - \"*\\\\msedge.exe\"\n      - \"*\\\\firefox.exe\"\n      - \"*\\\\brave.exe\"\n      - \"*\\\\iexplore.exe\"\n      - \"*\\\\Dropbox.exe\"\n      - \"*\\\\OneDrive.exe\"\n      - \"*\\\\Teams.exe\"\n      - \"*\\\\Outlook.exe\"\n  condition: selection_cloud_api and selection_suspicious_processes and not filter_legitimate_apps\nfalsepositives:\n  - Administrative PowerShell scripts using Microsoft Graph SDK for automation or reporting\n  - Legitimate use of BITS or CertUtil by system administrators to download files from trusted cloud storage\n  - Custom line-of-business applications compiled with vbc.exe or csc.exe that integrate with Dropbox or Office 365\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "3214374f-db2c-4f8b-a760-408e5d24b974",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "DestinationHostname",
          "Initiated",
          "DestinationPort",
          "Image"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/groups/sigma/suspicious_process_injection_into_system_processes_via_shellcode_loader.yml",
      "rule": {
        "id": "d78f5d70-f208-473a-ac84-708016d215d5",
        "title": "Suspicious Process Injection into System Processes via Shellcode Loader",
        "status": "experimental",
        "description": "Detects suspicious process relationships and command-line patterns indicative of shellcode injection into system processes like taskhost.exe or sihost.exe. This behavior aligns with TTPs where NtMapViewOfSection and NtSetContextThread are used to redirect execution flow in a suspended state.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1055.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_targets": {
            "Image": [
              "*\\taskhost.exe",
              "*\\sihost.exe",
              "*\\taskhostw.exe"
            ]
          },
          "selection_suspicious_parents": {
            "ParentImage": [
              "*\\Users\\*",
              "*\\Downloads\\*",
              "*\\Temp\\*",
              "*\\AppData\\*"
            ],
            "ParentCommandLine": [
              "*.exe*",
              "*powershell*",
              "*cmd.exe /c*"
            ]
          },
          "filter_legitimate_system": {
            "ParentImage": [
              "*\\Windows\\System32\\services.exe",
              "*\\Windows\\System32\\svchost.exe",
              "*\\Windows\\System32\\winlogon.exe"
            ],
            "IntegrityLevel": [
              "System"
            ]
          },
          "filter_user_init": {
            "ParentCommandLine": [
              "*C:\\Windows\\system32\\userinit.exe*"
            ]
          },
          "condition": "selection_targets and selection_suspicious_parents and not (filter_legitimate_system or filter_user_init)"
        },
        "falsepositives": [
          "Legitimate system initialization processes where taskhost.exe is spawned by a user-mode process during login",
          "Security software or management agents that perform legitimate monitoring or injection for diagnostic purposes"
        ],
        "level": "high",
        "raw": "title: Suspicious Process Injection into System Processes via Shellcode Loader\nid: d78f5d70-f208-473a-ac84-708016d215d5\nstatus: experimental\ndescription: Detects suspicious process relationships and command-line patterns indicative of shellcode injection into system processes like taskhost.exe or sihost.exe. This behavior aligns with TTPs where NtMapViewOfSection and NtSetContextThread are used to redirect execution flow in a suspended state.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1055.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_targets:\n    Image:\n      - \"*\\\\taskhost.exe\"\n      - \"*\\\\sihost.exe\"\n      - \"*\\\\taskhostw.exe\"\n  selection_suspicious_parents:\n    ParentImage:\n      - \"*\\\\Users\\\\*\"\n      - \"*\\\\Downloads\\\\*\"\n      - \"*\\\\Temp\\\\*\"\n      - \"*\\\\AppData\\\\*\"\n    ParentCommandLine:\n      - \"*.exe*\"\n      - \"*powershell*\"\n      - \"*cmd.exe /c*\"\n  filter_legitimate_system:\n    ParentImage:\n      - \"*\\\\Windows\\\\System32\\\\services.exe\"\n      - \"*\\\\Windows\\\\System32\\\\svchost.exe\"\n      - \"*\\\\Windows\\\\System32\\\\winlogon.exe\"\n    IntegrityLevel:\n      - System\n  filter_user_init:\n    ParentCommandLine:\n      - \"*C:\\\\Windows\\\\system32\\\\userinit.exe*\"\n  condition: selection_targets and selection_suspicious_parents and not (filter_legitimate_system or filter_user_init)\nfalsepositives:\n  - Legitimate system initialization processes where taskhost.exe is spawned by a user-mode process during login\n  - Security software or management agents that perform legitimate monitoring or injection for diagnostic purposes\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "d78f5d70-f208-473a-ac84-708016d215d5",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "ParentImage",
          "ParentCommandLine",
          "IntegrityLevel"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/groups/sigma/dll_side-loading_of_appvisvsubsystems64_via_legitimate_microsoft_word_binary.yml",
      "rule": {
        "id": "71491b59-826b-406b-acd4-3ada5afb1939",
        "title": "DLL Side-Loading of AppVIsvSubsystems64 via Legitimate Microsoft Word Binary",
        "status": "experimental",
        "description": "Detects the loading of a potentially malicious DLL named APPVISVSUBSYSTEMS64.dll by a process named windoc.exe (often a renamed or legitimate Microsoft Word binary). This pattern is indicative of DLL side-loading, where a signed executable is used to load an unsigned or malicious library from the same directory to bypass security controls.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.defense_evasion",
          "attack.t1574.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "image_load"
        },
        "detection": {
          "selection_binary": {
            "Image": [
              "*\\windoc.exe"
            ]
          },
          "selection_dll": {
            "ImageLoaded": [
              "*\\AppVIsvSubsystems64.dll"
            ]
          },
          "filter_legitimate_location": {
            "Image": [
              "C:\\Program Files\\Microsoft Office\\*",
              "C:\\Program Files (x86)\\Microsoft Office\\*"
            ],
            "Signed": true,
            "SignatureStatus": "Valid"
          },
          "condition": "selection_binary and selection_dll and not filter_legitimate_location"
        },
        "falsepositives": [
          "Legitimate Microsoft Office virtualization components running from standard installation paths",
          "Internal software development projects using similar naming conventions for testing App-V integration"
        ],
        "level": "high",
        "raw": "title: DLL Side-Loading of AppVIsvSubsystems64 via Legitimate Microsoft Word Binary\nid: 71491b59-826b-406b-acd4-3ada5afb1939\nstatus: experimental\ndescription: Detects the loading of a potentially malicious DLL named APPVISVSUBSYSTEMS64.dll by a process named windoc.exe (often a renamed or legitimate Microsoft Word binary). This pattern is indicative of DLL side-loading, where a signed executable is used to load an unsigned or malicious library from the same directory to bypass security controls.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.defense_evasion\n  - attack.t1574.002\nlogsource:\n  product: windows\n  category: image_load\ndetection:\n  selection_binary:\n    Image:\n      - \"*\\\\windoc.exe\"\n  selection_dll:\n    ImageLoaded:\n      - \"*\\\\AppVIsvSubsystems64.dll\"\n  filter_legitimate_location:\n    Image:\n      - C:\\Program Files\\Microsoft Office\\*\n      - C:\\Program Files (x86)\\Microsoft Office\\*\n    Signed: true\n    SignatureStatus: Valid\n  condition: selection_binary and selection_dll and not filter_legitimate_location\nfalsepositives:\n  - Legitimate Microsoft Office virtualization components running from standard installation paths\n  - Internal software development projects using similar naming conventions for testing App-V integration\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "71491b59-826b-406b-acd4-3ada5afb1939",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "ImageLoaded",
          "Signed",
          "SignatureStatus"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/groups/sigma/html_smuggling_payload_assembly_via_powershell_scriptblock.yml",
      "rule": {
        "id": "f265f665-66fd-4cf5-9251-f450594fca37",
        "title": "HTML Smuggling Payload Assembly via PowerShell ScriptBlock",
        "status": "experimental",
        "description": "Detects PowerShell script blocks containing patterns associated with HTML smuggling and local payload assembly. This includes the use of Blob objects, URL.createObjectURL, or msSaveOrOpenBlob methods combined with large encoded strings or XOR decoding logic, often used to bypass perimeter security by reconstructing malicious files (like ISO or ZIP) directly in the browser or via HTA files.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1027.006"
        ],
        "logsource": {
          "product": "windows",
          "category": "ps_script",
          "service": "powershell"
        },
        "detection": {
          "selection_smuggling_methods": {
            "ScriptBlockText": [
              "*msSaveOrOpenBlob*",
              "*createObjectURL*",
              "*window.URL.createObjectURL*",
              "*navigator.msSaveBlob*"
            ]
          },
          "selection_payload_indicators": {
            "ScriptBlockText": [
              "*application/octet-stream*",
              "*.iso*",
              "*.zip*",
              "*.hta*",
              "*fromCharArray*",
              "*base64*"
            ]
          },
          "selection_obfuscation": {
            "ScriptBlockText": [
              "*bxor*",
              "*-bxor*",
              "*.CharCodeAt*",
              "*String.fromCharCode*"
            ]
          },
          "filter_legitimate_web_apps": {
            "Path": [
              "*\\AzureAD\\*",
              "*\\Microsoft\\Teams\\*",
              "*\\WebEx\\*"
            ]
          },
          "filter_developer_tools": {
            "ScriptBlockText": [
              "*webpack*",
              "*angular*",
              "*react-dom*"
            ]
          },
          "condition": "(selection_smuggling_methods and (selection_payload_indicators or selection_obfuscation)) and not (filter_legitimate_web_apps or filter_developer_tools)"
        },
        "falsepositives": [
          "Legitimate web applications that use Blob objects for client-side file generation (e.g., exporting CSVs or PDF reports).",
          "Internal administrative tools that use HTA or PowerShell to package diagnostic logs into ZIP files.",
          "Web-based development environments or IDEs that handle file objects locally."
        ],
        "level": "high",
        "raw": "title: HTML Smuggling Payload Assembly via PowerShell ScriptBlock\nid: f265f665-66fd-4cf5-9251-f450594fca37\nstatus: experimental\ndescription: Detects PowerShell script blocks containing patterns associated with HTML smuggling and local payload assembly. This includes the use of Blob objects, URL.createObjectURL, or msSaveOrOpenBlob methods combined with large encoded strings or XOR decoding logic, often used to bypass perimeter security by reconstructing malicious files (like ISO or ZIP) directly in the browser or via HTA files.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1027.006\nlogsource:\n  product: windows\n  category: ps_script\n  service: powershell\ndetection:\n  selection_smuggling_methods:\n    ScriptBlockText:\n      - \"*msSaveOrOpenBlob*\"\n      - \"*createObjectURL*\"\n      - \"*window.URL.createObjectURL*\"\n      - \"*navigator.msSaveBlob*\"\n  selection_payload_indicators:\n    ScriptBlockText:\n      - \"*application/octet-stream*\"\n      - \"*.iso*\"\n      - \"*.zip*\"\n      - \"*.hta*\"\n      - \"*fromCharArray*\"\n      - \"*base64*\"\n  selection_obfuscation:\n    ScriptBlockText:\n      - \"*bxor*\"\n      - \"*-bxor*\"\n      - \"*.CharCodeAt*\"\n      - \"*String.fromCharCode*\"\n  filter_legitimate_web_apps:\n    Path:\n      - \"*\\\\AzureAD\\\\*\"\n      - \"*\\\\Microsoft\\\\Teams\\\\*\"\n      - \"*\\\\WebEx\\\\*\"\n  filter_developer_tools:\n    ScriptBlockText:\n      - \"*webpack*\"\n      - \"*angular*\"\n      - \"*react-dom*\"\n  condition: (selection_smuggling_methods and (selection_payload_indicators or selection_obfuscation)) and not (filter_legitimate_web_apps or filter_developer_tools)\nfalsepositives:\n  - Legitimate web applications that use Blob objects for client-side file generation (e.g., exporting CSVs or PDF reports).\n  - Internal administrative tools that use HTA or PowerShell to package diagnostic logs into ZIP files.\n  - Web-based development environments or IDEs that handle file objects locally.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Logsource combination not found in catalog: product=\"windows\", category=\"ps_script\", service=\"powershell\""
        ]
      },
      "qualityScore": {
        "ruleId": "f265f665-66fd-4cf5-9251-f450594fca37",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ScriptBlockText",
          "Path"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": true
      }
    },
    {
      "filePath": "rules/groups/sigma/suspicious_network_connection_to_url_shorteners_via_office_applications.yml",
      "rule": {
        "id": "993adb40-9537-4d4a-99a4-7789063af261",
        "title": "Suspicious Network Connection to URL Shorteners via Office Applications",
        "status": "experimental",
        "description": "Detects network connections initiated by Microsoft Office applications to common URL shortening services. This behavior is frequently associated with spearphishing campaigns where malicious links are embedded in documents to redirect users to credential harvesting sites or malware delivery platforms, as seen in campaigns targeting diplomatic entities.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1566.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_office_apps": {
            "Image": [
              "*\\winword.exe",
              "*\\excel.exe",
              "*\\powerpnt.exe",
              "*\\outlook.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_shorteners": {
            "DestinationHostname": [
              "t.ly",
              "tinyurl.com",
              "bit.ly",
              "cutt.ly",
              "rebrand.ly",
              "is.gd",
              "buff.ly"
            ],
            "DestinationPort": [
              80,
              443
            ]
          },
          "filter_legitimate_updates": {
            "DestinationHostname": [
              "*.microsoft.com",
              "*.office.com",
              "*.windowsupdate.com"
            ]
          },
          "condition": "selection_office_apps and selection_shorteners and not filter_legitimate_updates"
        },
        "falsepositives": [
          "Legitimate business documents containing shortened links for marketing tracking or simplified resource sharing",
          "Third-party Office add-ins that use URL shorteners for telemetry or update checks"
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection to URL Shorteners via Office Applications\nid: 993adb40-9537-4d4a-99a4-7789063af261\nstatus: experimental\ndescription: Detects network connections initiated by Microsoft Office applications to common URL shortening services. This behavior is frequently associated with spearphishing campaigns where malicious links are embedded in documents to redirect users to credential harvesting sites or malware delivery platforms, as seen in campaigns targeting diplomatic entities.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1566.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_office_apps:\n    Image:\n      - \"*\\\\winword.exe\"\n      - \"*\\\\excel.exe\"\n      - \"*\\\\powerpnt.exe\"\n      - \"*\\\\outlook.exe\"\n    Initiated:\n      - true\n  selection_shorteners:\n    DestinationHostname:\n      - t.ly\n      - tinyurl.com\n      - bit.ly\n      - cutt.ly\n      - rebrand.ly\n      - is.gd\n      - buff.ly\n    DestinationPort:\n      - 80\n      - 443\n  filter_legitimate_updates:\n    DestinationHostname:\n      - \"*.microsoft.com\"\n      - \"*.office.com\"\n      - \"*.windowsupdate.com\"\n  condition: selection_office_apps and selection_shorteners and not filter_legitimate_updates\nfalsepositives:\n  - Legitimate business documents containing shortened links for marketing tracking or simplified resource sharing\n  - Third-party Office add-ins that use URL shorteners for telemetry or update checks\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "993adb40-9537-4d4a-99a4-7789063af261",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationHostname",
          "DestinationPort"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/activity/sigma/masquerading_winrar_as_vmware_utility.yml",
      "rule": {
        "id": "3924263b-c51f-4023-80fa-70b6c408d4f9",
        "title": "Masquerading WinRAR as VMware Utility",
        "status": "experimental",
        "description": "Detects the execution of a renamed WinRAR utility masquerading as 'VMware.exe'. This technique is used by threat actors to evade detection while compressing and splitting sensitive data into chunks for exfiltration, as seen in campaigns targeting government and defense sectors.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1036.003",
          "attack.exfiltration",
          "attack.t1020"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_masquerade": {
            "Image": [
              "*\\VMware.exe"
            ],
            "OriginalFileName": [
              "WinRAR.exe",
              "Rar.exe"
            ]
          },
          "selection_behavior": {
            "CommandLine": [
              "* -v3M *",
              "* -v3072k *",
              "* a *",
              "* m *"
            ],
            "Description": [
              "*WinRAR*",
              "*RAR Archiver*"
            ]
          },
          "filter_legitimate_vmware": {
            "Company": [
              "VMware, Inc.",
              "Broadcom"
            ],
            "CommandLine": [
              "*--version*",
              "*-v*"
            ]
          },
          "filter_system_user": {
            "User": [
              "NT AUTHORITY\\SYSTEM"
            ],
            "ParentImage": [
              "*\\Windows\\System32\\services.exe"
            ]
          },
          "condition": "(selection_masquerade or selection_behavior) and not (filter_legitimate_vmware or filter_system_user)"
        },
        "falsepositives": [
          "Legitimate VMware utilities that might be misidentified by generic command line flags",
          "Administrative scripts using portable versions of WinRAR renamed for internal deployment purposes",
          "Software packaging tools that bundle compression utilities under different names"
        ],
        "level": "high",
        "raw": "title: Masquerading WinRAR as VMware Utility\nid: 3924263b-c51f-4023-80fa-70b6c408d4f9\nstatus: experimental\ndescription: Detects the execution of a renamed WinRAR utility masquerading as 'VMware.exe'. This technique is used by threat actors to evade detection while compressing and splitting sensitive data into chunks for exfiltration, as seen in campaigns targeting government and defense sectors.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1036.003\n  - attack.exfiltration\n  - attack.t1020\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_masquerade:\n    Image:\n      - \"*\\\\VMware.exe\"\n    OriginalFileName:\n      - WinRAR.exe\n      - Rar.exe\n  selection_behavior:\n    CommandLine:\n      - \"* -v3M *\"\n      - \"* -v3072k *\"\n      - \"* a *\"\n      - \"* m *\"\n    Description:\n      - \"*WinRAR*\"\n      - \"*RAR Archiver*\"\n  filter_legitimate_vmware:\n    Company:\n      - VMware, Inc.\n      - Broadcom\n    CommandLine:\n      - \"*--version*\"\n      - \"*-v*\"\n  filter_system_user:\n    User:\n      - NT AUTHORITY\\SYSTEM\n    ParentImage:\n      - \"*\\\\Windows\\\\System32\\\\services.exe\"\n  condition: (selection_masquerade or selection_behavior) and not (filter_legitimate_vmware or filter_system_user)\nfalsepositives:\n  - Legitimate VMware utilities that might be misidentified by generic command line flags\n  - Administrative scripts using portable versions of WinRAR renamed for internal deployment purposes\n  - Software packaging tools that bundle compression utilities under different names\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "3924263b-c51f-4023-80fa-70b6c408d4f9",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "OriginalFileName",
          "CommandLine",
          "Description",
          "Company",
          "User",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/activity/sigma/persistence_via_china_chopper_webshell_registry_modification.yml",
      "rule": {
        "id": "1fd4d706-c496-4b32-8dc4-78839b251bd9",
        "title": "Persistence via China Chopper Webshell Registry Modification",
        "status": "experimental",
        "description": "Detects suspicious registry modifications associated with China Chopper webshell persistence or configuration on Microsoft Exchange servers. Attackers often use registry keys to store configuration data or facilitate persistence after exploiting vulnerabilities like ProxyLogon or ProxyShell.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1505.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "registry_set"
        },
        "detection": {
          "selection_iis_process": {
            "Image": [
              "*\\w3wp.exe",
              "*\\UMWorkerProcess.exe"
            ]
          },
          "selection_suspicious_keys": {
            "TargetObject": [
              "*\\CurrentControlSet\\Services\\MSExchange*",
              "*\\Software\\Microsoft\\ExchangeServer\\*",
              "*\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\*"
            ],
            "Details": [
              "*eval(*",
              "*Page.Load*",
              "*Request.Item*",
              "*unsafe*",
              "*CU2\\he\\debug*"
            ]
          },
          "filter_system_accounts": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "EventType": "RegSetValue"
          },
          "filter_legitimate_updates": {
            "Image": [
              "*\\msexchangerepl.exe",
              "*\\Microsoft.Exchange.Store.Worker.exe"
            ]
          },
          "condition": "selection_iis_process and selection_suspicious_keys and not (filter_system_accounts or filter_legitimate_updates)"
        },
        "falsepositives": [
          "Legitimate Exchange Server configuration changes during cumulative updates or service pack installations.",
          "Third-party Exchange security or monitoring agents that modify registry keys for diagnostic purposes."
        ],
        "level": "high",
        "raw": "title: Persistence via China Chopper Webshell Registry Modification\nid: 1fd4d706-c496-4b32-8dc4-78839b251bd9\nstatus: experimental\ndescription: Detects suspicious registry modifications associated with China Chopper webshell persistence or configuration on Microsoft Exchange servers. Attackers often use registry keys to store configuration data or facilitate persistence after exploiting vulnerabilities like ProxyLogon or ProxyShell.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1505.003\nlogsource:\n  product: windows\n  category: registry_set\ndetection:\n  selection_iis_process:\n    Image:\n      - \"*\\\\w3wp.exe\"\n      - \"*\\\\UMWorkerProcess.exe\"\n  selection_suspicious_keys:\n    TargetObject:\n      - \"*\\\\CurrentControlSet\\\\Services\\\\MSExchange*\"\n      - \"*\\\\Software\\\\Microsoft\\\\ExchangeServer\\\\*\"\n      - \"*\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp\\\\*\"\n    Details:\n      - \"*eval(*\"\n      - \"*Page.Load*\"\n      - \"*Request.Item*\"\n      - \"*unsafe*\"\n      - \"*CU2\\\\he\\\\debug*\"\n  filter_system_accounts:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    EventType: RegSetValue\n  filter_legitimate_updates:\n    Image:\n      - \"*\\\\msexchangerepl.exe\"\n      - \"*\\\\Microsoft.Exchange.Store.Worker.exe\"\n  condition: selection_iis_process and selection_suspicious_keys and not (filter_system_accounts or filter_legitimate_updates)\nfalsepositives:\n  - Legitimate Exchange Server configuration changes during cumulative updates or service pack installations.\n  - Third-party Exchange security or monitoring agents that modify registry keys for diagnostic purposes.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "1fd4d706-c496-4b32-8dc4-78839b251bd9",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "TargetObject",
          "Details",
          "User",
          "EventType"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/activity/sigma/exchange_application_impersonation_role_assignment_via_management_role.yml",
      "rule": {
        "id": "a515dd85-807b-4b4f-abd1-86bfcd6e6c9d",
        "title": "Exchange Application Impersonation Role Assignment via Management Role",
        "status": "experimental",
        "description": "Detects the assignment of the 'ApplicationImpersonation' management role to a user or service account. Threat actors abuse this role to gain full access to all mailboxes within an Exchange environment, allowing for data exfiltration and persistence without knowing individual user credentials.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1098.002"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_event": {
            "EventID": [
              4688,
              5136,
              4624
            ]
          },
          "selection_role_assignment": {
            "ProcessName": [
              "*\\powershell.exe",
              "*\\pwsh.exe"
            ],
            "ServiceName": [
              "*ApplicationImpersonation*",
              "*New-ManagementRoleAssignment*"
            ]
          },
          "filter_admin_defaults": {
            "SubjectUserName": [
              "EXCHANGE-ADMIN*",
              "MSOL_*",
              "ADSync*"
            ],
            "TargetUserName": [
              "Discovery Management",
              "Organization Management"
            ]
          },
          "condition": "selection_event and selection_role_assignment and not filter_admin_defaults"
        },
        "falsepositives": [
          "Legitimate migration tools (e.g., Bittitan, SkyKick) that require ApplicationImpersonation to move mailbox data.",
          "Internal service accounts for legitimate backup software or unified messaging solutions.",
          "Authorized administrative actions during initial Exchange environment setup or major configuration changes."
        ],
        "level": "high",
        "raw": "title: Exchange Application Impersonation Role Assignment via Management Role\nid: a515dd85-807b-4b4f-abd1-86bfcd6e6c9d\nstatus: experimental\ndescription: Detects the assignment of the 'ApplicationImpersonation' management role to a user or service account. Threat actors abuse this role to gain full access to all mailboxes within an Exchange environment, allowing for data exfiltration and persistence without knowing individual user credentials.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1098.002\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_event:\n    EventID:\n      - 4688\n      - 5136\n      - 4624\n  selection_role_assignment:\n    ProcessName:\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n    ServiceName:\n      - \"*ApplicationImpersonation*\"\n      - \"*New-ManagementRoleAssignment*\"\n  filter_admin_defaults:\n    SubjectUserName:\n      - EXCHANGE-ADMIN*\n      - MSOL_*\n      - ADSync*\n    TargetUserName:\n      - Discovery Management\n      - Organization Management\n  condition: selection_event and selection_role_assignment and not filter_admin_defaults\nfalsepositives:\n  - Legitimate migration tools (e.g., Bittitan, SkyKick) that require ApplicationImpersonation to move mailbox data.\n  - Internal service accounts for legitimate backup software or unified messaging solutions.\n  - Authorized administrative actions during initial Exchange environment setup or major configuration changes.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "a515dd85-807b-4b4f-abd1-86bfcd6e6c9d",
        "format": "sigma",
        "overallScore": 8.5,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 9,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ProcessName",
          "ServiceName",
          "SubjectUserName",
          "TargetUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/activity/sigma/lateral_movement_via_impacket_tools_wmi_smb_network_connection.yml",
      "rule": {
        "id": "366477ff-d35f-48a9-a502-a6ba980ba708",
        "title": "Lateral Movement via Impacket Tools (WMI/SMB) Network Connection",
        "status": "experimental",
        "description": "Detects network connections associated with Impacket's wmiexec.py and smbexec.py. These tools are used for lateral movement by executing commands on remote systems via WMI (port 135/445/dynamic) and SMB (port 445). The rule looks for outbound connections from non-standard processes or to administrative ports initiated by suspicious sources.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.lateral_movement",
          "attack.t1021.006",
          "attack.t1021.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_ports": {
            "DestinationPort": [
              135,
              445,
              5985,
              5986
            ],
            "Initiated": true
          },
          "selection_processes": {
            "Image": [
              "*\\python.exe",
              "*\\pythonw.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\cmd.exe",
              "*\\wmic.exe"
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "Image": [
              "*\\svchost.exe",
              "*\\msiexec.exe",
              "*\\System"
            ]
          },
          "filter_domain_controllers": {
            "DestinationHostname": [
              "*-DC-*",
              "AD-*"
            ]
          },
          "condition": "selection_ports and selection_processes and not (filter_legitimate_admin or filter_domain_controllers)"
        },
        "falsepositives": [
          "Legitimate administrative scripts using Python or PowerShell to manage remote Exchange or Windows environments",
          "Vulnerability scanners or asset management tools performing network discovery and remote interrogation",
          "Domain Controller replication or legitimate remote management by authorized IT personnel"
        ],
        "level": "high",
        "raw": "title: Lateral Movement via Impacket Tools (WMI/SMB) Network Connection\nid: 366477ff-d35f-48a9-a502-a6ba980ba708\nstatus: experimental\ndescription: Detects network connections associated with Impacket's wmiexec.py and smbexec.py. These tools are used for lateral movement by executing commands on remote systems via WMI (port 135/445/dynamic) and SMB (port 445). The rule looks for outbound connections from non-standard processes or to administrative ports initiated by suspicious sources.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.lateral_movement\n  - attack.t1021.006\n  - attack.t1021.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_ports:\n    DestinationPort:\n      - 135\n      - 445\n      - 5985\n      - 5986\n    Initiated: true\n  selection_processes:\n    Image:\n      - \"*\\\\python.exe\"\n      - \"*\\\\pythonw.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\wmic.exe\"\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    Image:\n      - \"*\\\\svchost.exe\"\n      - \"*\\\\msiexec.exe\"\n      - \"*\\\\System\"\n  filter_domain_controllers:\n    DestinationHostname:\n      - \"*-DC-*\"\n      - AD-*\n  condition: selection_ports and selection_processes and not (filter_legitimate_admin or filter_domain_controllers)\nfalsepositives:\n  - Legitimate administrative scripts using Python or PowerShell to manage remote Exchange or Windows environments\n  - Vulnerability scanners or asset management tools performing network discovery and remote interrogation\n  - Domain Controller replication or legitimate remote management by authorized IT personnel\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "366477ff-d35f-48a9-a502-a6ba980ba708",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "DestinationPort",
          "Initiated",
          "Image",
          "User",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/activity/sigma/exfiltration_to_onedrive_via_non-standard_process.yml",
      "rule": {
        "id": "26b42320-ee3d-452a-81d1-5be8e440bf3f",
        "title": "Exfiltration to OneDrive via Non-Standard Process",
        "status": "experimental",
        "description": "Detects network connections to Microsoft OneDrive (onedrive.live.com) initiated by processes that are not standard web browsers or the official OneDrive sync client. This behavior is consistent with custom exfiltration tools like CovalentStealer which target cloud storage for data theft.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.exfiltration",
          "attack.t1567.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_destination": {
            "DestinationHostname": [
              "*onedrive.live.com*",
              "*api.onedrive.com*",
              "*storage.live.com*"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_unusual_process": {
            "Image": [
              "*\\temp\\*",
              "*\\users\\public\\*",
              "*\\appdata\\local\\temp\\*",
              "*\\programdata\\*"
            ]
          },
          "filter_legitimate_clients": {
            "Image": [
              "*\\onedrive.exe",
              "*\\chrome.exe",
              "*\\msedge.exe",
              "*\\firefox.exe",
              "*\\brave.exe",
              "*\\iexplore.exe"
            ]
          },
          "filter_system_processes": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ]
          },
          "condition": "selection_destination and selection_unusual_process and not (filter_legitimate_clients or filter_system_processes)"
        },
        "falsepositives": [
          "Users running portable versions of web browsers from temporary directories or non-standard paths.",
          "Legitimate third-party backup or synchronization software that integrates with OneDrive but is not the official client.",
          "Internal developers testing applications that use the OneDrive API for legitimate file storage."
        ],
        "level": "high",
        "raw": "title: Exfiltration to OneDrive via Non-Standard Process\nid: 26b42320-ee3d-452a-81d1-5be8e440bf3f\nstatus: experimental\ndescription: Detects network connections to Microsoft OneDrive (onedrive.live.com) initiated by processes that are not standard web browsers or the official OneDrive sync client. This behavior is consistent with custom exfiltration tools like CovalentStealer which target cloud storage for data theft.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.exfiltration\n  - attack.t1567.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_destination:\n    DestinationHostname:\n      - \"*onedrive.live.com*\"\n      - \"*api.onedrive.com*\"\n      - \"*storage.live.com*\"\n    Initiated:\n      - true\n  selection_unusual_process:\n    Image:\n      - \"*\\\\temp\\\\*\"\n      - \"*\\\\users\\\\public\\\\*\"\n      - \"*\\\\appdata\\\\local\\\\temp\\\\*\"\n      - \"*\\\\programdata\\\\*\"\n  filter_legitimate_clients:\n    Image:\n      - \"*\\\\onedrive.exe\"\n      - \"*\\\\chrome.exe\"\n      - \"*\\\\msedge.exe\"\n      - \"*\\\\firefox.exe\"\n      - \"*\\\\brave.exe\"\n      - \"*\\\\iexplore.exe\"\n  filter_system_processes:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n  condition: selection_destination and selection_unusual_process and not (filter_legitimate_clients or filter_system_processes)\nfalsepositives:\n  - Users running portable versions of web browsers from temporary directories or non-standard paths.\n  - Legitimate third-party backup or synchronization software that integrates with OneDrive but is not the official client.\n  - Internal developers testing applications that use the OneDrive API for legitimate file storage.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "26b42320-ee3d-452a-81d1-5be8e440bf3f",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "DestinationHostname",
          "Initiated",
          "Image",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/black-basta/sigma/remote_access_tool_network_connection_via_anydesk_or_quick_assist.yml",
      "rule": {
        "id": "4fbdbaf7-a855-43f2-ac43-9defb36aa627",
        "title": "Remote Access Tool Network Connection via AnyDesk or Quick Assist",
        "status": "experimental",
        "description": "Detects network connections initiated by AnyDesk or Windows Quick Assist to known malicious IP addresses or general remote desktop infrastructure. This behavior is consistent with Black Basta affiliates using vishing and social engineering to trick users into installing remote access tools for initial access.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/10",
        "modified": "2026/02/10",
        "tags": [
          "attack.initial_access",
          "attack.t1566.004",
          "attack.t1219"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_tools": {
            "Image": [
              "*\\anydesk.exe",
              "*\\quickassist.exe"
            ]
          },
          "selection_iocs": {
            "DestinationIp": [
              "170.130.165.73",
              "45.11.181.44",
              "66.42.118.54",
              "79.132.130.211"
            ]
          },
          "selection_destinations": {
            "DestinationHostname": [
              "*moereng.com",
              "*exckicks.com"
            ]
          },
          "filter_initiated": {
            "Initiated": false
          },
          "condition": "(selection_tools or selection_iocs or selection_destinations) and not filter_initiated"
        },
        "falsepositives": [
          "Legitimate use of AnyDesk or Quick Assist by internal IT support teams",
          "Authorized third-party vendors performing remote maintenance",
          "Users seeking legitimate remote assistance for technical issues"
        ],
        "level": "high",
        "raw": "title: Remote Access Tool Network Connection via AnyDesk or Quick Assist\nid: 4fbdbaf7-a855-43f2-ac43-9defb36aa627\nstatus: experimental\ndescription: Detects network connections initiated by AnyDesk or Windows Quick Assist to known malicious IP addresses or general remote desktop infrastructure. This behavior is consistent with Black Basta affiliates using vishing and social engineering to trick users into installing remote access tools for initial access.\nauthor: DetectForge\ndate: 2026/02/10\nmodified: 2026/02/10\ntags:\n  - attack.initial_access\n  - attack.t1566.004\n  - attack.t1219\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_tools:\n    Image:\n      - \"*\\\\anydesk.exe\"\n      - \"*\\\\quickassist.exe\"\n  selection_iocs:\n    DestinationIp:\n      - 170.130.165.73\n      - 45.11.181.44\n      - 66.42.118.54\n      - 79.132.130.211\n  selection_destinations:\n    DestinationHostname:\n      - \"*moereng.com\"\n      - \"*exckicks.com\"\n  filter_initiated:\n    Initiated: false\n  condition: (selection_tools or selection_iocs or selection_destinations) and not filter_initiated\nfalsepositives:\n  - Legitimate use of AnyDesk or Quick Assist by internal IT support teams\n  - Authorized third-party vendors performing remote maintenance\n  - Users seeking legitimate remote assistance for technical issues\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "4fbdbaf7-a855-43f2-ac43-9defb36aa627",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "DestinationIp",
          "DestinationHostname",
          "Initiated"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/black-basta/sigma/inhibit_system_recovery_via_vssadmin_shadow_copy_deletion.yml",
      "rule": {
        "id": "ae87cd79-67c0-43be-97a0-15b278127511",
        "title": "Inhibit System Recovery via Vssadmin Shadow Copy Deletion",
        "status": "experimental",
        "description": "Detects the execution of vssadmin.exe with parameters to delete all volume shadow copies. This technique is a common precursor to ransomware encryption, such as Black Basta, to prevent victims from recovering data using local backups.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/10",
        "modified": "2026/02/10",
        "tags": [
          "attack.impact",
          "attack.t1490"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_vssadmin": {
            "Image": [
              "*\\vssadmin.exe"
            ],
            "CommandLine": [
              "*delete*",
              "*shadows*"
            ]
          },
          "selection_quiet": {
            "CommandLine": [
              "*/all*",
              "*/quiet*"
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM"
            ],
            "ParentImage": [
              "*\\services.exe",
              "*\\msiexec.exe"
            ]
          },
          "condition": "(selection_vssadmin and selection_quiet) and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Legitimate backup software performing maintenance tasks",
          "System administrators manually managing disk space during scheduled maintenance",
          "Windows Update or installer services managing system restore points"
        ],
        "level": "high",
        "raw": "title: Inhibit System Recovery via Vssadmin Shadow Copy Deletion\nid: ae87cd79-67c0-43be-97a0-15b278127511\nstatus: experimental\ndescription: Detects the execution of vssadmin.exe with parameters to delete all volume shadow copies. This technique is a common precursor to ransomware encryption, such as Black Basta, to prevent victims from recovering data using local backups.\nauthor: DetectForge\ndate: 2026/02/10\nmodified: 2026/02/10\ntags:\n  - attack.impact\n  - attack.t1490\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_vssadmin:\n    Image:\n      - \"*\\\\vssadmin.exe\"\n    CommandLine:\n      - \"*delete*\"\n      - \"*shadows*\"\n  selection_quiet:\n    CommandLine:\n      - \"*/all*\"\n      - \"*/quiet*\"\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n    ParentImage:\n      - \"*\\\\services.exe\"\n      - \"*\\\\msiexec.exe\"\n  condition: (selection_vssadmin and selection_quiet) and not filter_legitimate_admin\nfalsepositives:\n  - Legitimate backup software performing maintenance tasks\n  - System administrators manually managing disk space during scheduled maintenance\n  - Windows Update or installer services managing system restore points\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "ae87cd79-67c0-43be-97a0-15b278127511",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "User",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/black-basta/sigma/masquerading_softperfect_network_scanner_as_system_utility.yml",
      "rule": {
        "id": "b4c49818-216d-41d2-b1bb-f53009a6a619",
        "title": "Masquerading SoftPerfect Network Scanner as System Utility",
        "status": "experimental",
        "description": "Detects the execution of SoftPerfect Network Scanner (netscan.exe) renamed to common hardware-related filenames like 'intel.exe' or 'dell.exe'. This technique is used by threat actors to evade detection during internal network discovery phases.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/10",
        "modified": "2026/02/10",
        "tags": [
          "attack.defense_evasion",
          "attack.t1036.003",
          "attack.discovery",
          "attack.t1046"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_metadata": {
            "OriginalFileName": "netscan.exe"
          },
          "selection_renamed": {
            "Image": [
              "*\\intel.exe",
              "*\\dell.exe",
              "*\\svchost.exe",
              "*\\lsass.exe"
            ]
          },
          "selection_suspicious_path": {
            "Image": [
              "*\\AppData\\Local\\Temp\\*",
              "*\\Users\\Public\\*",
              "*\\ProgramData\\*"
            ],
            "CommandLine": [
              "*intel.exe*",
              "*dell.exe*"
            ]
          },
          "filter_legitimate_intel": {
            "Company": "Intel Corporation",
            "Image": [
              "C:\\Windows\\System32\\*",
              "C:\\Program Files\\Intel\\*",
              "C:\\Program Files (x86)\\Intel\\*"
            ]
          },
          "condition": "(selection_metadata and selection_renamed) or (selection_suspicious_path and not filter_legitimate_intel)"
        },
        "falsepositives": [
          "Legitimate portable versions of network utilities used by system administrators",
          "Software installers that bundle Intel or Dell drivers and extract them to temporary directories"
        ],
        "level": "high",
        "raw": "title: Masquerading SoftPerfect Network Scanner as System Utility\nid: b4c49818-216d-41d2-b1bb-f53009a6a619\nstatus: experimental\ndescription: Detects the execution of SoftPerfect Network Scanner (netscan.exe) renamed to common hardware-related filenames like 'intel.exe' or 'dell.exe'. This technique is used by threat actors to evade detection during internal network discovery phases.\nauthor: DetectForge\ndate: 2026/02/10\nmodified: 2026/02/10\ntags:\n  - attack.defense_evasion\n  - attack.t1036.003\n  - attack.discovery\n  - attack.t1046\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_metadata:\n    OriginalFileName: netscan.exe\n  selection_renamed:\n    Image:\n      - \"*\\\\intel.exe\"\n      - \"*\\\\dell.exe\"\n      - \"*\\\\svchost.exe\"\n      - \"*\\\\lsass.exe\"\n  selection_suspicious_path:\n    Image:\n      - \"*\\\\AppData\\\\Local\\\\Temp\\\\*\"\n      - \"*\\\\Users\\\\Public\\\\*\"\n      - \"*\\\\ProgramData\\\\*\"\n    CommandLine:\n      - \"*intel.exe*\"\n      - \"*dell.exe*\"\n  filter_legitimate_intel:\n    Company: Intel Corporation\n    Image:\n      - C:\\Windows\\System32\\*\n      - C:\\Program Files\\Intel\\*\n      - C:\\Program Files (x86)\\Intel\\*\n  condition: (selection_metadata and selection_renamed) or (selection_suspicious_path and not filter_legitimate_intel)\nfalsepositives:\n  - Legitimate portable versions of network utilities used by system administrators\n  - Software installers that bundle Intel or Dell drivers and extract them to temporary directories\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "b4c49818-216d-41d2-b1bb-f53009a6a619",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "OriginalFileName",
          "Image",
          "CommandLine",
          "Company"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/black-basta/sigma/disable_or_modify_security_tools_via_backstab_or_powershell.yml",
      "rule": {
        "id": "1360eaf1-742a-4beb-8686-3928cf166569",
        "title": "Disable or Modify Security Tools via Backstab or PowerShell",
        "status": "experimental",
        "description": "Detects the use of the Backstab tool or PowerShell commands to terminate, disable, or impair EDR and antivirus services. Threat actors use these methods to bypass host-based security defenses and execute payloads without interference.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/10",
        "modified": "2026/02/10",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562.001"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_backstab_process": {
            "EventID": 4688,
            "ProcessName": [
              "*\\backstab.exe",
              "*\\bstab.exe"
            ]
          },
          "selection_service_tamper": {
            "EventID": 4697,
            "ServiceName": [
              "*Sentinel*",
              "*CrowdStrike*",
              "*CarbonBlack*",
              "*Cylance*",
              "*WinDefend*",
              "*MpsSvc*"
            ]
          },
          "selection_network_iocs": {
            "IpAddress": [
              "170.130.165.73",
              "45.11.181.44",
              "66.42.118.54",
              "79.132.130.211"
            ]
          },
          "filter_system_accounts": {
            "SubjectUserName": [
              "SYSTEM",
              "NETWORK SERVICE",
              "LOCAL SERVICE"
            ]
          },
          "condition": "(selection_backstab_process or selection_service_tamper or selection_network_iocs) and not filter_system_accounts"
        },
        "falsepositives": [
          "Authorized security software updates or uninstallation by administrators",
          "Legitimate troubleshooting of security agents by IT staff",
          "Automated deployment scripts for security software that may stop services during upgrade"
        ],
        "level": "high",
        "raw": "title: Disable or Modify Security Tools via Backstab or PowerShell\nid: 1360eaf1-742a-4beb-8686-3928cf166569\nstatus: experimental\ndescription: Detects the use of the Backstab tool or PowerShell commands to terminate, disable, or impair EDR and antivirus services. Threat actors use these methods to bypass host-based security defenses and execute payloads without interference.\nauthor: DetectForge\ndate: 2026/02/10\nmodified: 2026/02/10\ntags:\n  - attack.defense_evasion\n  - attack.t1562.001\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_backstab_process:\n    EventID: 4688\n    ProcessName:\n      - \"*\\\\backstab.exe\"\n      - \"*\\\\bstab.exe\"\n  selection_service_tamper:\n    EventID: 4697\n    ServiceName:\n      - \"*Sentinel*\"\n      - \"*CrowdStrike*\"\n      - \"*CarbonBlack*\"\n      - \"*Cylance*\"\n      - \"*WinDefend*\"\n      - \"*MpsSvc*\"\n  selection_network_iocs:\n    IpAddress:\n      - 170.130.165.73\n      - 45.11.181.44\n      - 66.42.118.54\n      - 79.132.130.211\n  filter_system_accounts:\n    SubjectUserName:\n      - SYSTEM\n      - NETWORK SERVICE\n      - LOCAL SERVICE\n  condition: (selection_backstab_process or selection_service_tamper or selection_network_iocs) and not filter_system_accounts\nfalsepositives:\n  - Authorized security software updates or uninstallation by administrators\n  - Legitimate troubleshooting of security agents by IT staff\n  - Automated deployment scripts for security software that may stop services during upgrade\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "1360eaf1-742a-4beb-8686-3928cf166569",
        "format": "sigma",
        "overallScore": 8.9,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ProcessName",
          "ServiceName",
          "IpAddress",
          "SubjectUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/black-basta/sigma/lsass_memory_credential_dumping_via_mimikatz.yml",
      "rule": {
        "id": "c5473fab-d9a8-4b0a-b1e1-8d98d140c93b",
        "title": "LSASS Memory Credential Dumping via Mimikatz",
        "status": "experimental",
        "description": "Detects the execution of Mimikatz or tools with similar command-line arguments used to dump credentials from the Local Security Authority Subsystem Service (LSASS) memory. This activity is often preceded by privilege escalation via vulnerabilities like ZeroLogon, NoPac, or PrintNightmare.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/10",
        "modified": "2026/02/10",
        "tags": [
          "attack.credential_access",
          "attack.t1003.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_img": {
            "Image": [
              "*\\mimikatz.exe"
            ],
            "OriginalFileName": [
              "mimikatz.exe"
            ]
          },
          "selection_cli": {
            "CommandLine": [
              "*sekurlsa::logonpasswords*",
              "*sekurlsa::lsadump*",
              "*lsass.exe*",
              "*privilege::debug*",
              "*sekurlsa::*"
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM"
            ],
            "ParentImage": [
              "*\\services.exe"
            ]
          },
          "condition": "(selection_img or selection_cli) and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Authorized penetration testing activities",
          "Security researchers performing memory forensics",
          "Legacy administrative scripts (rare for Mimikatz)"
        ],
        "level": "critical",
        "raw": "title: LSASS Memory Credential Dumping via Mimikatz\nid: c5473fab-d9a8-4b0a-b1e1-8d98d140c93b\nstatus: experimental\ndescription: Detects the execution of Mimikatz or tools with similar command-line arguments used to dump credentials from the Local Security Authority Subsystem Service (LSASS) memory. This activity is often preceded by privilege escalation via vulnerabilities like ZeroLogon, NoPac, or PrintNightmare.\nauthor: DetectForge\ndate: 2026/02/10\nmodified: 2026/02/10\ntags:\n  - attack.credential_access\n  - attack.t1003.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_img:\n    Image:\n      - \"*\\\\mimikatz.exe\"\n    OriginalFileName:\n      - mimikatz.exe\n  selection_cli:\n    CommandLine:\n      - \"*sekurlsa::logonpasswords*\"\n      - \"*sekurlsa::lsadump*\"\n      - \"*lsass.exe*\"\n      - \"*privilege::debug*\"\n      - \"*sekurlsa::*\"\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n    ParentImage:\n      - \"*\\\\services.exe\"\n  condition: (selection_img or selection_cli) and not filter_legitimate_admin\nfalsepositives:\n  - Authorized penetration testing activities\n  - Security researchers performing memory forensics\n  - Legacy administrative scripts (rare for Mimikatz)\nlevel: critical\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "c5473fab-d9a8-4b0a-b1e1-8d98d140c93b",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "OriginalFileName",
          "CommandLine",
          "User",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/black-basta/sigma/exfiltration_to_cloud_storage_via_rclone_to_known_black_basta_infrastructure.yml",
      "rule": {
        "id": "757b39d9-1b73-40eb-8b53-54f555a0b5d0",
        "title": "Exfiltration to Cloud Storage via RClone to Known Black Basta Infrastructure",
        "status": "experimental",
        "description": "Detects outbound network connections to known IP addresses and domains associated with Black Basta exfiltration activity using RClone. Threat actors use RClone to sync or copy sensitive data to attacker-controlled cloud storage providers or servers prior to ransomware deployment.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/10",
        "modified": "2026/02/10",
        "tags": [
          "attack.exfiltration",
          "attack.t1567.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_iocs": {
            "DestinationIp": [
              "170.130.165.73",
              "45.11.181.44",
              "66.42.118.54",
              "79.132.130.211"
            ],
            "DestinationHostname": [
              "*moereng.com",
              "*exckicks.com"
            ]
          },
          "selection_rclone_process": {
            "Image": [
              "*\\rclone.exe"
            ]
          },
          "selection_initiated": {
            "Initiated": [
              true
            ]
          },
          "condition": "(selection_iocs or selection_rclone_process) and selection_initiated"
        },
        "falsepositives": [
          "Legitimate use of RClone by system administrators for cloud backups",
          "Automated server synchronization tasks to authorized cloud storage endpoints",
          "Development environments using RClone for container image or asset management"
        ],
        "level": "critical",
        "raw": "title: Exfiltration to Cloud Storage via RClone to Known Black Basta Infrastructure\nid: 757b39d9-1b73-40eb-8b53-54f555a0b5d0\nstatus: experimental\ndescription: Detects outbound network connections to known IP addresses and domains associated with Black Basta exfiltration activity using RClone. Threat actors use RClone to sync or copy sensitive data to attacker-controlled cloud storage providers or servers prior to ransomware deployment.\nauthor: DetectForge\ndate: 2026/02/10\nmodified: 2026/02/10\ntags:\n  - attack.exfiltration\n  - attack.t1567.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_iocs:\n    DestinationIp:\n      - 170.130.165.73\n      - 45.11.181.44\n      - 66.42.118.54\n      - 79.132.130.211\n    DestinationHostname:\n      - \"*moereng.com\"\n      - \"*exckicks.com\"\n  selection_rclone_process:\n    Image:\n      - \"*\\\\rclone.exe\"\n  selection_initiated:\n    Initiated:\n      - true\n  condition: (selection_iocs or selection_rclone_process) and selection_initiated\nfalsepositives:\n  - Legitimate use of RClone by system administrators for cloud backups\n  - Automated server synchronization tasks to authorized cloud storage endpoints\n  - Development environments using RClone for container image or asset management\nlevel: critical\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "757b39d9-1b73-40eb-8b53-54f555a0b5d0",
        "format": "sigma",
        "overallScore": 8.5,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 9,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 6
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "DestinationIp",
          "DestinationHostname",
          "Image",
          "Initiated"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/webshell_persistence_via_cgi_and_python_script_modification_in_registry.yml",
      "rule": {
        "id": "0e7180ca-928d-4fc4-8dff-9c64002e4fad",
        "title": "Webshell Persistence via CGI and Python Script Modification in Registry",
        "status": "experimental",
        "description": "Detects potential persistence via web shell injection by monitoring registry modifications to paths associated with CGI and Python web components. Attackers may modify legitimate files like compcheckresult.cgi or visits.py to execute arbitrary commands, which can be reflected in configuration or file integrity monitoring keys stored in the registry.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1505.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "registry_set"
        },
        "detection": {
          "selection_web_component": {
            "TargetObject": [
              "*\\dana-na\\auth\\compcheckresult.cgi*",
              "*\\api\\v1\\cav\\client\\visits*",
              "*\\visits.py*"
            ]
          },
          "selection_suspicious_content": {
            "Details": [
              "*eval(*",
              "*system(*",
              "*base64_decode*",
              "*python -c*",
              "*perl -e*"
            ]
          },
          "filter_legitimate_updates": {
            "Image": [
              "C:\\Windows\\System32\\msiexec.exe",
              "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"
            ],
            "User": [
              "NT AUTHORITY\\SYSTEM"
            ]
          },
          "condition": "selection_web_component and selection_suspicious_content and not filter_legitimate_updates"
        },
        "falsepositives": [
          "Security software or File Integrity Monitoring (FIM) agents updating their internal database or configuration registry keys.",
          "Legitimate administrative updates to web server configuration files that include complex scripts or encoded strings."
        ],
        "level": "high",
        "raw": "title: Webshell Persistence via CGI and Python Script Modification in Registry\nid: 0e7180ca-928d-4fc4-8dff-9c64002e4fad\nstatus: experimental\ndescription: Detects potential persistence via web shell injection by monitoring registry modifications to paths associated with CGI and Python web components. Attackers may modify legitimate files like compcheckresult.cgi or visits.py to execute arbitrary commands, which can be reflected in configuration or file integrity monitoring keys stored in the registry.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1505.003\nlogsource:\n  product: windows\n  category: registry_set\ndetection:\n  selection_web_component:\n    TargetObject:\n      - \"*\\\\dana-na\\\\auth\\\\compcheckresult.cgi*\"\n      - \"*\\\\api\\\\v1\\\\cav\\\\client\\\\visits*\"\n      - \"*\\\\visits.py*\"\n  selection_suspicious_content:\n    Details:\n      - \"*eval(*\"\n      - \"*system(*\"\n      - \"*base64_decode*\"\n      - \"*python -c*\"\n      - \"*perl -e*\"\n  filter_legitimate_updates:\n    Image:\n      - C:\\Windows\\System32\\msiexec.exe\n      - C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\n    User:\n      - NT AUTHORITY\\SYSTEM\n  condition: selection_web_component and selection_suspicious_content and not filter_legitimate_updates\nfalsepositives:\n  - Security software or File Integrity Monitoring (FIM) agents updating their internal database or configuration registry keys.\n  - Legitimate administrative updates to web server configuration files that include complex scripts or encoded strings.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "0e7180ca-928d-4fc4-8dff-9c64002e4fad",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "TargetObject",
          "Details",
          "Image",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_exchange_mailbox_permission_manipulation_via_ews.yml",
      "rule": {
        "id": "45fc7da8-ffe5-4291-b9c9-9349bb89b874",
        "title": "Suspicious Exchange Mailbox Permission Manipulation via EWS",
        "status": "experimental",
        "description": "Detects potential persistence activity where an attacker modifies Exchange mailbox folder permissions using the UpdateFolder EWS API. This behavior is often seen after NTLM relay attacks or CVE-2023-23397 exploitation to grant 'Owner' or 'Anonymous' access to mailboxes, allowing persistent access even after password resets.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1098.002"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_ews_access": {
            "EventID": [
              4624
            ],
            "LogonType": [
              3
            ],
            "ProcessName": [
              "*\\w3wp.exe"
            ]
          },
          "selection_suspicious_ips": {
            "IpAddress": [
              "101.255.119.42",
              "213.32.252.221",
              "168.205.200.55",
              "185.132.17.160",
              "69.162.253.21",
              "113.160.234.229",
              "181.209.99.204",
              "82.196.113.102",
              "85.195.206.7",
              "61.14.68.33"
            ]
          },
          "filter_internal_networks": {
            "IpAddress": [
              "127.0.0.1",
              "::1",
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*"
            ]
          },
          "condition": "selection_ews_access and (selection_suspicious_ips or not filter_internal_networks)"
        },
        "falsepositives": [
          "Legitimate administrative access from authorized external IP addresses (e.g., remote IT support using EWS-based tools)",
          "Third-party SaaS backup or migration solutions that utilize EWS to access and modify mailbox permissions"
        ],
        "level": "high",
        "raw": "title: Suspicious Exchange Mailbox Permission Manipulation via EWS\nid: 45fc7da8-ffe5-4291-b9c9-9349bb89b874\nstatus: experimental\ndescription: Detects potential persistence activity where an attacker modifies Exchange mailbox folder permissions using the UpdateFolder EWS API. This behavior is often seen after NTLM relay attacks or CVE-2023-23397 exploitation to grant 'Owner' or 'Anonymous' access to mailboxes, allowing persistent access even after password resets.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1098.002\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_ews_access:\n    EventID:\n      - 4624\n    LogonType:\n      - 3\n    ProcessName:\n      - \"*\\\\w3wp.exe\"\n  selection_suspicious_ips:\n    IpAddress:\n      - 101.255.119.42\n      - 213.32.252.221\n      - 168.205.200.55\n      - 185.132.17.160\n      - 69.162.253.21\n      - 113.160.234.229\n      - 181.209.99.204\n      - 82.196.113.102\n      - 85.195.206.7\n      - 61.14.68.33\n  filter_internal_networks:\n    IpAddress:\n      - 127.0.0.1\n      - ::1\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n  condition: selection_ews_access and (selection_suspicious_ips or not filter_internal_networks)\nfalsepositives:\n  - Legitimate administrative access from authorized external IP addresses (e.g., remote IT support using EWS-based tools)\n  - Third-party SaaS backup or migration solutions that utilize EWS to access and modify mailbox permissions\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "45fc7da8-ffe5-4291-b9c9-9349bb89b874",
        "format": "sigma",
        "overallScore": 8,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "LogonType",
          "ProcessName",
          "IpAddress"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/potential_cve-2023-23397_exploitation_via_outbound_smb_connection.yml",
      "rule": {
        "id": "443eb882-2f85-43ab-bc2f-388fa0f189b7",
        "title": "Potential CVE-2023-23397 Exploitation via Outbound SMB Connection",
        "status": "experimental",
        "description": "Detects outbound SMB connections (port 445) to external or non-standard IP addresses which may indicate the exploitation of CVE-2023-23397. This vulnerability allows an attacker to force an Outlook client to authenticate to a remote UNC path, leaking Net-NTLMv2 hashes.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1212"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_smb_port": {
            "EventID": [
              5140,
              5148,
              4624
            ],
            "IpPort": [
              445
            ]
          },
          "selection_external_ips": {
            "IpAddress": [
              "101.255.119.42",
              "213.32.252.221",
              "168.205.200.55",
              "185.132.17.160",
              "69.162.253.21",
              "113.160.234.229",
              "181.209.99.204",
              "82.196.113.102",
              "85.195.206.7",
              "61.14.68.33"
            ]
          },
          "filter_internal_ranges": {
            "IpAddress": [
              "127.0.0.1",
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "fe80:*"
            ]
          },
          "filter_system_accounts": {
            "SubjectUserName": [
              "ANONYMOUS LOGON",
              "MSOL_*"
            ]
          },
          "condition": "selection_smb_port and (selection_external_ips or not filter_internal_ranges) and not filter_system_accounts"
        },
        "falsepositives": [
          "Legitimate administrative access to cloud-hosted file shares or Azure Files over port 445",
          "Users connecting to home or third-party VPNs that expose SMB services over the public internet"
        ],
        "level": "high",
        "raw": "title: Potential CVE-2023-23397 Exploitation via Outbound SMB Connection\nid: 443eb882-2f85-43ab-bc2f-388fa0f189b7\nstatus: experimental\ndescription: Detects outbound SMB connections (port 445) to external or non-standard IP addresses which may indicate the exploitation of CVE-2023-23397. This vulnerability allows an attacker to force an Outlook client to authenticate to a remote UNC path, leaking Net-NTLMv2 hashes.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1212\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_smb_port:\n    EventID:\n      - 5140\n      - 5148\n      - 4624\n    IpPort:\n      - 445\n  selection_external_ips:\n    IpAddress:\n      - 101.255.119.42\n      - 213.32.252.221\n      - 168.205.200.55\n      - 185.132.17.160\n      - 69.162.253.21\n      - 113.160.234.229\n      - 181.209.99.204\n      - 82.196.113.102\n      - 85.195.206.7\n      - 61.14.68.33\n  filter_internal_ranges:\n    IpAddress:\n      - 127.0.0.1\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - fe80:*\n  filter_system_accounts:\n    SubjectUserName:\n      - ANONYMOUS LOGON\n      - MSOL_*\n  condition: selection_smb_port and (selection_external_ips or not filter_internal_ranges) and not filter_system_accounts\nfalsepositives:\n  - Legitimate administrative access to cloud-hosted file shares or Azure Files over port 445\n  - Users connecting to home or third-party VPNs that expose SMB services over the public internet\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "443eb882-2f85-43ab-bc2f-388fa0f189b7",
        "format": "sigma",
        "overallScore": 8.7,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "IpPort",
          "IpAddress",
          "SubjectUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/internal_spearphishing_and_account_discovery_via_ews_api_patterns.yml",
      "rule": {
        "id": "2700b3bf-b22b-40c8-847d-00f731464e79",
        "title": "Internal Spearphishing and Account Discovery via EWS API Patterns",
        "status": "experimental",
        "description": "Detects potential internal spearphishing and account discovery activity by monitoring for specific logon patterns and service interactions associated with Exchange Web Services (EWS) abuse. Attackers use compromised accounts to enumerate mailboxes (ResolveNames, GetDelegate) and send malicious internal emails to move laterally, often associated with CVE-2023-23397 exploitation.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.lateral_movement",
          "attack.t1534",
          "attack.discovery",
          "attack.t1087"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_ews_logon": {
            "EventID": [
              4624
            ],
            "LogonType": [
              3
            ],
            "ProcessName": [
              "*\\w3wp.exe",
              "*\\Microsoft.Exchange.ServiceHost.exe"
            ]
          },
          "selection_suspicious_ips": {
            "IpAddress": [
              "101.255.119.42",
              "213.32.252.221",
              "168.205.200.55",
              "185.132.17.160",
              "69.162.253.21",
              "113.160.234.229",
              "181.209.99.204",
              "82.196.113.102",
              "85.195.206.7",
              "61.14.68.33"
            ]
          },
          "selection_service_access": {
            "EventID": [
              4674
            ],
            "ServiceName": [
              "*Exchange*",
              "*EWS*"
            ]
          },
          "filter_legitimate_dc": {
            "SubjectUserName": [
              "ANONYMOUS LOGON",
              "MSOL_*"
            ],
            "IpAddress": [
              "127.0.0.1",
              "::1"
            ]
          },
          "filter_health_mailboxes": {
            "TargetUserName": [
              "HealthMailbox*"
            ]
          },
          "condition": "(selection_ews_logon and selection_suspicious_ips) or (selection_service_access and not (filter_legitimate_dc or filter_health_mailboxes))"
        },
        "falsepositives": [
          "Legitimate administrative scripts or third-party backup solutions using EWS to sync or migrate mailbox data.",
          "Internal security scanners or mail flow monitoring tools that simulate user logins to verify Exchange availability.",
          "Mobile device management (MDM) solutions or mail clients performing legitimate synchronization from known external IP ranges."
        ],
        "level": "high",
        "raw": "title: Internal Spearphishing and Account Discovery via EWS API Patterns\nid: 2700b3bf-b22b-40c8-847d-00f731464e79\nstatus: experimental\ndescription: Detects potential internal spearphishing and account discovery activity by monitoring for specific logon patterns and service interactions associated with Exchange Web Services (EWS) abuse. Attackers use compromised accounts to enumerate mailboxes (ResolveNames, GetDelegate) and send malicious internal emails to move laterally, often associated with CVE-2023-23397 exploitation.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.lateral_movement\n  - attack.t1534\n  - attack.discovery\n  - attack.t1087\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_ews_logon:\n    EventID:\n      - 4624\n    LogonType:\n      - 3\n    ProcessName:\n      - \"*\\\\w3wp.exe\"\n      - \"*\\\\Microsoft.Exchange.ServiceHost.exe\"\n  selection_suspicious_ips:\n    IpAddress:\n      - 101.255.119.42\n      - 213.32.252.221\n      - 168.205.200.55\n      - 185.132.17.160\n      - 69.162.253.21\n      - 113.160.234.229\n      - 181.209.99.204\n      - 82.196.113.102\n      - 85.195.206.7\n      - 61.14.68.33\n  selection_service_access:\n    EventID:\n      - 4674\n    ServiceName:\n      - \"*Exchange*\"\n      - \"*EWS*\"\n  filter_legitimate_dc:\n    SubjectUserName:\n      - ANONYMOUS LOGON\n      - MSOL_*\n    IpAddress:\n      - 127.0.0.1\n      - ::1\n  filter_health_mailboxes:\n    TargetUserName:\n      - HealthMailbox*\n  condition: (selection_ews_logon and selection_suspicious_ips) or (selection_service_access and not (filter_legitimate_dc or filter_health_mailboxes))\nfalsepositives:\n  - Legitimate administrative scripts or third-party backup solutions using EWS to sync or migrate mailbox data.\n  - Internal security scanners or mail flow monitoring tools that simulate user logins to verify Exchange availability.\n  - Mobile device management (MDM) solutions or mail clients performing legitimate synchronization from known external IP ranges.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "2700b3bf-b22b-40c8-847d-00f731464e79",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "LogonType",
          "ProcessName",
          "IpAddress",
          "ServiceName",
          "SubjectUserName",
          "TargetUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8571428571428571,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_network_pivot_via_web_server_process.yml",
      "rule": {
        "id": "b02adaaa-b44b-48c8-8023-600e07d1b321",
        "title": "Suspicious Network Pivot via Web Server Process",
        "status": "experimental",
        "description": "Detects network connections initiated by web server processes (w3wp.exe) to internal or unusual destinations, which may indicate the use of tunneling tools like GLASSTOKEN or ReGeorg for multi-hop proxying and lateral movement.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.command_and_control",
          "attack.t1090.003",
          "attack.t1505.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_web_process": {
            "Image": [
              "*\\w3wp.exe",
              "*\\httpd.exe",
              "*\\nginx.exe",
              "*\\tomcat.exe"
            ]
          },
          "selection_outbound": {
            "Initiated": [
              true
            ],
            "DestinationPort": [
              21,
              22,
              23,
              135,
              139,
              445,
              3389,
              5985,
              5986
            ]
          },
          "filter_local_dns": {
            "DestinationPort": [
              53
            ],
            "DestinationHostname": [
              "*localhost*",
              "*127.0.0.1*"
            ]
          },
          "filter_updates": {
            "DestinationHostname": [
              "*.microsoft.com",
              "*.windowsupdate.com",
              "*.digicert.com"
            ]
          },
          "condition": "selection_web_process and selection_outbound and not (filter_local_dns or filter_updates)"
        },
        "falsepositives": [
          "Web applications designed to act as legitimate proxies or gateways to internal management interfaces.",
          "Server-side scripts or plugins that perform administrative tasks or fetch updates from internal file shares via SMB."
        ],
        "level": "high",
        "raw": "title: Suspicious Network Pivot via Web Server Process\nid: b02adaaa-b44b-48c8-8023-600e07d1b321\nstatus: experimental\ndescription: Detects network connections initiated by web server processes (w3wp.exe) to internal or unusual destinations, which may indicate the use of tunneling tools like GLASSTOKEN or ReGeorg for multi-hop proxying and lateral movement.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.command_and_control\n  - attack.t1090.003\n  - attack.t1505.003\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_web_process:\n    Image:\n      - \"*\\\\w3wp.exe\"\n      - \"*\\\\httpd.exe\"\n      - \"*\\\\nginx.exe\"\n      - \"*\\\\tomcat.exe\"\n  selection_outbound:\n    Initiated:\n      - true\n    DestinationPort:\n      - 21\n      - 22\n      - 23\n      - 135\n      - 139\n      - 445\n      - 3389\n      - 5985\n      - 5986\n  filter_local_dns:\n    DestinationPort:\n      - 53\n    DestinationHostname:\n      - \"*localhost*\"\n      - \"*127.0.0.1*\"\n  filter_updates:\n    DestinationHostname:\n      - \"*.microsoft.com\"\n      - \"*.windowsupdate.com\"\n      - \"*.digicert.com\"\n  condition: selection_web_process and selection_outbound and not (filter_local_dns or filter_updates)\nfalsepositives:\n  - Web applications designed to act as legitimate proxies or gateways to internal management interfaces.\n  - Server-side scripts or plugins that perform administrative tasks or fetch updates from internal file shares via SMB.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "b02adaaa-b44b-48c8-8023-600e07d1b321",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_data_staging_in_web_directories_via_file_operations.yml",
      "rule": {
        "id": "ae6a46b6-bafa-45ce-b69e-4aefa378a235",
        "title": "Suspicious Data Staging in Web Directories via File Operations",
        "status": "experimental",
        "description": "Detects execution of file copy, move, or write operations targeting web-accessible directories (such as IIS inetpub, wwwroot, or VPN-related paths like dana-na/help), which may indicate adversaries staging collected data locally prior to exfiltration per ATT&CK T1074.001. This behavior is commonly observed when attackers prepare data for exfiltration by placing it in directories accessible to web servers or applications.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.collection",
          "attack.t1074.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_tools": {
            "Image": [
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\xcopy.exe",
              "*\\robocopy.exe",
              "*\\certutil.exe",
              "*\\bitsadmin.exe"
            ]
          },
          "selection_web_paths": {
            "CommandLine": [
              "*inetpub*",
              "*wwwroot*",
              "*dana-na*",
              "*\\help\\*",
              "*webroot*",
              "*htdocs*",
              "*public_html*"
            ]
          },
          "selection_file_ops": {
            "CommandLine": [
              "* copy *",
              "* xcopy *",
              "* robocopy *",
              "* move *",
              "*>*",
              "*Out-File*",
              "*Set-Content*",
              "*Add-Content*",
              "*DownloadFile*",
              "*DownloadString*"
            ]
          },
          "filter_legitimate_web": {
            "ParentImage": [
              "*\\w3wp.exe",
              "*\\iisexpress.exe",
              "*\\httpd.exe",
              "*\\nginx.exe"
            ]
          },
          "filter_legitimate_system": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\LOCAL SERVICE"
            ],
            "ParentImage": [
              "*\\services.exe",
              "*\\svchost.exe"
            ]
          },
          "condition": "selection_tools and selection_web_paths and selection_file_ops and not filter_legitimate_web and not filter_legitimate_system"
        },
        "falsepositives": [
          "Legitimate administrative scripts or deployment tools (e.g., SCCM, Puppet, Ansible) that update web content in inetpub or wwwroot directories during scheduled maintenance windows",
          "Developers manually copying files to local web server directories for testing purposes using command line tools"
        ],
        "level": "high",
        "raw": "title: Suspicious Data Staging in Web Directories via File Operations\nid: ae6a46b6-bafa-45ce-b69e-4aefa378a235\nstatus: experimental\ndescription: Detects execution of file copy, move, or write operations targeting web-accessible directories (such as IIS inetpub, wwwroot, or VPN-related paths like dana-na/help), which may indicate adversaries staging collected data locally prior to exfiltration per ATT&CK T1074.001. This behavior is commonly observed when attackers prepare data for exfiltration by placing it in directories accessible to web servers or applications.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.collection\n  - attack.t1074.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_tools:\n    Image:\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\xcopy.exe\"\n      - \"*\\\\robocopy.exe\"\n      - \"*\\\\certutil.exe\"\n      - \"*\\\\bitsadmin.exe\"\n  selection_web_paths:\n    CommandLine:\n      - \"*inetpub*\"\n      - \"*wwwroot*\"\n      - \"*dana-na*\"\n      - \"*\\\\help\\\\*\"\n      - \"*webroot*\"\n      - \"*htdocs*\"\n      - \"*public_html*\"\n  selection_file_ops:\n    CommandLine:\n      - \"* copy *\"\n      - \"* xcopy *\"\n      - \"* robocopy *\"\n      - \"* move *\"\n      - \"*>*\"\n      - \"*Out-File*\"\n      - \"*Set-Content*\"\n      - \"*Add-Content*\"\n      - \"*DownloadFile*\"\n      - \"*DownloadString*\"\n  filter_legitimate_web:\n    ParentImage:\n      - \"*\\\\w3wp.exe\"\n      - \"*\\\\iisexpress.exe\"\n      - \"*\\\\httpd.exe\"\n      - \"*\\\\nginx.exe\"\n  filter_legitimate_system:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\LOCAL SERVICE\n    ParentImage:\n      - \"*\\\\services.exe\"\n      - \"*\\\\svchost.exe\"\n  condition: selection_tools and selection_web_paths and selection_file_ops and not filter_legitimate_web and not filter_legitimate_system\nfalsepositives:\n  - Legitimate administrative scripts or deployment tools (e.g., SCCM, Puppet, Ansible) that update web content in inetpub or wwwroot directories during scheduled maintenance windows\n  - Developers manually copying files to local web server directories for testing purposes using command line tools\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "ae6a46b6-bafa-45ce-b69e-4aefa378a235",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "ParentImage",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/security_tool_exclusion_modification_via_scripting_interpreter.yml",
      "rule": {
        "id": "405d038d-692e-47f9-97e0-2b65a5feeecd",
        "title": "Security Tool Exclusion Modification via Scripting Interpreter",
        "status": "experimental",
        "description": "Detects modifications to antivirus or antimalware exclusion lists in the Windows Registry, particularly when performed by scripting interpreters or command-line tools. This behavior is commonly observed when threat actors attempt to hide web shells or other malicious components from security scanning, analogous to manipulating Integrity Checker Tool exclusions in compromised VPN appliances to maintain persistence.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1505.003",
          "attack.defense_evasion",
          "attack.t1562.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "registry_set"
        },
        "detection": {
          "selection_exclusion_paths": {
            "TargetObject": [
              "*\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\*",
              "*\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\\Paths\\*",
              "*\\SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths\\*",
              "*\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Extensions\\*",
              "*\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Processes\\*"
            ]
          },
          "selection_suspicious_image": {
            "Image": [
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\python.exe",
              "*\\pythonw.exe",
              "*\\perl.exe",
              "*\\wscript.exe",
              "*\\cscript.exe"
            ]
          },
          "filter_legitimate_system": {
            "Image": [
              "*\\svchost.exe",
              "*\\services.exe",
              "*\\MsMpEng.exe",
              "*\\MpCmdRun.exe",
              "*\\CCMExec.exe"
            ]
          },
          "condition": "selection_exclusion_paths and selection_suspicious_image and not filter_legitimate_system"
        },
        "falsepositives": [
          "Legitimate administrative scripts that temporarily add exclusions for web server directories during maintenance or troubleshooting activities",
          "Automated deployment tools or configuration management systems that set antivirus exclusions for application directories during software installation"
        ],
        "level": "high",
        "raw": "title: Security Tool Exclusion Modification via Scripting Interpreter\nid: 405d038d-692e-47f9-97e0-2b65a5feeecd\nstatus: experimental\ndescription: Detects modifications to antivirus or antimalware exclusion lists in the Windows Registry, particularly when performed by scripting interpreters or command-line tools. This behavior is commonly observed when threat actors attempt to hide web shells or other malicious components from security scanning, analogous to manipulating Integrity Checker Tool exclusions in compromised VPN appliances to maintain persistence.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1505.003\n  - attack.defense_evasion\n  - attack.t1562.001\nlogsource:\n  product: windows\n  category: registry_set\ndetection:\n  selection_exclusion_paths:\n    TargetObject:\n      - \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Exclusions\\\\Paths\\\\*\"\n      - \"*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Exclusions\\\\Paths\\\\*\"\n      - \"*\\\\SOFTWARE\\\\Microsoft\\\\Microsoft Antimalware\\\\Exclusions\\\\Paths\\\\*\"\n      - \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Exclusions\\\\Extensions\\\\*\"\n      - \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Exclusions\\\\Processes\\\\*\"\n  selection_suspicious_image:\n    Image:\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\python.exe\"\n      - \"*\\\\pythonw.exe\"\n      - \"*\\\\perl.exe\"\n      - \"*\\\\wscript.exe\"\n      - \"*\\\\cscript.exe\"\n  filter_legitimate_system:\n    Image:\n      - \"*\\\\svchost.exe\"\n      - \"*\\\\services.exe\"\n      - \"*\\\\MsMpEng.exe\"\n      - \"*\\\\MpCmdRun.exe\"\n      - \"*\\\\CCMExec.exe\"\n  condition: selection_exclusion_paths and selection_suspicious_image and not filter_legitimate_system\nfalsepositives:\n  - Legitimate administrative scripts that temporarily add exclusions for web server directories during maintenance or troubleshooting activities\n  - Automated deployment tools or configuration management systems that set antivirus exclusions for application directories during software installation\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "405d038d-692e-47f9-97e0-2b65a5feeecd",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "TargetObject",
          "Image"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_network_connection_from_teamcity_server_via_exploit.yml",
      "rule": {
        "id": "fd4398ad-1fa7-4b40-a766-1d17f655bd88",
        "title": "Suspicious Network Connection from TeamCity Server via Exploit",
        "status": "experimental",
        "description": "Detects suspicious network connections initiated by the JetBrains TeamCity server process, which may indicate post-exploitation activity following the abuse of CVE-2023-42793. Attackers exploit this vulnerability to gain initial access and subsequently establish command and control or download additional payloads.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1190"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_teamcity_process": {
            "Image": [
              "*\\TeamCity\\bin\\tomcat8.exe",
              "*\\TeamCity\\bin\\tomcat9.exe",
              "*\\TeamCity\\jre\\bin\\java.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_suspicious_destinations": {
            "DestinationPort": [
              80,
              443,
              4444,
              8080,
              8888
            ]
          },
          "filter_internal_comms": {
            "DestinationIp": [
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "127.0.0.1"
            ]
          },
          "filter_updates": {
            "DestinationHostname": [
              "*.jetbrains.com",
              "*.apache.org",
              "*.microsoft.com",
              "*.ubuntu.com"
            ]
          },
          "condition": "selection_teamcity_process and selection_suspicious_destinations and not (filter_internal_comms or filter_updates)"
        },
        "falsepositives": [
          "Legitimate TeamCity plugins or integrations communicating with external APIs or version control systems (e.g., GitHub, GitLab, Bitbucket)",
          "Automatic update checks performed by the TeamCity server or its underlying Java runtime environment"
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection from TeamCity Server via Exploit\nid: fd4398ad-1fa7-4b40-a766-1d17f655bd88\nstatus: experimental\ndescription: Detects suspicious network connections initiated by the JetBrains TeamCity server process, which may indicate post-exploitation activity following the abuse of CVE-2023-42793. Attackers exploit this vulnerability to gain initial access and subsequently establish command and control or download additional payloads.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1190\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_teamcity_process:\n    Image:\n      - \"*\\\\TeamCity\\\\bin\\\\tomcat8.exe\"\n      - \"*\\\\TeamCity\\\\bin\\\\tomcat9.exe\"\n      - \"*\\\\TeamCity\\\\jre\\\\bin\\\\java.exe\"\n    Initiated:\n      - true\n  selection_suspicious_destinations:\n    DestinationPort:\n      - 80\n      - 443\n      - 4444\n      - 8080\n      - 8888\n  filter_internal_comms:\n    DestinationIp:\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 127.0.0.1\n  filter_updates:\n    DestinationHostname:\n      - \"*.jetbrains.com\"\n      - \"*.apache.org\"\n      - \"*.microsoft.com\"\n      - \"*.ubuntu.com\"\n  condition: selection_teamcity_process and selection_suspicious_destinations and not (filter_internal_comms or filter_updates)\nfalsepositives:\n  - Legitimate TeamCity plugins or integrations communicating with external APIs or version control systems (e.g., GitHub, GitLab, Bitbucket)\n  - Automatic update checks performed by the TeamCity server or its underlying Java runtime environment\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "fd4398ad-1fa7-4b40-a766-1d17f655bd88",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "DestinationIp",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_network_connection_following_symlink_evaluation_modification.yml",
      "rule": {
        "id": "c8160424-2860-47dc-b550-59a7eac0a5e8",
        "title": "Suspicious Network Connection Following Symlink Evaluation Modification",
        "status": "experimental",
        "description": "Detects network connections initiated by processes commonly associated with the modification of symbolic link evaluation settings (R2L/R2R). Attackers, such as BlackCat ransomware operators, use fsutil to enable remote symlink evaluation to traverse and encrypt files across network shares. This rule monitors for outbound network activity from the fsutil utility or processes running from suspicious paths after such configurations are typically applied.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.exfiltration",
          "attack.t1537",
          "attack.lateral_movement",
          "attack.t1021.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_tools": {
            "Image": [
              "*\\fsutil.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_ports": {
            "DestinationPort": [
              139,
              445,
              5985,
              5986
            ],
            "Protocol": "tcp"
          },
          "filter_system_processes": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "DestinationHostname": [
              "*.microsoft.com",
              "*.windowsupdate.com"
            ]
          },
          "condition": "selection_tools and selection_ports and not filter_system_processes"
        },
        "falsepositives": [
          "Administrative activity where fsutil is used to troubleshoot filesystem issues or verify network share connectivity.",
          "Storage management software or backup agents that utilize fsutil for volume analysis and communicate over SMB/RPC."
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection Following Symlink Evaluation Modification\nid: c8160424-2860-47dc-b550-59a7eac0a5e8\nstatus: experimental\ndescription: Detects network connections initiated by processes commonly associated with the modification of symbolic link evaluation settings (R2L/R2R). Attackers, such as BlackCat ransomware operators, use fsutil to enable remote symlink evaluation to traverse and encrypt files across network shares. This rule monitors for outbound network activity from the fsutil utility or processes running from suspicious paths after such configurations are typically applied.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.exfiltration\n  - attack.t1537\n  - attack.lateral_movement\n  - attack.t1021.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_tools:\n    Image:\n      - \"*\\\\fsutil.exe\"\n    Initiated:\n      - true\n  selection_ports:\n    DestinationPort:\n      - 139\n      - 445\n      - 5985\n      - 5986\n    Protocol: tcp\n  filter_system_processes:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    DestinationHostname:\n      - \"*.microsoft.com\"\n      - \"*.windowsupdate.com\"\n  condition: selection_tools and selection_ports and not filter_system_processes\nfalsepositives:\n  - Administrative activity where fsutil is used to troubleshoot filesystem issues or verify network share connectivity.\n  - Storage management software or backup agents that utilize fsutil for volume analysis and communicate over SMB/RPC.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "c8160424-2860-47dc-b550-59a7eac0a5e8",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "Protocol",
          "User",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/modification_of_maxmpxct_registry_value_for_smb_performance_optimization.yml",
      "rule": {
        "id": "e5a7ecd3-75f9-439c-9b96-d7a6575a293f",
        "title": "Modification of MaxMpxCt Registry Value for SMB Performance Optimization",
        "status": "experimental",
        "description": "Detects the modification of the MaxMpxCt registry value within the LanmanServer parameters. Threat actors, particularly ransomware operators, increase this value to allow a higher number of simultaneous outstanding requests (up to 65535), which facilitates faster encryption of files over SMB network shares.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1112"
        ],
        "logsource": {
          "product": "windows",
          "category": "registry_set"
        },
        "detection": {
          "selection_registry_path": {
            "TargetObject": [
              "*\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\\MaxMpxCt"
            ]
          },
          "selection_details": {
            "Details": [
              "DWORD (0x0000ffff)",
              "*65535*"
            ]
          },
          "filter_legitimate_images": {
            "Image": [
              "C:\\Windows\\System32\\svchost.exe",
              "C:\\Windows\\System32\\services.exe"
            ]
          },
          "condition": "selection_registry_path and selection_details and not filter_legitimate_images"
        },
        "falsepositives": [
          "High-performance file servers or database servers where administrators have manually tuned SMB performance parameters.",
          "Legacy applications or specialized network storage software that requires high multiplexed command counts for stability."
        ],
        "level": "high",
        "raw": "title: Modification of MaxMpxCt Registry Value for SMB Performance Optimization\nid: e5a7ecd3-75f9-439c-9b96-d7a6575a293f\nstatus: experimental\ndescription: Detects the modification of the MaxMpxCt registry value within the LanmanServer parameters. Threat actors, particularly ransomware operators, increase this value to allow a higher number of simultaneous outstanding requests (up to 65535), which facilitates faster encryption of files over SMB network shares.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1112\nlogsource:\n  product: windows\n  category: registry_set\ndetection:\n  selection_registry_path:\n    TargetObject:\n      - \"*\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters\\\\MaxMpxCt\"\n  selection_details:\n    Details:\n      - DWORD (0x0000ffff)\n      - \"*65535*\"\n  filter_legitimate_images:\n    Image:\n      - C:\\Windows\\System32\\svchost.exe\n      - C:\\Windows\\System32\\services.exe\n  condition: selection_registry_path and selection_details and not filter_legitimate_images\nfalsepositives:\n  - High-performance file servers or database servers where administrators have manually tuned SMB performance parameters.\n  - Legacy applications or specialized network storage software that requires high multiplexed command counts for stability.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "e5a7ecd3-75f9-439c-9b96-d7a6575a293f",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "TargetObject",
          "Details",
          "Image"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_network_connection_initiated_by_onenote_via_scripting_tools.yml",
      "rule": {
        "id": "54285146-522d-4b9d-a1a9-da990c514cfb",
        "title": "Suspicious Network Connection Initiated by OneNote via Scripting Tools",
        "status": "experimental",
        "description": "Detects Microsoft OneNote initiating network connections through command-line interpreters or PowerShell, a behavior commonly associated with malicious OneNote attachments (spearphishing) that execute embedded batch files or scripts to download second-stage payloads.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1566.001",
          "attack.execution",
          "attack.t1059.001",
          "attack.t1059.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_onenote_process": {
            "Image": [
              "*\\onenote.exe",
              "*\\onenoteim.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_suspicious_destinations": {
            "DestinationPort": [
              80,
              443,
              8080
            ],
            "Protocol": "tcp"
          },
          "filter_microsoft_updates": {
            "DestinationHostname": [
              "*.microsoft.com",
              "*.office.com",
              "*.office.net",
              "*.live.com",
              "*.onenote.com"
            ]
          },
          "filter_local_networks": {
            "DestinationIp": [
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "127.*"
            ]
          },
          "condition": "selection_onenote_process and selection_suspicious_destinations and not (filter_microsoft_updates or filter_local_networks)"
        },
        "falsepositives": [
          "Legitimate OneNote features syncing with third-party cloud storage providers not covered in filters",
          "Users clicking on legitimate HTTP/HTTPS links embedded within a OneNote notebook"
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection Initiated by OneNote via Scripting Tools\nid: 54285146-522d-4b9d-a1a9-da990c514cfb\nstatus: experimental\ndescription: Detects Microsoft OneNote initiating network connections through command-line interpreters or PowerShell, a behavior commonly associated with malicious OneNote attachments (spearphishing) that execute embedded batch files or scripts to download second-stage payloads.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1566.001\n  - attack.execution\n  - attack.t1059.001\n  - attack.t1059.003\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_onenote_process:\n    Image:\n      - \"*\\\\onenote.exe\"\n      - \"*\\\\onenoteim.exe\"\n    Initiated:\n      - true\n  selection_suspicious_destinations:\n    DestinationPort:\n      - 80\n      - 443\n      - 8080\n    Protocol: tcp\n  filter_microsoft_updates:\n    DestinationHostname:\n      - \"*.microsoft.com\"\n      - \"*.office.com\"\n      - \"*.office.net\"\n      - \"*.live.com\"\n      - \"*.onenote.com\"\n  filter_local_networks:\n    DestinationIp:\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 127.*\n  condition: selection_onenote_process and selection_suspicious_destinations and not (filter_microsoft_updates or filter_local_networks)\nfalsepositives:\n  - Legitimate OneNote features syncing with third-party cloud storage providers not covered in filters\n  - Users clicking on legitimate HTTP/HTTPS links embedded within a OneNote notebook\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "54285146-522d-4b9d-a1a9-da990c514cfb",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "Protocol",
          "DestinationHostname",
          "DestinationIp"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_proxy_tunneling_and_geolocation_reconnaissance_via_scripting_engines.yml",
      "rule": {
        "id": "be7dc23b-cd03-4fb9-b4e4-b3fab061d387",
        "title": "Suspicious Proxy Tunneling and Geolocation Reconnaissance via Scripting Engines",
        "status": "experimental",
        "description": "Detects network connections indicative of proxy and tunneling behavior (T1090) including SOCKS proxy usage, SSH tunneling, and IP geolocation reconnaissance initiated by scripting engines and command-line tools. This behavior is associated with establishing reverse SOCKS proxies and C2 channels through compromised infrastructure, specifically involving tools like PySoxy and curl.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.command_and_control",
          "attack.t1090"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_proxy_tunnel": {
            "Initiated": [
              true
            ],
            "Image": [
              "*\\python.exe",
              "*\\pythonw.exe",
              "*\\cmd.exe",
              "*\\powershell.exe"
            ],
            "DestinationPort": [
              22,
              1080,
              1081,
              3128,
              8080
            ]
          },
          "selection_geolocation_check": {
            "Initiated": [
              true
            ],
            "Image": [
              "*\\python.exe",
              "*\\pythonw.exe",
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\curl.exe"
            ],
            "DestinationHostname": [
              "ip-api.com"
            ]
          },
          "filter_legitimate_tools": {
            "Image": [
              "*\\ssh.exe",
              "*\\putty.exe",
              "*\\plink.exe",
              "*\\pageant.exe",
              "*\\git.exe"
            ]
          },
          "condition": "(selection_proxy_tunnel or selection_geolocation_check) and not filter_legitimate_tools"
        },
        "falsepositives": [
          "Legitimate Python automation scripts using libraries like Paramiko or PySocks for SSH/SOCKS connections in enterprise environments",
          "System administrators using PowerShell or command-line tools to establish SSH tunnels for routine maintenance or troubleshooting",
          "Security tools and vulnerability scanners that check external IP addresses via ip-api.com or similar services"
        ],
        "level": "high",
        "raw": "title: Suspicious Proxy Tunneling and Geolocation Reconnaissance via Scripting Engines\nid: be7dc23b-cd03-4fb9-b4e4-b3fab061d387\nstatus: experimental\ndescription: Detects network connections indicative of proxy and tunneling behavior (T1090) including SOCKS proxy usage, SSH tunneling, and IP geolocation reconnaissance initiated by scripting engines and command-line tools. This behavior is associated with establishing reverse SOCKS proxies and C2 channels through compromised infrastructure, specifically involving tools like PySoxy and curl.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.command_and_control\n  - attack.t1090\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_proxy_tunnel:\n    Initiated:\n      - true\n    Image:\n      - \"*\\\\python.exe\"\n      - \"*\\\\pythonw.exe\"\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n    DestinationPort:\n      - 22\n      - 1080\n      - 1081\n      - 3128\n      - 8080\n  selection_geolocation_check:\n    Initiated:\n      - true\n    Image:\n      - \"*\\\\python.exe\"\n      - \"*\\\\pythonw.exe\"\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\curl.exe\"\n    DestinationHostname:\n      - ip-api.com\n  filter_legitimate_tools:\n    Image:\n      - \"*\\\\ssh.exe\"\n      - \"*\\\\putty.exe\"\n      - \"*\\\\plink.exe\"\n      - \"*\\\\pageant.exe\"\n      - \"*\\\\git.exe\"\n  condition: (selection_proxy_tunnel or selection_geolocation_check) and not filter_legitimate_tools\nfalsepositives:\n  - Legitimate Python automation scripts using libraries like Paramiko or PySocks for SSH/SOCKS connections in enterprise environments\n  - System administrators using PowerShell or command-line tools to establish SSH tunnels for routine maintenance or troubleshooting\n  - Security tools and vulnerability scanners that check external IP addresses via ip-api.com or similar services\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "be7dc23b-cd03-4fb9-b4e4-b3fab061d387",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Initiated",
          "Image",
          "DestinationPort",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_ntds_database_compression_via_7-zip_from_mounted_vhd.yml",
      "rule": {
        "id": "95fa95ae-8c80-49b6-bf6d-ab4b53fcfa13",
        "title": "Suspicious NTDS Database Compression via 7-Zip from Mounted VHD",
        "status": "experimental",
        "description": "Detects the compression of Active Directory database files (ntds.dit) using 7-Zip or similar archiving tools, particularly when sourced from mounted Virtual Hard Disk (VHD/VHDX) backups. This technique is associated with credential dumping from domain controller backup images where attackers mount VHD files to extract and compress the NTDS database for exfiltration.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1003.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_archiver": {
            "Image": [
              "*\\7z.exe",
              "*\\7za.exe",
              "*\\7zG.exe",
              "*\\winrar.exe"
            ],
            "CommandLine": [
              "*ntds.dit*"
            ]
          },
          "selection_mount": {
            "Image": [
              "*\\diskpart.exe",
              "*\\dism.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe"
            ],
            "CommandLine": [
              "*.vhd*",
              "*.vhdx*",
              "*Mount-DiskImage*"
            ]
          },
          "filter_system_process": {
            "ParentImage": [
              "*\\svchost.exe",
              "*\\services.exe"
            ]
          },
          "filter_backup_engine": {
            "ParentImage": [
              "*\\wbengine.exe",
              "*\\vssvc.exe"
            ]
          },
          "condition": "(selection_archiver or selection_mount) and not filter_system_process and not filter_backup_engine"
        },
        "falsepositives": [
          "Legitimate disaster recovery operations where administrators mount VHD backups to extract specific files including Active Directory databases for testing purposes",
          "Backup software agents that temporarily mount virtual disk images to perform file-level recovery operations"
        ],
        "level": "high",
        "raw": "title: Suspicious NTDS Database Compression via 7-Zip from Mounted VHD\nid: 95fa95ae-8c80-49b6-bf6d-ab4b53fcfa13\nstatus: experimental\ndescription: Detects the compression of Active Directory database files (ntds.dit) using 7-Zip or similar archiving tools, particularly when sourced from mounted Virtual Hard Disk (VHD/VHDX) backups. This technique is associated with credential dumping from domain controller backup images where attackers mount VHD files to extract and compress the NTDS database for exfiltration.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1003.003\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_archiver:\n    Image:\n      - \"*\\\\7z.exe\"\n      - \"*\\\\7za.exe\"\n      - \"*\\\\7zG.exe\"\n      - \"*\\\\winrar.exe\"\n    CommandLine:\n      - \"*ntds.dit*\"\n  selection_mount:\n    Image:\n      - \"*\\\\diskpart.exe\"\n      - \"*\\\\dism.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n    CommandLine:\n      - \"*.vhd*\"\n      - \"*.vhdx*\"\n      - \"*Mount-DiskImage*\"\n  filter_system_process:\n    ParentImage:\n      - \"*\\\\svchost.exe\"\n      - \"*\\\\services.exe\"\n  filter_backup_engine:\n    ParentImage:\n      - \"*\\\\wbengine.exe\"\n      - \"*\\\\vssvc.exe\"\n  condition: (selection_archiver or selection_mount) and not filter_system_process and not filter_backup_engine\nfalsepositives:\n  - Legitimate disaster recovery operations where administrators mount VHD backups to extract specific files including Active Directory databases for testing purposes\n  - Backup software agents that temporarily mount virtual disk images to perform file-level recovery operations\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "95fa95ae-8c80-49b6-bf6d-ab4b53fcfa13",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_ntds.dit_extraction_and_lsass_dumping_via_task_manager.yml",
      "rule": {
        "id": "43241ba3-5a37-4e64-bce6-6476a6e86f85",
        "title": "Suspicious NTDS.DIT Extraction and LSASS Dumping via Task Manager",
        "status": "experimental",
        "description": "Detects patterns of credential dumping including the compression of the Active Directory database (ntds.dit) and the creation of LSASS memory dumps using Task Manager. This behavior is consistent with post-exploitation activities where attackers attempt to harvest credentials for lateral movement.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1003.001",
          "attack.t1003.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_lsass_dump": {
            "ParentImage": [
              "*\\taskmgr.exe"
            ],
            "CommandLine": [
              "*lsass.dmp*"
            ]
          },
          "selection_ntds_compression": {
            "Image": [
              "*\\7z.exe",
              "*\\7za.exe",
              "*\\rar.exe",
              "*\\zip.exe"
            ],
            "CommandLine": [
              "*ntds.dit*"
            ]
          },
          "selection_vhd_mount": {
            "Image": [
              "*\\powershell.exe",
              "*\\pwsh.exe"
            ],
            "CommandLine": [
              "*Mount-VHD*",
              "*Mount-DiskImage*"
            ]
          },
          "filter_legitimate_backup": {
            "Company": [
              "Veeam Software*",
              "Microsoft Corporation"
            ],
            "CommandLine": [
              "*\\Backup\\*",
              "*\\Veeam\\*"
            ]
          },
          "condition": "(selection_lsass_dump or selection_ntds_compression or selection_vhd_mount) and not filter_legitimate_backup"
        },
        "falsepositives": [
          "Legitimate backup software or scripts that compress the Active Directory database for offsite storage.",
          "Administrators manually mounting VHD files for disaster recovery testing or maintenance.",
          "Antivirus or EDR solutions generating memory dumps for diagnostic purposes."
        ],
        "level": "high",
        "raw": "title: Suspicious NTDS.DIT Extraction and LSASS Dumping via Task Manager\nid: 43241ba3-5a37-4e64-bce6-6476a6e86f85\nstatus: experimental\ndescription: Detects patterns of credential dumping including the compression of the Active Directory database (ntds.dit) and the creation of LSASS memory dumps using Task Manager. This behavior is consistent with post-exploitation activities where attackers attempt to harvest credentials for lateral movement.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1003.001\n  - attack.t1003.003\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_lsass_dump:\n    ParentImage:\n      - \"*\\\\taskmgr.exe\"\n    CommandLine:\n      - \"*lsass.dmp*\"\n  selection_ntds_compression:\n    Image:\n      - \"*\\\\7z.exe\"\n      - \"*\\\\7za.exe\"\n      - \"*\\\\rar.exe\"\n      - \"*\\\\zip.exe\"\n    CommandLine:\n      - \"*ntds.dit*\"\n  selection_vhd_mount:\n    Image:\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n    CommandLine:\n      - \"*Mount-VHD*\"\n      - \"*Mount-DiskImage*\"\n  filter_legitimate_backup:\n    Company:\n      - Veeam Software*\n      - Microsoft Corporation\n    CommandLine:\n      - \"*\\\\Backup\\\\*\"\n      - \"*\\\\Veeam\\\\*\"\n  condition: (selection_lsass_dump or selection_ntds_compression or selection_vhd_mount) and not filter_legitimate_backup\nfalsepositives:\n  - Legitimate backup software or scripts that compress the Active Directory database for offsite storage.\n  - Administrators manually mounting VHD files for disaster recovery testing or maintenance.\n  - Antivirus or EDR solutions generating memory dumps for diagnostic purposes.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "43241ba3-5a37-4e64-bce6-6476a6e86f85",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ParentImage",
          "CommandLine",
          "Image",
          "Company"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/credential_exfiltration_via_compromised_web_portal_network_connection.yml",
      "rule": {
        "id": "2216adcf-8d60-4fec-aeed-84830812b54c",
        "title": "Credential Exfiltration via Compromised Web Portal Network Connection",
        "status": "experimental",
        "description": "Detects suspicious outbound network connections from web server processes to external IP addresses on standard HTTP/HTTPS ports, indicative of credential exfiltration following modification of legitimate JavaScript files on VPN portals (T1056.003). Attackers compromise files such as lastauthserverused.js to intercept login form submissions, base64-encode harvested credentials, and exfiltrate them via GET requests to attacker-controlled domains. This rule identifies the network exfiltration phase by monitoring for unusual outbound connections from web server worker processes that deviate from expected internal traffic patterns.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1056.003"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_web_process": {
            "EventID": [
              5156
            ],
            "ProcessName": [
              "*\\w3wp.exe",
              "*\\nginx.exe",
              "*\\httpd.exe",
              "*\\tomcat*.exe",
              "*\\php*.exe",
              "*\\python*.exe"
            ]
          },
          "selection_exfil_channel": {
            "IpPort": [
              80,
              443
            ]
          },
          "filter_internal_dest": {
            "IpAddress": [
              "10.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "192.168.*",
              "127.*",
              "169.254.*",
              "::1",
              "fe80:*",
              "fc00:*",
              "fd00:*"
            ]
          },
          "condition": "selection_web_process and selection_exfil_channel and not filter_internal_dest"
        },
        "falsepositives": [
          "Legitimate outbound connections from web servers to external APIs, content delivery networks (CDNs), or cloud-based management and monitoring services",
          "Reverse proxy or load balancer configurations where the web server process legitimately connects to external backend application servers or health check endpoints"
        ],
        "level": "high",
        "raw": "title: Credential Exfiltration via Compromised Web Portal Network Connection\nid: 2216adcf-8d60-4fec-aeed-84830812b54c\nstatus: experimental\ndescription: Detects suspicious outbound network connections from web server processes to external IP addresses on standard HTTP/HTTPS ports, indicative of credential exfiltration following modification of legitimate JavaScript files on VPN portals (T1056.003). Attackers compromise files such as lastauthserverused.js to intercept login form submissions, base64-encode harvested credentials, and exfiltrate them via GET requests to attacker-controlled domains. This rule identifies the network exfiltration phase by monitoring for unusual outbound connections from web server worker processes that deviate from expected internal traffic patterns.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1056.003\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_web_process:\n    EventID:\n      - 5156\n    ProcessName:\n      - \"*\\\\w3wp.exe\"\n      - \"*\\\\nginx.exe\"\n      - \"*\\\\httpd.exe\"\n      - \"*\\\\tomcat*.exe\"\n      - \"*\\\\php*.exe\"\n      - \"*\\\\python*.exe\"\n  selection_exfil_channel:\n    IpPort:\n      - 80\n      - 443\n  filter_internal_dest:\n    IpAddress:\n      - 10.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 192.168.*\n      - 127.*\n      - 169.254.*\n      - ::1\n      - fe80:*\n      - fc00:*\n      - fd00:*\n  condition: selection_web_process and selection_exfil_channel and not filter_internal_dest\nfalsepositives:\n  - Legitimate outbound connections from web servers to external APIs, content delivery networks (CDNs), or cloud-based management and monitoring services\n  - Reverse proxy or load balancer configurations where the web server process legitimately connects to external backend application servers or health check endpoints\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "2216adcf-8d60-4fec-aeed-84830812b54c",
        "format": "sigma",
        "overallScore": 8,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "ProcessName",
          "IpPort",
          "IpAddress"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/icedid_execution_of_dll_disguised_as_image_via_powershell.yml",
      "rule": {
        "id": "2b5b97bf-a923-4ddb-8b7b-5e9b761f0e66",
        "title": "IcedID Execution of DLL Disguised as Image via PowerShell",
        "status": "experimental",
        "description": "Detects PowerShell script blocks that attempt to execute DLLs disguised with image file extensions (e.g., .jpg, .gif, .png) using rundll32.exe. This behavior is characteristic of IcedID malware attempting to evade file-type filtering and manual inspection by using steganography-like naming conventions.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1027.003",
          "attack.execution",
          "attack.t1059.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "ps_script",
          "service": "powershell"
        },
        "detection": {
          "selection_rundll_image": {
            "ScriptBlockText": [
              "*rundll32*.jpg*",
              "*rundll32*.png*",
              "*rundll32*.gif*",
              "*rundll32*.bmp*",
              "*rundll32*.jpeg*"
            ]
          },
          "selection_icedid_indicators": {
            "ScriptBlockText": [
              "*,init*",
              "*,main*",
              "*C:\\ProgramData\\*",
              "*C:\\Users\\Public\\*"
            ]
          },
          "filter_legitimate_apps": {
            "ScriptBlockText": [
              "*Windows\\System32\\Printing_Admin_Scripts*",
              "*Program Files\\*",
              "*Program Files (x86)\\*"
            ]
          },
          "condition": "selection_rundll_image and selection_icedid_indicators and not filter_legitimate_apps"
        },
        "falsepositives": [
          "Legitimate administrative scripts that might use rundll32 to call specific handlers where the parameter accidentally includes an image path",
          "Third-party software installers that use non-standard naming conventions for temporary DLL files during setup",
          "Security auditing tools or scripts performing file integrity checks that happen to reference these strings"
        ],
        "level": "high",
        "raw": "title: IcedID Execution of DLL Disguised as Image via PowerShell\nid: 2b5b97bf-a923-4ddb-8b7b-5e9b761f0e66\nstatus: experimental\ndescription: Detects PowerShell script blocks that attempt to execute DLLs disguised with image file extensions (e.g., .jpg, .gif, .png) using rundll32.exe. This behavior is characteristic of IcedID malware attempting to evade file-type filtering and manual inspection by using steganography-like naming conventions.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1027.003\n  - attack.execution\n  - attack.t1059.001\nlogsource:\n  product: windows\n  category: ps_script\n  service: powershell\ndetection:\n  selection_rundll_image:\n    ScriptBlockText:\n      - \"*rundll32*.jpg*\"\n      - \"*rundll32*.png*\"\n      - \"*rundll32*.gif*\"\n      - \"*rundll32*.bmp*\"\n      - \"*rundll32*.jpeg*\"\n  selection_icedid_indicators:\n    ScriptBlockText:\n      - \"*,init*\"\n      - \"*,main*\"\n      - \"*C:\\\\ProgramData\\\\*\"\n      - \"*C:\\\\Users\\\\Public\\\\*\"\n  filter_legitimate_apps:\n    ScriptBlockText:\n      - \"*Windows\\\\System32\\\\Printing_Admin_Scripts*\"\n      - \"*Program Files\\\\*\"\n      - \"*Program Files (x86)\\\\*\"\n  condition: selection_rundll_image and selection_icedid_indicators and not filter_legitimate_apps\nfalsepositives:\n  - Legitimate administrative scripts that might use rundll32 to call specific handlers where the parameter accidentally includes an image path\n  - Third-party software installers that use non-standard naming conventions for temporary DLL files during setup\n  - Security auditing tools or scripts performing file integrity checks that happen to reference these strings\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Logsource combination not found in catalog: product=\"windows\", category=\"ps_script\", service=\"powershell\""
        ]
      },
      "qualityScore": {
        "ruleId": "2b5b97bf-a923-4ddb-8b7b-5e9b761f0e66",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ScriptBlockText"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": true
      }
    },
    {
      "filePath": "rules/sigma/creation_of_suspicious_scheduled_task_for_icedid_persistence.yml",
      "rule": {
        "id": "53fbf5e1-a24c-4535-a3e5-1af17cb3bad9",
        "title": "Creation of Suspicious Scheduled Task for IcedID Persistence",
        "status": "experimental",
        "description": "Detects the creation of a scheduled task that executes rundll32.exe from the AppData directory, often used by IcedID to maintain persistence and load its first-stage DLL. The rule monitors for specific command-line patterns like custom flags and DLL execution from user-writable paths.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1053.005"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_task_creation": {
            "EventID": [
              4698,
              4702
            ]
          },
          "selection_icedid_behavior": {
            "ProcessName": [
              "*\\rundll32.exe"
            ],
            "ServiceName": [
              "*AppData\\Roaming*",
              "*--od=*",
              "*Cadiak.dll*"
            ]
          },
          "filter_legitimate_admin": {
            "SubjectUserName": [
              "SYSTEM",
              "NETWORK SERVICE",
              "LOCAL SERVICE"
            ],
            "SubjectDomainName": [
              "NT AUTHORITY"
            ]
          },
          "condition": "selection_task_creation and selection_icedid_behavior and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Legitimate software updates that use scheduled tasks to run DLLs from user-specific application data folders.",
          "Administrative scripts or deployment tools that create tasks for per-user application configurations."
        ],
        "level": "high",
        "raw": "title: Creation of Suspicious Scheduled Task for IcedID Persistence\nid: 53fbf5e1-a24c-4535-a3e5-1af17cb3bad9\nstatus: experimental\ndescription: Detects the creation of a scheduled task that executes rundll32.exe from the AppData directory, often used by IcedID to maintain persistence and load its first-stage DLL. The rule monitors for specific command-line patterns like custom flags and DLL execution from user-writable paths.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1053.005\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_task_creation:\n    EventID:\n      - 4698\n      - 4702\n  selection_icedid_behavior:\n    ProcessName:\n      - \"*\\\\rundll32.exe\"\n    ServiceName:\n      - \"*AppData\\\\Roaming*\"\n      - \"*--od=*\"\n      - \"*Cadiak.dll*\"\n  filter_legitimate_admin:\n    SubjectUserName:\n      - SYSTEM\n      - NETWORK SERVICE\n      - LOCAL SERVICE\n    SubjectDomainName:\n      - NT AUTHORITY\n  condition: selection_task_creation and selection_icedid_behavior and not filter_legitimate_admin\nfalsepositives:\n  - Legitimate software updates that use scheduled tasks to run DLLs from user-specific application data folders.\n  - Administrative scripts or deployment tools that create tasks for per-user application configurations.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "53fbf5e1-a24c-4535-a3e5-1af17cb3bad9",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 9,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "ProcessName",
          "ServiceName",
          "SubjectUserName",
          "SubjectDomainName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_service_installation_for_vulnerable_driver_loading.yml",
      "rule": {
        "id": "b18095e0-8d35-4c68-998c-89644dc2560f",
        "title": "Suspicious Service Installation for Vulnerable Driver Loading",
        "status": "experimental",
        "description": "Detects the installation of Windows services associated with known vulnerable drivers (RTCore64.sys, DBUtil_2_3.sys) often used in Bring Your Own Vulnerable Driver (BYOVD) attacks to disable EDR/AV protections by stripping PPL flags. This behavior is consistent with tools like EDRSandBlast used by SVR actors.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562.001"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_service_install": {
            "EventID": [
              4697
            ]
          },
          "selection_vulnerable_drivers": {
            "ServiceName": [
              "*RTCore64*",
              "*DBUtil*",
              "*EDRSandBlast*"
            ],
            "ProcessName": [
              "*\\temp\\*",
              "*\\Users\\Public\\*",
              "*\\AppData\\Local\\Temp\\*"
            ]
          },
          "filter_legitimate_msi": {
            "ServiceName": [
              "RTCore64"
            ],
            "ProcessName": [
              "C:\\Program Files (x86)\\MSI Afterburner\\*"
            ]
          },
          "filter_legitimate_dell": {
            "ServiceName": [
              "dbutil_2_3"
            ],
            "ProcessName": [
              "C:\\Windows\\Temp\\inv*.tmp\\*",
              "C:\\Program Files\\Dell\\*"
            ]
          },
          "condition": "selection_service_install and selection_vulnerable_drivers and not (filter_legitimate_msi or filter_legitimate_dell)"
        },
        "falsepositives": [
          "Legitimate installation of MSI Afterburner utility for GPU overclocking",
          "Dell firmware or driver update utilities performing legitimate maintenance tasks",
          "Authorized security auditing or penetration testing activities using BYOVD proof-of-concepts"
        ],
        "level": "high",
        "raw": "title: Suspicious Service Installation for Vulnerable Driver Loading\nid: b18095e0-8d35-4c68-998c-89644dc2560f\nstatus: experimental\ndescription: Detects the installation of Windows services associated with known vulnerable drivers (RTCore64.sys, DBUtil_2_3.sys) often used in Bring Your Own Vulnerable Driver (BYOVD) attacks to disable EDR/AV protections by stripping PPL flags. This behavior is consistent with tools like EDRSandBlast used by SVR actors.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1562.001\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_service_install:\n    EventID:\n      - 4697\n  selection_vulnerable_drivers:\n    ServiceName:\n      - \"*RTCore64*\"\n      - \"*DBUtil*\"\n      - \"*EDRSandBlast*\"\n    ProcessName:\n      - \"*\\\\temp\\\\*\"\n      - \"*\\\\Users\\\\Public\\\\*\"\n      - \"*\\\\AppData\\\\Local\\\\Temp\\\\*\"\n  filter_legitimate_msi:\n    ServiceName:\n      - RTCore64\n    ProcessName:\n      - C:\\Program Files (x86)\\MSI Afterburner\\*\n  filter_legitimate_dell:\n    ServiceName:\n      - dbutil_2_3\n    ProcessName:\n      - C:\\Windows\\Temp\\inv*.tmp\\*\n      - C:\\Program Files\\Dell\\*\n  condition: selection_service_install and selection_vulnerable_drivers and not (filter_legitimate_msi or filter_legitimate_dell)\nfalsepositives:\n  - Legitimate installation of MSI Afterburner utility for GPU overclocking\n  - Dell firmware or driver update utilities performing legitimate maintenance tasks\n  - Authorized security auditing or penetration testing activities using BYOVD proof-of-concepts\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "b18095e0-8d35-4c68-998c-89644dc2560f",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ServiceName",
          "ProcessName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.6666666666666666,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/internal_network_service_discovery_via_renamed_scanner_utility.yml",
      "rule": {
        "id": "03179656-9522-4adb-817a-ff99b88a0ba2",
        "title": "Internal Network Service Discovery via Renamed Scanner Utility",
        "status": "experimental",
        "description": "Detects internal network scanning and enumeration activity (WMI, SNMP, SMB) initiated by processes with suspicious names like 'Intel.exe' or 'Dell.exe' located in the root directory, a behavior associated with Black Basta affiliates using SoftPerfect Network Scanner.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.discovery",
          "attack.t1046"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_suspicious_image": {
            "Image": [
              "C:\\Intel.exe",
              "C:\\Dell.exe",
              "*\\netscan.exe"
            ]
          },
          "selection_discovery_ports": {
            "DestinationPort": [
              135,
              137,
              139,
              161,
              162,
              445,
              5985,
              5986
            ],
            "Initiated": [
              true
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "Image": [
              "*\\Windows\\System32\\*",
              "*\\Windows\\SysWOW64\\*"
            ]
          },
          "filter_known_scanners": {
            "DestinationHostname": [
              "localhost",
              "127.0.0.1"
            ]
          },
          "condition": "selection_suspicious_image and selection_discovery_ports and not (filter_legitimate_admin or filter_known_scanners)"
        },
        "falsepositives": [
          "Legitimate IT inventory or asset management tools that use vendor-named executables for network discovery.",
          "Internal vulnerability scanners or network monitoring solutions configured to run from non-standard paths."
        ],
        "level": "high",
        "raw": "title: Internal Network Service Discovery via Renamed Scanner Utility\nid: 03179656-9522-4adb-817a-ff99b88a0ba2\nstatus: experimental\ndescription: Detects internal network scanning and enumeration activity (WMI, SNMP, SMB) initiated by processes with suspicious names like 'Intel.exe' or 'Dell.exe' located in the root directory, a behavior associated with Black Basta affiliates using SoftPerfect Network Scanner.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.discovery\n  - attack.t1046\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_suspicious_image:\n    Image:\n      - C:\\Intel.exe\n      - C:\\Dell.exe\n      - \"*\\\\netscan.exe\"\n  selection_discovery_ports:\n    DestinationPort:\n      - 135\n      - 137\n      - 139\n      - 161\n      - 162\n      - 445\n      - 5985\n      - 5986\n    Initiated:\n      - true\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    Image:\n      - \"*\\\\Windows\\\\System32\\\\*\"\n      - \"*\\\\Windows\\\\SysWOW64\\\\*\"\n  filter_known_scanners:\n    DestinationHostname:\n      - localhost\n      - 127.0.0.1\n  condition: selection_suspicious_image and selection_discovery_ports and not (filter_legitimate_admin or filter_known_scanners)\nfalsepositives:\n  - Legitimate IT inventory or asset management tools that use vendor-named executables for network discovery.\n  - Internal vulnerability scanners or network monitoring solutions configured to run from non-standard paths.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "03179656-9522-4adb-817a-ff99b88a0ba2",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "DestinationPort",
          "Initiated",
          "User",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/edr_and_antivirus_service_termination_via_backstab_or_powershell.yml",
      "rule": {
        "id": "75f2dd53-6eb4-4e19-bb38-a2a9ef372bf1",
        "title": "EDR and Antivirus Service Termination via Backstab or PowerShell",
        "status": "experimental",
        "description": "Detects the termination or disabling of security services, often associated with tools like Backstab or malicious PowerShell scripts. Attackers use these methods to impair defenses and avoid detection during ransomware deployment.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562.001"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_service_stop": {
            "EventID": [
              4697,
              4689
            ],
            "ServiceName": [
              "*WinDefend*",
              "*MpsSvc*",
              "*Sense*",
              "*WdNisSvc*",
              "*Sentinel*",
              "*Cylance*",
              "*CarbonBlack*",
              "*CrowdStrike*"
            ]
          },
          "selection_backstab_behavior": {
            "ProcessName": [
              "*backstab.exe*",
              "*terminator.exe*"
            ]
          },
          "filter_legitimate_admin": {
            "SubjectUserName": [
              "SYSTEM",
              "NETWORK SERVICE"
            ],
            "ProcessName": [
              "C:\\Windows\\System32\\services.exe",
              "C:\\Windows\\System32\\msiexec.exe"
            ]
          },
          "condition": "(selection_service_stop or selection_backstab_behavior) and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Legitimate security software updates that require service restarts or temporary termination",
          "Administrative troubleshooting by authorized IT personnel using scripts to reset security agents",
          "Uninstallation of security products by authorized administrators during system decommissioning"
        ],
        "level": "high",
        "raw": "title: EDR and Antivirus Service Termination via Backstab or PowerShell\nid: 75f2dd53-6eb4-4e19-bb38-a2a9ef372bf1\nstatus: experimental\ndescription: Detects the termination or disabling of security services, often associated with tools like Backstab or malicious PowerShell scripts. Attackers use these methods to impair defenses and avoid detection during ransomware deployment.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1562.001\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_service_stop:\n    EventID:\n      - 4697\n      - 4689\n    ServiceName:\n      - \"*WinDefend*\"\n      - \"*MpsSvc*\"\n      - \"*Sense*\"\n      - \"*WdNisSvc*\"\n      - \"*Sentinel*\"\n      - \"*Cylance*\"\n      - \"*CarbonBlack*\"\n      - \"*CrowdStrike*\"\n  selection_backstab_behavior:\n    ProcessName:\n      - \"*backstab.exe*\"\n      - \"*terminator.exe*\"\n  filter_legitimate_admin:\n    SubjectUserName:\n      - SYSTEM\n      - NETWORK SERVICE\n    ProcessName:\n      - C:\\Windows\\System32\\services.exe\n      - C:\\Windows\\System32\\msiexec.exe\n  condition: (selection_service_stop or selection_backstab_behavior) and not filter_legitimate_admin\nfalsepositives:\n  - Legitimate security software updates that require service restarts or temporary termination\n  - Administrative troubleshooting by authorized IT personnel using scripts to reset security agents\n  - Uninstallation of security products by authorized administrators during system decommissioning\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "75f2dd53-6eb4-4e19-bb38-a2a9ef372bf1",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ServiceName",
          "ProcessName",
          "SubjectUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_outbound_network_connection_from_vpn_appliance_via_web_component_exploitation.yml",
      "rule": {
        "id": "fa484f21-b72b-4c8b-9ab6-c9a6c00be946",
        "title": "Suspicious Outbound Network Connection from VPN Appliance via Web Component Exploitation",
        "status": "experimental",
        "description": "Detects outbound network connections from processes associated with web services or system utilities on VPN appliances, which may indicate post-exploitation activity following the abuse of CVE-2023-46805 and CVE-2024-21887. Attackers often use curl, wget, or ssh to exfiltrate data or fetch secondary payloads after gaining RCE via vulnerable CGI endpoints.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1190",
          "attack.execution",
          "attack.t1059"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_web_process": {
            "Image": [
              "*\\curl.exe",
              "*\\wget.exe",
              "*\\ssh.exe",
              "*\\python.exe",
              "*\\perl.exe",
              "*\\bash.exe",
              "*\\sh.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_destination": {
            "DestinationPort": [
              22,
              80,
              443,
              8080,
              8443
            ],
            "Protocol": "tcp"
          },
          "filter_legitimate_updates": {
            "DestinationHostname": [
              "download.pulsesecure.net",
              "*.ivanti.com",
              "*.microsoft.com",
              "*.windowsupdate.com"
            ]
          },
          "filter_local_admin": {
            "DestinationIp": [
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "127.0.0.1"
            ]
          },
          "condition": "selection_web_process and selection_destination and not (filter_legitimate_updates or filter_local_admin)"
        },
        "falsepositives": [
          "Legitimate administrative scripts using curl or python to check for updates or sync configurations with vendor repositories.",
          "Automated monitoring tools or vulnerability scanners performing outbound checks to verify appliance health or connectivity."
        ],
        "level": "high",
        "raw": "title: Suspicious Outbound Network Connection from VPN Appliance via Web Component Exploitation\nid: fa484f21-b72b-4c8b-9ab6-c9a6c00be946\nstatus: experimental\ndescription: Detects outbound network connections from processes associated with web services or system utilities on VPN appliances, which may indicate post-exploitation activity following the abuse of CVE-2023-46805 and CVE-2024-21887. Attackers often use curl, wget, or ssh to exfiltrate data or fetch secondary payloads after gaining RCE via vulnerable CGI endpoints.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1190\n  - attack.execution\n  - attack.t1059\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_web_process:\n    Image:\n      - \"*\\\\curl.exe\"\n      - \"*\\\\wget.exe\"\n      - \"*\\\\ssh.exe\"\n      - \"*\\\\python.exe\"\n      - \"*\\\\perl.exe\"\n      - \"*\\\\bash.exe\"\n      - \"*\\\\sh.exe\"\n    Initiated:\n      - true\n  selection_destination:\n    DestinationPort:\n      - 22\n      - 80\n      - 443\n      - 8080\n      - 8443\n    Protocol: tcp\n  filter_legitimate_updates:\n    DestinationHostname:\n      - download.pulsesecure.net\n      - \"*.ivanti.com\"\n      - \"*.microsoft.com\"\n      - \"*.windowsupdate.com\"\n  filter_local_admin:\n    DestinationIp:\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 127.0.0.1\n  condition: selection_web_process and selection_destination and not (filter_legitimate_updates or filter_local_admin)\nfalsepositives:\n  - Legitimate administrative scripts using curl or python to check for updates or sync configurations with vendor repositories.\n  - Automated monitoring tools or vulnerability scanners performing outbound checks to verify appliance health or connectivity.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "fa484f21-b72b-4c8b-9ab6-c9a6c00be946",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "Protocol",
          "DestinationHostname",
          "DestinationIp"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/blackcat_ransomware_execution_via_environmental_keying.yml",
      "rule": {
        "id": "8fd10a93-7587-460d-904d-9e30ec0f5c76",
        "title": "BlackCat Ransomware Execution via Environmental Keying",
        "status": "experimental",
        "description": "Detects the execution of BlackCat (ALPHV) ransomware by identifying specific command-line arguments such as '--access-token'. This is a form of environmental keying used to prevent automated sandbox analysis and ensure only authorized affiliates can trigger the encryption payload.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1480.001",
          "attack.impact",
          "attack.t1486"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_access_token": {
            "CommandLine": [
              "*--access-token*"
            ]
          },
          "selection_ransomware_flags": {
            "CommandLine": [
              "*--no-vm-kill*",
              "*--no-vm-snapshot*",
              "*--ui-path*",
              "*--propagate*",
              "*--child*"
            ]
          },
          "filter_legitimate_tools": {
            "Company": [
              "Microsoft Corporation",
              "Google LLC",
              "VMware, Inc."
            ],
            "CommandLine": [
              "*--access-token-file*",
              "*gcloud*",
              "*kubectl*"
            ]
          },
          "condition": "(selection_access_token or selection_ransomware_flags) and not filter_legitimate_tools"
        },
        "falsepositives": [
          "Cloud management CLI tools (like gcloud or kubectl) that might use similar token-based authentication flags in specific scripts.",
          "Internal custom-developed applications that use '--access-token' for legitimate API authentication during automated deployment.",
          "Security testing or breach and attack simulation (BAS) tools mimicking ransomware behavior."
        ],
        "level": "critical",
        "raw": "title: BlackCat Ransomware Execution via Environmental Keying\nid: 8fd10a93-7587-460d-904d-9e30ec0f5c76\nstatus: experimental\ndescription: Detects the execution of BlackCat (ALPHV) ransomware by identifying specific command-line arguments such as '--access-token'. This is a form of environmental keying used to prevent automated sandbox analysis and ensure only authorized affiliates can trigger the encryption payload.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1480.001\n  - attack.impact\n  - attack.t1486\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_access_token:\n    CommandLine:\n      - \"*--access-token*\"\n  selection_ransomware_flags:\n    CommandLine:\n      - \"*--no-vm-kill*\"\n      - \"*--no-vm-snapshot*\"\n      - \"*--ui-path*\"\n      - \"*--propagate*\"\n      - \"*--child*\"\n  filter_legitimate_tools:\n    Company:\n      - Microsoft Corporation\n      - Google LLC\n      - VMware, Inc.\n    CommandLine:\n      - \"*--access-token-file*\"\n      - \"*gcloud*\"\n      - \"*kubectl*\"\n  condition: (selection_access_token or selection_ransomware_flags) and not filter_legitimate_tools\nfalsepositives:\n  - Cloud management CLI tools (like gcloud or kubectl) that might use similar token-based authentication flags in specific scripts.\n  - Internal custom-developed applications that use '--access-token' for legitimate API authentication during automated deployment.\n  - Security testing or breach and attack simulation (BAS) tools mimicking ransomware behavior.\nlevel: critical\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "8fd10a93-7587-460d-904d-9e30ec0f5c76",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "CommandLine",
          "Company"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/system_uuid_discovery_via_wmic.yml",
      "rule": {
        "id": "038c040f-d025-48e4-88d3-a31fe8ef345e",
        "title": "System UUID Discovery via WMIC",
        "status": "experimental",
        "description": "Detects the execution of WMIC to retrieve the system Universally Unique Identifier (UUID). This behavior is frequently observed in ransomware families like BlackCat (ALPHV) to generate unique victim identifiers and access keys for recovery portals.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.discovery",
          "attack.t1082"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_wmic": {
            "Image": [
              "*\\wmic.exe"
            ],
            "CommandLine": [
              "*csproduct*",
              "*uuid*"
            ]
          },
          "selection_specific_args": {
            "CommandLine": [
              "*get uuid*"
            ]
          },
          "filter_legitimate_inventory": {
            "ParentImage": [
              "*\\LTSvc.exe",
              "*\\CcmExec.exe",
              "*\\MonitoringHost.exe",
              "*\\agent.exe"
            ],
            "Company": [
              "Microsoft Corporation",
              "Dell Inc",
              "Hewlett-Packard"
            ]
          },
          "condition": "selection_wmic and selection_specific_args and not filter_legitimate_inventory"
        },
        "falsepositives": [
          "IT Asset Management and Inventory software (e.g., SCCM, LabTech) querying hardware identifiers for device tracking.",
          "Legitimate hardware diagnostic tools or OEM support software (e.g., Dell SupportAssist) verifying system identity."
        ],
        "level": "high",
        "raw": "title: System UUID Discovery via WMIC\nid: 038c040f-d025-48e4-88d3-a31fe8ef345e\nstatus: experimental\ndescription: Detects the execution of WMIC to retrieve the system Universally Unique Identifier (UUID). This behavior is frequently observed in ransomware families like BlackCat (ALPHV) to generate unique victim identifiers and access keys for recovery portals.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.discovery\n  - attack.t1082\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_wmic:\n    Image:\n      - \"*\\\\wmic.exe\"\n    CommandLine:\n      - \"*csproduct*\"\n      - \"*uuid*\"\n  selection_specific_args:\n    CommandLine:\n      - \"*get uuid*\"\n  filter_legitimate_inventory:\n    ParentImage:\n      - \"*\\\\LTSvc.exe\"\n      - \"*\\\\CcmExec.exe\"\n      - \"*\\\\MonitoringHost.exe\"\n      - \"*\\\\agent.exe\"\n    Company:\n      - Microsoft Corporation\n      - Dell Inc\n      - Hewlett-Packard\n  condition: selection_wmic and selection_specific_args and not filter_legitimate_inventory\nfalsepositives:\n  - IT Asset Management and Inventory software (e.g., SCCM, LabTech) querying hardware identifiers for device tracking.\n  - Legitimate hardware diagnostic tools or OEM support software (e.g., Dell SupportAssist) verifying system identity.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "038c040f-d025-48e4-88d3-a31fe8ef345e",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "ParentImage",
          "Company"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/inhibit_system_recovery_via_vssadmin_or_bcdedit.yml",
      "rule": {
        "id": "9c6204d0-7392-42b7-8b93-4843e0227253",
        "title": "Inhibit System Recovery via Vssadmin or Bcdedit",
        "status": "experimental",
        "description": "Detects the deletion of volume shadow copies and the disabling of Windows recovery options. This behavior is frequently used by ransomware, such as BlackCat, to prevent victims from restoring data from backups or system recovery points.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.impact",
          "attack.t1490"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_vssadmin": {
            "CommandLine": [
              "*vssadmin* delete shadows*",
              "*wmic* shadowcopy delete*"
            ]
          },
          "selection_recovery": {
            "CommandLine": [
              "*bcdedit* /set *recoveryenabled* no*",
              "*bcdedit* /set *bootstatuspolicy* ignoreallfailures*"
            ]
          },
          "filter_legitimate_admins": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "ParentImage": [
              "*\\CcmExec.exe",
              "*\\msiexec.exe",
              "*\\VeeamGuestHelper.exe"
            ]
          },
          "condition": "(selection_vssadmin or selection_recovery) and not filter_legitimate_admins"
        },
        "falsepositives": [
          "Legitimate backup software (e.g., Veeam, Veritas) performing maintenance or cleanup of shadow copies.",
          "System administrators manually troubleshooting boot issues or performing system upgrades that require disabling recovery features.",
          "Automated software deployment tools or installers that modify boot configuration as part of a legitimate update process."
        ],
        "level": "high",
        "raw": "title: Inhibit System Recovery via Vssadmin or Bcdedit\nid: 9c6204d0-7392-42b7-8b93-4843e0227253\nstatus: experimental\ndescription: Detects the deletion of volume shadow copies and the disabling of Windows recovery options. This behavior is frequently used by ransomware, such as BlackCat, to prevent victims from restoring data from backups or system recovery points.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.impact\n  - attack.t1490\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_vssadmin:\n    CommandLine:\n      - \"*vssadmin* delete shadows*\"\n      - \"*wmic* shadowcopy delete*\"\n  selection_recovery:\n    CommandLine:\n      - \"*bcdedit* /set *recoveryenabled* no*\"\n      - \"*bcdedit* /set *bootstatuspolicy* ignoreallfailures*\"\n  filter_legitimate_admins:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    ParentImage:\n      - \"*\\\\CcmExec.exe\"\n      - \"*\\\\msiexec.exe\"\n      - \"*\\\\VeeamGuestHelper.exe\"\n  condition: (selection_vssadmin or selection_recovery) and not filter_legitimate_admins\nfalsepositives:\n  - Legitimate backup software (e.g., Veeam, Veritas) performing maintenance or cleanup of shadow copies.\n  - System administrators manually troubleshooting boot issues or performing system upgrades that require disabling recovery features.\n  - Automated software deployment tools or installers that modify boot configuration as part of a legitimate update process.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "9c6204d0-7392-42b7-8b93-4843e0227253",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "CommandLine",
          "User",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_script_execution_for_credential_dumping_via_backup_software_access.yml",
      "rule": {
        "id": "01779099-0e38-4937-966e-ef6b5757c798",
        "title": "Suspicious Script Execution for Credential Dumping via Backup Software Access",
        "status": "experimental",
        "description": "Detects the execution of scripting engines such as PowerShell or Command Prompt by non-system user accounts, which may indicate an attempt to dump credentials from backup software configuration databases. This behavior is commonly observed when attackers target Veeam and similar enterprise backup solutions using publicly available scripts to extract stored credentials from configuration files and databases.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1555"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_event": {
            "EventID": [
              4688
            ]
          },
          "selection_process": {
            "ProcessName": [
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\cmd.exe",
              "*\\wscript.exe",
              "*\\cscript.exe",
              "*\\mshta.exe"
            ]
          },
          "filter_legitimate": {
            "SubjectUserName": [
              "SYSTEM",
              "NETWORK SERVICE",
              "LOCAL SERVICE"
            ]
          },
          "condition": "selection_event and selection_process and not filter_legitimate"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed by backup operators or system administrators during scheduled maintenance or configuration updates",
          "Automated deployment tools and configuration management agents (e.g., SCCM, Puppet, Ansible) executing scripts under service accounts not explicitly listed in the filter"
        ],
        "level": "high",
        "raw": "title: Suspicious Script Execution for Credential Dumping via Backup Software Access\nid: 01779099-0e38-4937-966e-ef6b5757c798\nstatus: experimental\ndescription: Detects the execution of scripting engines such as PowerShell or Command Prompt by non-system user accounts, which may indicate an attempt to dump credentials from backup software configuration databases. This behavior is commonly observed when attackers target Veeam and similar enterprise backup solutions using publicly available scripts to extract stored credentials from configuration files and databases.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1555\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_event:\n    EventID:\n      - 4688\n  selection_process:\n    ProcessName:\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\wscript.exe\"\n      - \"*\\\\cscript.exe\"\n      - \"*\\\\mshta.exe\"\n  filter_legitimate:\n    SubjectUserName:\n      - SYSTEM\n      - NETWORK SERVICE\n      - LOCAL SERVICE\n  condition: selection_event and selection_process and not filter_legitimate\nfalsepositives:\n  - Legitimate administrative scripts executed by backup operators or system administrators during scheduled maintenance or configuration updates\n  - Automated deployment tools and configuration management agents (e.g., SCCM, Puppet, Ansible) executing scripts under service accounts not explicitly listed in the filter\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "01779099-0e38-4937-966e-ef6b5757c798",
        "format": "sigma",
        "overallScore": 8,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "ProcessName",
          "SubjectUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.6666666666666666,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_process_spawned_by_svchost.exe_via_cobalt_strike_injection.yml",
      "rule": {
        "id": "5f7d522d-d723-463b-8db2-02dd4078ddeb",
        "title": "Suspicious Process Spawned by Svchost.exe via Cobalt Strike Injection",
        "status": "experimental",
        "description": "Detects suspicious child processes spawned by svchost.exe, which is a common indicator of post-exploitation activity following DLL injection by tools like Cobalt Strike. Beacons often inject into svchost.exe and subsequently spawn shells or discovery tools.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.privilege_escalation",
          "attack.t1055.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_parent": {
            "ParentImage": [
              "*\\svchost.exe"
            ]
          },
          "selection_child_processes": {
            "Image": [
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\net.exe",
              "*\\net1.exe",
              "*\\whoami.exe",
              "*\\nltest.exe",
              "*\\hostname.exe",
              "*\\ipconfig.exe"
            ]
          },
          "selection_suspicious_targets": {
            "Image": [
              "*\\rundll32.exe",
              "*\\regsvr32.exe"
            ],
            "CommandLine": [
              "*rundll32.exe",
              "*regsvr32.exe",
              "*rundll32.exe ",
              "*regsvr32.exe "
            ]
          },
          "filter_legitimate_svchost": {
            "Image": [
              "*\\runtimebroker.exe",
              "*\\werfault.exe",
              "*\\wermgr.exe"
            ],
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE",
              "NT AUTHORITY\\LOCAL SERVICE"
            ]
          },
          "condition": "selection_parent and (selection_child_processes or selection_suspicious_targets) and not filter_legitimate_svchost"
        },
        "falsepositives": [
          "Legitimate system management scripts or scheduled tasks that use svchost to launch administrative tools",
          "Security software or monitoring agents that may trigger child processes from a service host context",
          "Windows Error Reporting (WerFault.exe) triggered by a service crash"
        ],
        "level": "high",
        "raw": "title: Suspicious Process Spawned by Svchost.exe via Cobalt Strike Injection\nid: 5f7d522d-d723-463b-8db2-02dd4078ddeb\nstatus: experimental\ndescription: Detects suspicious child processes spawned by svchost.exe, which is a common indicator of post-exploitation activity following DLL injection by tools like Cobalt Strike. Beacons often inject into svchost.exe and subsequently spawn shells or discovery tools.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.privilege_escalation\n  - attack.t1055.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_parent:\n    ParentImage:\n      - \"*\\\\svchost.exe\"\n  selection_child_processes:\n    Image:\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\net.exe\"\n      - \"*\\\\net1.exe\"\n      - \"*\\\\whoami.exe\"\n      - \"*\\\\nltest.exe\"\n      - \"*\\\\hostname.exe\"\n      - \"*\\\\ipconfig.exe\"\n  selection_suspicious_targets:\n    Image:\n      - \"*\\\\rundll32.exe\"\n      - \"*\\\\regsvr32.exe\"\n    CommandLine:\n      - \"*rundll32.exe\"\n      - \"*regsvr32.exe\"\n      - \"*rundll32.exe \"\n      - \"*regsvr32.exe \"\n  filter_legitimate_svchost:\n    Image:\n      - \"*\\\\runtimebroker.exe\"\n      - \"*\\\\werfault.exe\"\n      - \"*\\\\wermgr.exe\"\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n      - NT AUTHORITY\\LOCAL SERVICE\n  condition: selection_parent and (selection_child_processes or selection_suspicious_targets) and not filter_legitimate_svchost\nfalsepositives:\n  - Legitimate system management scripts or scheduled tasks that use svchost to launch administrative tools\n  - Security software or monitoring agents that may trigger child processes from a service host context\n  - Windows Error Reporting (WerFault.exe) triggered by a service crash\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "5f7d522d-d723-463b-8db2-02dd4078ddeb",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ParentImage",
          "Image",
          "CommandLine",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/credential_dumping_via_registry_hive_export_and_lsa_configuration_modification.yml",
      "rule": {
        "id": "25d1354f-f092-4e36-a7d2-3a0ee33a59d0",
        "title": "Credential Dumping via Registry Hive Export and LSA Configuration Modification",
        "status": "experimental",
        "description": "Detects attempts to export sensitive registry hives (SAM, SECURITY, SYSTEM) using reg.exe or modifying LSA configuration to enable legacy LM hash storage. These actions are common precursors to credential extraction using tools like Mimikatz.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1003.001",
          "attack.t1003.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_registry_export": {
            "CommandLine": [
              "*reg* save *HKLM\\SAM*",
              "*reg* save *HKLM\\SECURITY*",
              "*reg* save *HKLM\\SYSTEM*",
              "*reg* export *HKLM\\SAM*",
              "*reg* export *HKLM\\SECURITY*",
              "*reg* export *HKLM\\SYSTEM*"
            ]
          },
          "selection_lsa_modification": {
            "CommandLine": [
              "*NoLMHash* /t REG_DWORD /d 0*",
              "*DisableRestrictedAdmin* /t REG_DWORD /d 0*"
            ]
          },
          "selection_staging": {
            "CommandLine": [
              "*Compress-Archive*\\Windows\\Temp\\*",
              "*7z*\\Windows\\Temp\\*.zip*",
              "*rar*\\Windows\\Temp\\*.zip*"
            ]
          },
          "filter_legitimate_backups": {
            "ParentImage": [
              "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
              "C:\\Program Files\\BackupAgent\\*"
            ],
            "User": [
              "NT AUTHORITY\\SYSTEM"
            ]
          },
          "condition": "(selection_registry_export or selection_lsa_modification or selection_staging) and not filter_legitimate_backups"
        },
        "falsepositives": [
          "Legitimate backup software or scripts performing system state backups",
          "System administrators manually backing up registry keys before performing sensitive configuration changes",
          "Security auditing tools performing authorized credential assessments"
        ],
        "level": "high",
        "raw": "title: Credential Dumping via Registry Hive Export and LSA Configuration Modification\nid: 25d1354f-f092-4e36-a7d2-3a0ee33a59d0\nstatus: experimental\ndescription: Detects attempts to export sensitive registry hives (SAM, SECURITY, SYSTEM) using reg.exe or modifying LSA configuration to enable legacy LM hash storage. These actions are common precursors to credential extraction using tools like Mimikatz.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1003.001\n  - attack.t1003.002\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_registry_export:\n    CommandLine:\n      - \"*reg* save *HKLM\\\\SAM*\"\n      - \"*reg* save *HKLM\\\\SECURITY*\"\n      - \"*reg* save *HKLM\\\\SYSTEM*\"\n      - \"*reg* export *HKLM\\\\SAM*\"\n      - \"*reg* export *HKLM\\\\SECURITY*\"\n      - \"*reg* export *HKLM\\\\SYSTEM*\"\n  selection_lsa_modification:\n    CommandLine:\n      - \"*NoLMHash* /t REG_DWORD /d 0*\"\n      - \"*DisableRestrictedAdmin* /t REG_DWORD /d 0*\"\n  selection_staging:\n    CommandLine:\n      - \"*Compress-Archive*\\\\Windows\\\\Temp\\\\*\"\n      - \"*7z*\\\\Windows\\\\Temp\\\\*.zip*\"\n      - \"*rar*\\\\Windows\\\\Temp\\\\*.zip*\"\n  filter_legitimate_backups:\n    ParentImage:\n      - C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\n      - C:\\Program Files\\BackupAgent\\*\n    User:\n      - NT AUTHORITY\\SYSTEM\n  condition: (selection_registry_export or selection_lsa_modification or selection_staging) and not filter_legitimate_backups\nfalsepositives:\n  - Legitimate backup software or scripts performing system state backups\n  - System administrators manually backing up registry keys before performing sensitive configuration changes\n  - Security auditing tools performing authorized credential assessments\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "25d1354f-f092-4e36-a7d2-3a0ee33a59d0",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "CommandLine",
          "ParentImage",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/inhibit_system_recovery_via_vssadmin_shadow_copy_deletion.yml",
      "rule": {
        "id": "f94c6e9f-15ec-4c1b-b2ce-f028a10d977c",
        "title": "Inhibit System Recovery via Vssadmin Shadow Copy Deletion",
        "status": "experimental",
        "description": "Detects the use of vssadmin.exe to delete volume shadow copies, a common technique used by ransomware like Black Basta to prevent data recovery. The rule looks for the specific 'delete shadows' command-line arguments which are rarely used in legitimate administrative workflows.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.impact",
          "attack.t1490"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_vssadmin": {
            "Image": [
              "*\\vssadmin.exe"
            ],
            "OriginalFileName": "VSSADMIN.EXE"
          },
          "selection_args": {
            "CommandLine": [
              "*delete*shadows*",
              "*/all*",
              "*/quiet*"
            ]
          },
          "filter_legitimate_admin": {
            "ParentImage": [
              "*\\Windows\\System32\\msiexec.exe",
              "*\\Windows\\System32\\wbem\\WmiPrvSE.exe"
            ],
            "User": [
              "NT AUTHORITY\\SYSTEM"
            ]
          },
          "condition": "selection_vssadmin and selection_args and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Legitimate backup software or disaster recovery solutions that manage shadow copies as part of their cleanup routine",
          "System administrators performing manual maintenance or troubleshooting of the Volume Shadow Copy Service"
        ],
        "level": "high",
        "raw": "title: Inhibit System Recovery via Vssadmin Shadow Copy Deletion\nid: f94c6e9f-15ec-4c1b-b2ce-f028a10d977c\nstatus: experimental\ndescription: Detects the use of vssadmin.exe to delete volume shadow copies, a common technique used by ransomware like Black Basta to prevent data recovery. The rule looks for the specific 'delete shadows' command-line arguments which are rarely used in legitimate administrative workflows.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.impact\n  - attack.t1490\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_vssadmin:\n    Image:\n      - \"*\\\\vssadmin.exe\"\n    OriginalFileName: VSSADMIN.EXE\n  selection_args:\n    CommandLine:\n      - \"*delete*shadows*\"\n      - \"*/all*\"\n      - \"*/quiet*\"\n  filter_legitimate_admin:\n    ParentImage:\n      - \"*\\\\Windows\\\\System32\\\\msiexec.exe\"\n      - \"*\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\"\n    User:\n      - NT AUTHORITY\\SYSTEM\n  condition: selection_vssadmin and selection_args and not filter_legitimate_admin\nfalsepositives:\n  - Legitimate backup software or disaster recovery solutions that manage shadow copies as part of their cleanup routine\n  - System administrators performing manual maintenance or troubleshooting of the Volume Shadow Copy Service\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "f94c6e9f-15ec-4c1b-b2ce-f028a10d977c",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "OriginalFileName",
          "CommandLine",
          "ParentImage",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_rundll32_execution_pattern_via_cobalt_strike.yml",
      "rule": {
        "id": "8466b079-3e11-48cb-879c-9cc4db004f9a",
        "title": "Suspicious Rundll32 Execution Pattern via Cobalt Strike",
        "status": "experimental",
        "description": "Detects rundll32.exe being used in a manner consistent with Cobalt Strike's default behavior for process injection and credential dumping, often targeting LSASS or being spawned from suspicious locations. This aligns with observed TTPs where rundll32 is used to facilitate memory dumping or lateral movement.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1003.001",
          "attack.defense_evasion",
          "attack.t1218.011"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_rundll_behavior": {
            "Image": [
              "*\\rundll32.exe"
            ],
            "CommandLine": [
              "*rundll32.exe",
              "*rundll32"
            ]
          },
          "selection_suspicious_context": {
            "CommandLine": [
              "*,#1",
              "*Control_RunDLL*",
              "*C:\\ProgramData\\*",
              "*C:\\Users\\Public\\*",
              "*AppData\\Roaming\\*"
            ],
            "ParentImage": [
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\wscript.exe",
              "*\\cscript.exe",
              "*\\mshta.exe"
            ]
          },
          "filter_legitimate_system": {
            "ParentImage": [
              "*\\system32\\svchost.exe",
              "*\\system32\\services.exe",
              "*\\system32\\msiexec.exe"
            ],
            "CommandLine": [
              "*shell32.dll,Control_RunDLL*",
              "*aeinv.dll*",
              "*update.dll*"
            ]
          },
          "condition": "selection_rundll_behavior and selection_suspicious_context and not filter_legitimate_system"
        },
        "falsepositives": [
          "Legitimate administrative scripts using rundll32 to invoke standard Windows DLL exports",
          "Third-party software installers that use rundll32 to register components from temporary directories"
        ],
        "level": "high",
        "raw": "title: Suspicious Rundll32 Execution Pattern via Cobalt Strike\nid: 8466b079-3e11-48cb-879c-9cc4db004f9a\nstatus: experimental\ndescription: Detects rundll32.exe being used in a manner consistent with Cobalt Strike's default behavior for process injection and credential dumping, often targeting LSASS or being spawned from suspicious locations. This aligns with observed TTPs where rundll32 is used to facilitate memory dumping or lateral movement.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1003.001\n  - attack.defense_evasion\n  - attack.t1218.011\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_rundll_behavior:\n    Image:\n      - \"*\\\\rundll32.exe\"\n    CommandLine:\n      - \"*rundll32.exe\"\n      - \"*rundll32\"\n  selection_suspicious_context:\n    CommandLine:\n      - \"*,#1\"\n      - \"*Control_RunDLL*\"\n      - \"*C:\\\\ProgramData\\\\*\"\n      - \"*C:\\\\Users\\\\Public\\\\*\"\n      - \"*AppData\\\\Roaming\\\\*\"\n    ParentImage:\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\wscript.exe\"\n      - \"*\\\\cscript.exe\"\n      - \"*\\\\mshta.exe\"\n  filter_legitimate_system:\n    ParentImage:\n      - \"*\\\\system32\\\\svchost.exe\"\n      - \"*\\\\system32\\\\services.exe\"\n      - \"*\\\\system32\\\\msiexec.exe\"\n    CommandLine:\n      - \"*shell32.dll,Control_RunDLL*\"\n      - \"*aeinv.dll*\"\n      - \"*update.dll*\"\n  condition: selection_rundll_behavior and selection_suspicious_context and not filter_legitimate_system\nfalsepositives:\n  - Legitimate administrative scripts using rundll32 to invoke standard Windows DLL exports\n  - Third-party software installers that use rundll32 to register components from temporary directories\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "8466b079-3e11-48cb-879c-9cc4db004f9a",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_exchange_web_services_mailbox_access_via_powershell.yml",
      "rule": {
        "id": "57ea5708-d3bb-471e-ac0b-9e09c8afc850",
        "title": "Suspicious Exchange Web Services Mailbox Access via PowerShell",
        "status": "experimental",
        "description": "Detects the use of PowerShell to interact with Exchange Web Services (EWS) for programmatic mailbox access. This behavior is consistent with attackers using OAuth applications with 'full_access_as_app' or 'ApplicationImpersonation' permissions to exfiltrate email data, as seen in Midnight Blizzard campaigns.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.collection",
          "attack.t1114.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_img": {
            "Image": [
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\pwsh.dll"
            ]
          },
          "selection_ews_cli": {
            "CommandLine": [
              "*Microsoft.Exchange.WebServices.Data*",
              "*.ExchangeService*",
              "*AutodiscoverUrl*",
              "*BindToItems*",
              "*FindItems*",
              "*full_access_as_app*",
              "*ApplicationImpersonation*"
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "ParentImage": [
              "*\\services.exe",
              "*\\msiexec.exe"
            ]
          },
          "filter_exchange_install": {
            "CommandLine": [
              "*\\Microsoft\\Exchange Server\\*"
            ],
            "Company": [
              "Microsoft Corporation"
            ]
          },
          "condition": "selection_img and selection_ews_cli and not (filter_legitimate_admin or filter_exchange_install)"
        },
        "falsepositives": [
          "Legitimate backup software or archival solutions that use EWS to index or back up mailboxes.",
          "Internal administrative scripts used by IT departments for bulk mailbox migrations or reporting.",
          "Monitoring tools that check Exchange health via EWS API calls."
        ],
        "level": "high",
        "raw": "title: Suspicious Exchange Web Services Mailbox Access via PowerShell\nid: 57ea5708-d3bb-471e-ac0b-9e09c8afc850\nstatus: experimental\ndescription: Detects the use of PowerShell to interact with Exchange Web Services (EWS) for programmatic mailbox access. This behavior is consistent with attackers using OAuth applications with 'full_access_as_app' or 'ApplicationImpersonation' permissions to exfiltrate email data, as seen in Midnight Blizzard campaigns.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.collection\n  - attack.t1114.002\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_img:\n    Image:\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\pwsh.dll\"\n  selection_ews_cli:\n    CommandLine:\n      - \"*Microsoft.Exchange.WebServices.Data*\"\n      - \"*.ExchangeService*\"\n      - \"*AutodiscoverUrl*\"\n      - \"*BindToItems*\"\n      - \"*FindItems*\"\n      - \"*full_access_as_app*\"\n      - \"*ApplicationImpersonation*\"\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    ParentImage:\n      - \"*\\\\services.exe\"\n      - \"*\\\\msiexec.exe\"\n  filter_exchange_install:\n    CommandLine:\n      - \"*\\\\Microsoft\\\\Exchange Server\\\\*\"\n    Company:\n      - Microsoft Corporation\n  condition: selection_img and selection_ews_cli and not (filter_legitimate_admin or filter_exchange_install)\nfalsepositives:\n  - Legitimate backup software or archival solutions that use EWS to index or back up mailboxes.\n  - Internal administrative scripts used by IT departments for bulk mailbox migrations or reporting.\n  - Monitoring tools that check Exchange health via EWS API calls.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "57ea5708-d3bb-471e-ac0b-9e09c8afc850",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "User",
          "ParentImage",
          "Company"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_task_manager_launch_via_command_shell.yml",
      "rule": {
        "id": "7a068fda-a097-4d8e-ae8a-bd59402abdce",
        "title": "Suspicious Task Manager Launch via Command Shell",
        "status": "experimental",
        "description": "Detects execution of Task Manager (taskmgr.exe) spawned by command shells or scripting interpreters. This pattern is commonly observed when attackers with interactive access use Task Manager to create LSASS process memory dumps for offline credential extraction, as opposed to normal GUI-based launch by users.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1003.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_taskmgr": {
            "Image": [
              "*\\taskmgr.exe"
            ],
            "OriginalFileName": [
              "taskmgr.exe"
            ]
          },
          "selection_suspicious_parent": {
            "ParentImage": [
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\wscript.exe",
              "*\\cscript.exe",
              "*\\mshta.exe",
              "*\\certutil.exe"
            ]
          },
          "filter_legitimate": {
            "ParentImage": [
              "*\\explorer.exe",
              "*\\winlogon.exe",
              "*\\userinit.exe"
            ]
          },
          "condition": "selection_taskmgr and selection_suspicious_parent and not filter_legitimate"
        },
        "falsepositives": [
          "Administrative scripts that programmatically launch Task Manager for remote system monitoring or troubleshooting sessions",
          "Automated remote administration tools that spawn Task Manager instances to check system resource usage on managed endpoints"
        ],
        "level": "high",
        "raw": "title: Suspicious Task Manager Launch via Command Shell\nid: 7a068fda-a097-4d8e-ae8a-bd59402abdce\nstatus: experimental\ndescription: Detects execution of Task Manager (taskmgr.exe) spawned by command shells or scripting interpreters. This pattern is commonly observed when attackers with interactive access use Task Manager to create LSASS process memory dumps for offline credential extraction, as opposed to normal GUI-based launch by users.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1003.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_taskmgr:\n    Image:\n      - \"*\\\\taskmgr.exe\"\n    OriginalFileName:\n      - taskmgr.exe\n  selection_suspicious_parent:\n    ParentImage:\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\wscript.exe\"\n      - \"*\\\\cscript.exe\"\n      - \"*\\\\mshta.exe\"\n      - \"*\\\\certutil.exe\"\n  filter_legitimate:\n    ParentImage:\n      - \"*\\\\explorer.exe\"\n      - \"*\\\\winlogon.exe\"\n      - \"*\\\\userinit.exe\"\n  condition: selection_taskmgr and selection_suspicious_parent and not filter_legitimate\nfalsepositives:\n  - Administrative scripts that programmatically launch Task Manager for remote system monitoring or troubleshooting sessions\n  - Automated remote administration tools that spawn Task Manager instances to check system resource usage on managed endpoints\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "7a068fda-a097-4d8e-ae8a-bd59402abdce",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "OriginalFileName",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/nokoyawa_ransomware_file_activity_and_ransom_note_creation.yml",
      "rule": {
        "id": "39c72346-0f5d-481d-9172-0b0ea18ee995",
        "title": "Nokoyawa Ransomware File Activity and Ransom Note Creation",
        "status": "experimental",
        "description": "Detects file events associated with Nokoyawa ransomware, including the creation of the NOKONOKO-readme.txt ransom note and the mass renaming of files to the .NOKONOKO extension. This activity is often preceded by the use of tools like IOBit Unlocker to release file locks.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.impact",
          "attack.t1486"
        ],
        "logsource": {
          "product": "windows",
          "category": "file_event"
        },
        "detection": {
          "selection_ransom_note": {
            "TargetFilename": [
              "*\\NOKONOKO-readme.txt"
            ]
          },
          "selection_encrypted_extension": {
            "TargetFilename": [
              "*.NOKONOKO"
            ]
          },
          "selection_suspicious_image": {
            "Image": [
              "*\\svchost.exe",
              "*\\IOBitUnlocker.exe",
              "*\\cmd.exe"
            ]
          },
          "filter_legitimate_system": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\LOCAL SERVICE",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "Image": [
              "C:\\Windows\\System32\\*"
            ]
          },
          "filter_backups": {
            "TargetFilename": [
              "*\\Backup\\*.NOKONOKO"
            ],
            "User": [
              "BACKUP_USER"
            ]
          },
          "condition": "(selection_ransom_note or (selection_encrypted_extension and selection_suspicious_image)) and not (filter_legitimate_system or filter_backups)"
        },
        "falsepositives": [
          "Legitimate backup software that might use a similar naming convention for temporary or encrypted archive files.",
          "Administrative scripts or file management tools used by system administrators that are misidentified due to custom extensions."
        ],
        "level": "critical",
        "raw": "title: Nokoyawa Ransomware File Activity and Ransom Note Creation\nid: 39c72346-0f5d-481d-9172-0b0ea18ee995\nstatus: experimental\ndescription: Detects file events associated with Nokoyawa ransomware, including the creation of the NOKONOKO-readme.txt ransom note and the mass renaming of files to the .NOKONOKO extension. This activity is often preceded by the use of tools like IOBit Unlocker to release file locks.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.impact\n  - attack.t1486\nlogsource:\n  product: windows\n  category: file_event\ndetection:\n  selection_ransom_note:\n    TargetFilename:\n      - \"*\\\\NOKONOKO-readme.txt\"\n  selection_encrypted_extension:\n    TargetFilename:\n      - \"*.NOKONOKO\"\n  selection_suspicious_image:\n    Image:\n      - \"*\\\\svchost.exe\"\n      - \"*\\\\IOBitUnlocker.exe\"\n      - \"*\\\\cmd.exe\"\n  filter_legitimate_system:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\LOCAL SERVICE\n      - NT AUTHORITY\\NETWORK SERVICE\n    Image:\n      - C:\\Windows\\System32\\*\n  filter_backups:\n    TargetFilename:\n      - \"*\\\\Backup\\\\*.NOKONOKO\"\n    User:\n      - BACKUP_USER\n  condition: (selection_ransom_note or (selection_encrypted_extension and selection_suspicious_image)) and not (filter_legitimate_system or filter_backups)\nfalsepositives:\n  - Legitimate backup software that might use a similar naming convention for temporary or encrypted archive files.\n  - Administrative scripts or file management tools used by system administrators that are misidentified due to custom extensions.\nlevel: critical\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "39c72346-0f5d-481d-9172-0b0ea18ee995",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "TargetFilename",
          "Image",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/data_exfiltration_via_filezilla_sftp_connection.yml",
      "rule": {
        "id": "e8197550-58f4-4675-a723-c235814d86e0",
        "title": "Data Exfiltration via FileZilla SFTP Connection",
        "status": "experimental",
        "description": "Detects network connections initiated by the FileZilla FTP client to remote servers over SFTP (port 22) or FTP (port 21). This behavior is consistent with attackers using legitimate file transfer tools to exfiltrate stolen data to actor-controlled infrastructure.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.exfiltration",
          "attack.t1048.003"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_filezilla_process": {
            "Image": [
              "*\\filezilla.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_network_behavior": {
            "DestinationPort": [
              21,
              22,
              990,
              14147
            ],
            "Protocol": [
              "tcp"
            ]
          },
          "selection_known_threat_ips": {
            "DestinationIp": [
              "45.155.204.5",
              "5.255.102.167",
              "45.61.139.206",
              "193.149.129.131",
              "5.255.105.55",
              "162.33.178.40",
              "91.215.85.183",
              "20.69.178.82",
              "152.89.196.49",
              "185.29.9.162",
              "174.138.188.6"
            ]
          },
          "filter_local_ranges": {
            "DestinationIp": [
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "127.*"
            ]
          },
          "condition": "(selection_filezilla_process and selection_network_behavior and not filter_local_ranges) or selection_known_threat_ips"
        },
        "falsepositives": [
          "Legitimate use of FileZilla by system administrators to manage remote web servers or backup repositories.",
          "Developers using SFTP to push code updates to external staging environments."
        ],
        "level": "high",
        "raw": "title: Data Exfiltration via FileZilla SFTP Connection\nid: e8197550-58f4-4675-a723-c235814d86e0\nstatus: experimental\ndescription: Detects network connections initiated by the FileZilla FTP client to remote servers over SFTP (port 22) or FTP (port 21). This behavior is consistent with attackers using legitimate file transfer tools to exfiltrate stolen data to actor-controlled infrastructure.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.exfiltration\n  - attack.t1048.003\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_filezilla_process:\n    Image:\n      - \"*\\\\filezilla.exe\"\n    Initiated:\n      - true\n  selection_network_behavior:\n    DestinationPort:\n      - 21\n      - 22\n      - 990\n      - 14147\n    Protocol:\n      - tcp\n  selection_known_threat_ips:\n    DestinationIp:\n      - 45.155.204.5\n      - 5.255.102.167\n      - 45.61.139.206\n      - 193.149.129.131\n      - 5.255.105.55\n      - 162.33.178.40\n      - 91.215.85.183\n      - 20.69.178.82\n      - 152.89.196.49\n      - 185.29.9.162\n      - 174.138.188.6\n  filter_local_ranges:\n    DestinationIp:\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 127.*\n  condition: (selection_filezilla_process and selection_network_behavior and not filter_local_ranges) or selection_known_threat_ips\nfalsepositives:\n  - Legitimate use of FileZilla by system administrators to manage remote web servers or backup repositories.\n  - Developers using SFTP to push code updates to external staging environments.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "e8197550-58f4-4675-a723-c235814d86e0",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "Protocol",
          "DestinationIp"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_internal_network_scanning_via_reconnaissance_tools.yml",
      "rule": {
        "id": "62ec2d07-98a7-4c82-8235-63a99d03161c",
        "title": "Suspicious Internal Network Scanning via Reconnaissance Tools",
        "status": "experimental",
        "description": "Detects potential internal network reconnaissance and service scanning behavior consistent with T1046. This rule identifies when known scanning tools such as curl, nmap, or masscan initiate connections to multiple internal RFC1918 addresses, indicating possible lateral movement reconnaissance through compromised VPN appliances or pivot hosts. High volumes of connections to internal destinations from non-standard processes are indicative of unauthorized discovery activity.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.discovery",
          "attack.t1046"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_recon_tools": {
            "Image": [
              "*\\curl.exe",
              "*\\nmap.exe",
              "*\\zenmap.exe",
              "*\\masscan.exe",
              "*\\zmap.exe",
              "*\\hping.exe",
              "*\\portqry.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_internal_scope": {
            "DestinationIp": [
              "10.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "192.168.*"
            ]
          },
          "filter_legitimate": {
            "Image": [
              "*\\chrome.exe",
              "*\\firefox.exe",
              "*\\msedge.exe",
              "*\\iexplore.exe"
            ]
          },
          "condition": "selection_recon_tools and selection_internal_scope | count(DestinationIp) by Image > 4 and not filter_legitimate"
        },
        "falsepositives": [
          "Authorized network administrators using curl or nmap for legitimate internal asset inventory and network troubleshooting",
          "Automated CI/CD deployment scripts that use curl to perform health checks across multiple internal service endpoints during deployments",
          "Security scanning tools and vulnerability management systems performing authorized internal network assessments"
        ],
        "level": "high",
        "raw": "title: Suspicious Internal Network Scanning via Reconnaissance Tools\nid: 62ec2d07-98a7-4c82-8235-63a99d03161c\nstatus: experimental\ndescription: Detects potential internal network reconnaissance and service scanning behavior consistent with T1046. This rule identifies when known scanning tools such as curl, nmap, or masscan initiate connections to multiple internal RFC1918 addresses, indicating possible lateral movement reconnaissance through compromised VPN appliances or pivot hosts. High volumes of connections to internal destinations from non-standard processes are indicative of unauthorized discovery activity.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.discovery\n  - attack.t1046\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_recon_tools:\n    Image:\n      - \"*\\\\curl.exe\"\n      - \"*\\\\nmap.exe\"\n      - \"*\\\\zenmap.exe\"\n      - \"*\\\\masscan.exe\"\n      - \"*\\\\zmap.exe\"\n      - \"*\\\\hping.exe\"\n      - \"*\\\\portqry.exe\"\n    Initiated:\n      - true\n  selection_internal_scope:\n    DestinationIp:\n      - 10.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 192.168.*\n  filter_legitimate:\n    Image:\n      - \"*\\\\chrome.exe\"\n      - \"*\\\\firefox.exe\"\n      - \"*\\\\msedge.exe\"\n      - \"*\\\\iexplore.exe\"\n  condition: selection_recon_tools and selection_internal_scope | count(DestinationIp) by Image > 4 and not filter_legitimate\nfalsepositives:\n  - Authorized network administrators using curl or nmap for legitimate internal asset inventory and network troubleshooting\n  - Automated CI/CD deployment scripts that use curl to perform health checks across multiple internal service endpoints during deployments\n  - Security scanning tools and vulnerability management systems performing authorized internal network assessments\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "62ec2d07-98a7-4c82-8235-63a99d03161c",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationIp"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/creation_of_new_user_account_for_oauth_consent_persistence.yml",
      "rule": {
        "id": "7f9fef59-b878-4693-969f-4c1b629a4e4a",
        "title": "Creation of New User Account for OAuth Consent Persistence",
        "status": "experimental",
        "description": "Detects the creation of a new user account followed by potential service principal or administrative activity. This behavior mimics techniques used by threat actors like Midnight Blizzard to create 'consent' accounts that grant permissions to malicious OAuth applications, ensuring persistence in the environment.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1136.003",
          "attack.t1098.003"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_account_creation": {
            "EventID": [
              4720,
              4722
            ]
          },
          "selection_service_context": {
            "ServiceName": [
              "*Azure*",
              "*Entra*",
              "*OAuth*",
              "*AppConsent*"
            ]
          },
          "filter_domain_controllers": {
            "SubjectUserName": [
              "*$",
              "MSOL_*"
            ],
            "SubjectDomainName": [
              "NT AUTHORITY"
            ]
          },
          "filter_admin_tools": {
            "ProcessName": [
              "*\\AzureADConnect.exe",
              "*\\Microsoft.Online.Reporting.MonitoringAgent.Startup.exe"
            ]
          },
          "condition": "(selection_account_creation and selection_service_context) and not (filter_domain_controllers or filter_admin_tools)"
        },
        "falsepositives": [
          "Legitimate automated provisioning of cloud-sync accounts via Azure AD Connect or similar identity synchronization tools.",
          "Administrative creation of service accounts specifically designated for managing legacy OAuth application integrations."
        ],
        "level": "high",
        "raw": "title: Creation of New User Account for OAuth Consent Persistence\nid: 7f9fef59-b878-4693-969f-4c1b629a4e4a\nstatus: experimental\ndescription: Detects the creation of a new user account followed by potential service principal or administrative activity. This behavior mimics techniques used by threat actors like Midnight Blizzard to create 'consent' accounts that grant permissions to malicious OAuth applications, ensuring persistence in the environment.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1136.003\n  - attack.t1098.003\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_account_creation:\n    EventID:\n      - 4720\n      - 4722\n  selection_service_context:\n    ServiceName:\n      - \"*Azure*\"\n      - \"*Entra*\"\n      - \"*OAuth*\"\n      - \"*AppConsent*\"\n  filter_domain_controllers:\n    SubjectUserName:\n      - \"*$\"\n      - MSOL_*\n    SubjectDomainName:\n      - NT AUTHORITY\n  filter_admin_tools:\n    ProcessName:\n      - \"*\\\\AzureADConnect.exe\"\n      - \"*\\\\Microsoft.Online.Reporting.MonitoringAgent.Startup.exe\"\n  condition: (selection_account_creation and selection_service_context) and not (filter_domain_controllers or filter_admin_tools)\nfalsepositives:\n  - Legitimate automated provisioning of cloud-sync accounts via Azure AD Connect or similar identity synchronization tools.\n  - Administrative creation of service accounts specifically designated for managing legacy OAuth application integrations.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "7f9fef59-b878-4693-969f-4c1b629a4e4a",
        "format": "sigma",
        "overallScore": 8.7,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ServiceName",
          "SubjectUserName",
          "SubjectDomainName",
          "ProcessName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_scheduled_task_creation_mimicking_security_services.yml",
      "rule": {
        "id": "90a95ae2-17a4-4ef8-956e-5deacd5ac500",
        "title": "Suspicious Scheduled Task Creation Mimicking Security Services",
        "status": "experimental",
        "description": "Detects the creation of scheduled tasks that masquerade as legitimate Windows services such as Windows Defender or Windows Update. Attackers use this technique for persistence, often pointing the task to execute binaries from suspicious locations like Temp directories.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1053.005"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_task_creation": {
            "EventID": [
              4698
            ]
          },
          "selection_suspicious_names": {
            "ProcessName": [
              "*\\schtasks.exe"
            ],
            "Status": [
              "*WindowsDefenderService*",
              "*IISUpdateService*",
              "*WindowsUpdate*",
              "*Defender*",
              "*SecurityHealth*"
            ]
          },
          "filter_legitimate_admin": {
            "SubjectUserName": [
              "SYSTEM",
              "LOCAL SERVICE",
              "NETWORK SERVICE"
            ]
          },
          "filter_domain_controllers": {
            "SubjectDomainName": [
              "NT AUTHORITY"
            ]
          },
          "condition": "selection_task_creation and selection_suspicious_names and not (filter_legitimate_admin or filter_domain_controllers)"
        },
        "falsepositives": [
          "Legitimate security software updates that create temporary scheduled tasks for installation",
          "Administrative scripts used by IT departments to force Windows Update or Defender scans across the fleet"
        ],
        "level": "high",
        "raw": "title: Suspicious Scheduled Task Creation Mimicking Security Services\nid: 90a95ae2-17a4-4ef8-956e-5deacd5ac500\nstatus: experimental\ndescription: Detects the creation of scheduled tasks that masquerade as legitimate Windows services such as Windows Defender or Windows Update. Attackers use this technique for persistence, often pointing the task to execute binaries from suspicious locations like Temp directories.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1053.005\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_task_creation:\n    EventID:\n      - 4698\n  selection_suspicious_names:\n    ProcessName:\n      - \"*\\\\schtasks.exe\"\n    Status:\n      - \"*WindowsDefenderService*\"\n      - \"*IISUpdateService*\"\n      - \"*WindowsUpdate*\"\n      - \"*Defender*\"\n      - \"*SecurityHealth*\"\n  filter_legitimate_admin:\n    SubjectUserName:\n      - SYSTEM\n      - LOCAL SERVICE\n      - NETWORK SERVICE\n  filter_domain_controllers:\n    SubjectDomainName:\n      - NT AUTHORITY\n  condition: selection_task_creation and selection_suspicious_names and not (filter_legitimate_admin or filter_domain_controllers)\nfalsepositives:\n  - Legitimate security software updates that create temporary scheduled tasks for installation\n  - Administrative scripts used by IT departments to force Windows Update or Defender scans across the fleet\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "90a95ae2-17a4-4ef8-956e-5deacd5ac500",
        "format": "sigma",
        "overallScore": 8.7,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ProcessName",
          "Status",
          "SubjectUserName",
          "SubjectDomainName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_security_log_cleared_by_user_account.yml",
      "rule": {
        "id": "050fe472-5f7a-46ef-9fbb-57782f6c0696",
        "title": "Suspicious Security Log Cleared by User Account",
        "status": "experimental",
        "description": "Detects the manual clearing of the Windows Security event log (Event ID 1102) by interactive user accounts or domain users. This behavior is commonly associated with threat actors attempting to destroy forensic evidence and obscure their operational activities during post-exploitation phases, including incidents involving compromised VPN infrastructure where attackers clear logs to hide their tracks on management hosts.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1070.002"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_log_cleared": {
            "EventID": [
              1102
            ]
          },
          "selection_user_account": {
            "SubjectUserSid": [
              "S-1-5-21-*"
            ]
          },
          "filter_system_accounts": {
            "SubjectUserSid": [
              "S-1-5-18",
              "S-1-5-19",
              "S-1-5-20"
            ]
          },
          "filter_legitimate_admins": {
            "SubjectUserName": [
              "ScheduledTaskAccount",
              "LogRotationService"
            ]
          },
          "condition": "selection_log_cleared and selection_user_account and not filter_system_accounts and not filter_legitimate_admins"
        },
        "falsepositives": [
          "Legitimate administrative maintenance activities performed by authorized system administrators clearing logs for retention policy compliance",
          "Automated security tools or backup solutions that rotate and clear event logs as part of routine system maintenance"
        ],
        "level": "high",
        "raw": "title: Suspicious Security Log Cleared by User Account\nid: 050fe472-5f7a-46ef-9fbb-57782f6c0696\nstatus: experimental\ndescription: Detects the manual clearing of the Windows Security event log (Event ID 1102) by interactive user accounts or domain users. This behavior is commonly associated with threat actors attempting to destroy forensic evidence and obscure their operational activities during post-exploitation phases, including incidents involving compromised VPN infrastructure where attackers clear logs to hide their tracks on management hosts.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1070.002\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_log_cleared:\n    EventID:\n      - 1102\n  selection_user_account:\n    SubjectUserSid:\n      - S-1-5-21-*\n  filter_system_accounts:\n    SubjectUserSid:\n      - S-1-5-18\n      - S-1-5-19\n      - S-1-5-20\n  filter_legitimate_admins:\n    SubjectUserName:\n      - ScheduledTaskAccount\n      - LogRotationService\n  condition: selection_log_cleared and selection_user_account and not filter_system_accounts and not filter_legitimate_admins\nfalsepositives:\n  - Legitimate administrative maintenance activities performed by authorized system administrators clearing logs for retention policy compliance\n  - Automated security tools or backup solutions that rotate and clear event logs as part of routine system maintenance\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "050fe472-5f7a-46ef-9fbb-57782f6c0696",
        "format": "sigma",
        "overallScore": 8.7,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "SubjectUserSid",
          "SubjectUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.6666666666666666,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/remote_access_software_network_connection_via_rmm_tools.yml",
      "rule": {
        "id": "da0db5e2-ffc7-4272-ad09-61f0f36a6295",
        "title": "Remote Access Software Network Connection via RMM Tools",
        "status": "experimental",
        "description": "Detects outbound network connections initiated by common Remote Monitoring and Management (RMM) tools like AnyDesk, Quick Assist, and ScreenConnect. Threat actors often use these legitimate tools to maintain command and control after socially engineering victims into installing them.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.command_and_control",
          "attack.t1219"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_rmm_images": {
            "Image": [
              "*\\AnyDesk.exe",
              "*\\quickassist.exe",
              "*\\ScreenConnect.Client.exe",
              "*\\SplashtopDesktop.exe",
              "*\\SRService.exe",
              "*\\RemoteSupport.exe"
            ]
          },
          "selection_network_behavior": {
            "Initiated": [
              true
            ],
            "DestinationPort": [
              80,
              443,
              6568,
              7070,
              44175
            ]
          },
          "filter_it_admin_networks": {
            "SourceIp": [
              "10.0.0.0/8",
              "172.16.0.0/12",
              "192.168.0.0/16"
            ],
            "User": [
              "*\\Admin*",
              "NT AUTHORITY\\SYSTEM"
            ]
          },
          "filter_known_hostnames": {
            "DestinationHostname": [
              "*.microsoft.com",
              "*.anydesk.com",
              "*.screenconnect.com"
            ]
          },
          "condition": "selection_rmm_images and selection_network_behavior and not (filter_it_admin_networks or filter_known_hostnames)"
        },
        "falsepositives": [
          "Legitimate use of Quick Assist by internal IT helpdesk for remote troubleshooting of end-user devices.",
          "Authorized third-party vendors using AnyDesk or ScreenConnect to provide support for specific proprietary software.",
          "Automated updates of RMM clients initiated by the system account."
        ],
        "level": "high",
        "raw": "title: Remote Access Software Network Connection via RMM Tools\nid: da0db5e2-ffc7-4272-ad09-61f0f36a6295\nstatus: experimental\ndescription: Detects outbound network connections initiated by common Remote Monitoring and Management (RMM) tools like AnyDesk, Quick Assist, and ScreenConnect. Threat actors often use these legitimate tools to maintain command and control after socially engineering victims into installing them.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.command_and_control\n  - attack.t1219\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_rmm_images:\n    Image:\n      - \"*\\\\AnyDesk.exe\"\n      - \"*\\\\quickassist.exe\"\n      - \"*\\\\ScreenConnect.Client.exe\"\n      - \"*\\\\SplashtopDesktop.exe\"\n      - \"*\\\\SRService.exe\"\n      - \"*\\\\RemoteSupport.exe\"\n  selection_network_behavior:\n    Initiated:\n      - true\n    DestinationPort:\n      - 80\n      - 443\n      - 6568\n      - 7070\n      - 44175\n  filter_it_admin_networks:\n    SourceIp:\n      - 10.0.0.0/8\n      - 172.16.0.0/12\n      - 192.168.0.0/16\n    User:\n      - \"*\\\\Admin*\"\n      - NT AUTHORITY\\SYSTEM\n  filter_known_hostnames:\n    DestinationHostname:\n      - \"*.microsoft.com\"\n      - \"*.anydesk.com\"\n      - \"*.screenconnect.com\"\n  condition: selection_rmm_images and selection_network_behavior and not (filter_it_admin_networks or filter_known_hostnames)\nfalsepositives:\n  - Legitimate use of Quick Assist by internal IT helpdesk for remote troubleshooting of end-user devices.\n  - Authorized third-party vendors using AnyDesk or ScreenConnect to provide support for specific proprietary software.\n  - Automated updates of RMM clients initiated by the system account.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "da0db5e2-ffc7-4272-ad09-61f0f36a6295",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "SourceIp",
          "User",
          "DestinationHostname"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/lateral_movement_via_remote_services_from_vpn_appliance.yml",
      "rule": {
        "id": "e8470e59-fe5e-482f-a929-2ee8da7a7df4",
        "title": "Lateral Movement via Remote Services from VPN Appliance",
        "status": "experimental",
        "description": "Detects successful network (SMB) and remote interactive (RDP) logons originating from VPN appliance management IPs, particularly targeting service or privileged accounts. This indicates lateral movement using compromised credentials following VPN appliance compromise.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.lateral_movement",
          "attack.t1021"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_lateral_protocol": {
            "EventID": [
              4624
            ],
            "LogonType": [
              3,
              10
            ]
          },
          "selection_vpn_source": {
            "IpAddress": [
              "1.1.1.1",
              "206.189.208.156",
              "75.145.243.85",
              "47.207.9.89",
              "98.160.48.170",
              "173.220.106.166",
              "73.128.178.221",
              "50.243.177.161",
              "50.213.208.89",
              "64.24.179.210",
              "75.145.224.109",
              "50.215.39.49",
              "71.127.149.194",
              "173.53.43.7"
            ]
          },
          "selection_target_account": {
            "TargetUserName": [
              "*svc*",
              "*service*",
              "*admin*",
              "*sql*",
              "*backup*"
            ]
          },
          "filter_system_accounts": {
            "TargetUserName": [
              "SYSTEM",
              "NETWORK SERVICE",
              "LOCAL SERVICE"
            ]
          },
          "condition": "selection_lateral_protocol and selection_vpn_source and selection_target_account and not filter_system_accounts"
        },
        "falsepositives": [
          "Authorized service accounts legitimately configured to authenticate via RDP or SMB from VPN management interfaces for administrative purposes",
          "Emergency administrative access from VPN appliance IPs by network operations center (NOC) staff during infrastructure maintenance windows"
        ],
        "level": "high",
        "raw": "title: Lateral Movement via Remote Services from VPN Appliance\nid: e8470e59-fe5e-482f-a929-2ee8da7a7df4\nstatus: experimental\ndescription: Detects successful network (SMB) and remote interactive (RDP) logons originating from VPN appliance management IPs, particularly targeting service or privileged accounts. This indicates lateral movement using compromised credentials following VPN appliance compromise.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.lateral_movement\n  - attack.t1021\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_lateral_protocol:\n    EventID:\n      - 4624\n    LogonType:\n      - 3\n      - 10\n  selection_vpn_source:\n    IpAddress:\n      - 1.1.1.1\n      - 206.189.208.156\n      - 75.145.243.85\n      - 47.207.9.89\n      - 98.160.48.170\n      - 173.220.106.166\n      - 73.128.178.221\n      - 50.243.177.161\n      - 50.213.208.89\n      - 64.24.179.210\n      - 75.145.224.109\n      - 50.215.39.49\n      - 71.127.149.194\n      - 173.53.43.7\n  selection_target_account:\n    TargetUserName:\n      - \"*svc*\"\n      - \"*service*\"\n      - \"*admin*\"\n      - \"*sql*\"\n      - \"*backup*\"\n  filter_system_accounts:\n    TargetUserName:\n      - SYSTEM\n      - NETWORK SERVICE\n      - LOCAL SERVICE\n  condition: selection_lateral_protocol and selection_vpn_source and selection_target_account and not filter_system_accounts\nfalsepositives:\n  - Authorized service accounts legitimately configured to authenticate via RDP or SMB from VPN management interfaces for administrative purposes\n  - Emergency administrative access from VPN appliance IPs by network operations center (NOC) staff during infrastructure maintenance windows\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "e8470e59-fe5e-482f-a929-2ee8da7a7df4",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 9,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "LogonType",
          "IpAddress",
          "TargetUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/exfiltration_to_cloud_storage_via_rclone_or_winscp.yml",
      "rule": {
        "id": "4a3941ac-a886-4732-b7b7-9514de7cb0cb",
        "title": "Exfiltration to Cloud Storage via RClone or WinSCP",
        "status": "experimental",
        "description": "Detects network connections initiated by RClone or WinSCP to common cloud storage destinations or over standard web ports. This behavior is frequently associated with data exfiltration prior to ransomware deployment, specifically using tools to sync local data to actor-controlled cloud accounts.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.exfiltration",
          "attack.t1567.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_tools": {
            "Image": [
              "*\\rclone.exe",
              "*\\winscp.exe",
              "*\\rclone-*.exe"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_destinations": {
            "DestinationHostname": [
              "*.mega.nz",
              "*.mega.co.nz",
              "*.dropboxapi.com",
              "*.s3.amazonaws.com",
              "*.googleapis.com",
              "*.backblazeb2.com",
              "*.pcloud.com"
            ],
            "DestinationPort": [
              80,
              443,
              8080
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "DestinationHostname": [
              "*.microsoft.com",
              "*.windowsupdate.com"
            ]
          },
          "filter_known_paths": {
            "Image": [
              "C:\\Program Files\\WinSCP\\WinSCP.exe",
              "C:\\Program Files (x86)\\WinSCP\\WinSCP.exe"
            ]
          },
          "condition": "selection_tools and selection_destinations and not (filter_legitimate_admin or filter_known_paths)"
        },
        "falsepositives": [
          "Legitimate use of WinSCP by system administrators for scheduled backups to cloud endpoints",
          "Authorized use of RClone for synchronizing data between corporate cloud storage environments",
          "Automated software update processes that utilize WinSCP libraries or similar binary names"
        ],
        "level": "high",
        "raw": "title: Exfiltration to Cloud Storage via RClone or WinSCP\nid: 4a3941ac-a886-4732-b7b7-9514de7cb0cb\nstatus: experimental\ndescription: Detects network connections initiated by RClone or WinSCP to common cloud storage destinations or over standard web ports. This behavior is frequently associated with data exfiltration prior to ransomware deployment, specifically using tools to sync local data to actor-controlled cloud accounts.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.exfiltration\n  - attack.t1567.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_tools:\n    Image:\n      - \"*\\\\rclone.exe\"\n      - \"*\\\\winscp.exe\"\n      - \"*\\\\rclone-*.exe\"\n    Initiated:\n      - true\n  selection_destinations:\n    DestinationHostname:\n      - \"*.mega.nz\"\n      - \"*.mega.co.nz\"\n      - \"*.dropboxapi.com\"\n      - \"*.s3.amazonaws.com\"\n      - \"*.googleapis.com\"\n      - \"*.backblazeb2.com\"\n      - \"*.pcloud.com\"\n    DestinationPort:\n      - 80\n      - 443\n      - 8080\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    DestinationHostname:\n      - \"*.microsoft.com\"\n      - \"*.windowsupdate.com\"\n  filter_known_paths:\n    Image:\n      - C:\\Program Files\\WinSCP\\WinSCP.exe\n      - C:\\Program Files (x86)\\WinSCP\\WinSCP.exe\n  condition: selection_tools and selection_destinations and not (filter_legitimate_admin or filter_known_paths)\nfalsepositives:\n  - Legitimate use of WinSCP by system administrators for scheduled backups to cloud endpoints\n  - Authorized use of RClone for synchronizing data between corporate cloud storage environments\n  - Automated software update processes that utilize WinSCP libraries or similar binary names\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "4a3941ac-a886-4732-b7b7-9514de7cb0cb",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationHostname",
          "DestinationPort",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/uac_bypass_via_com_elevation_moniker.yml",
      "rule": {
        "id": "8c524b96-8492-4b4c-8f2a-19b6ecf484ca",
        "title": "UAC Bypass via COM Elevation Moniker",
        "status": "experimental",
        "description": "Detects potential UAC bypass activity where a process is spawned with High Integrity from a Medium Integrity parent, often associated with the COM Elevation Moniker (ICMLuaUtil) used by BlackCat ransomware and other malware to escalate privileges.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.privilege_escalation",
          "attack.defense_evasion",
          "attack.t1548.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_integrity": {
            "IntegrityLevel": "High"
          },
          "selection_parent_integrity": {
            "ParentCommandLine": [
              "* -m *",
              "* -u *",
              "* --uac-bypass *"
            ],
            "CommandLine": [
              "*dllhost.exe*/Processid:{3E5FC7F9-9751-4367-B931-F30D1E5FDF6F}*",
              "*dllhost.exe*/Processid:{D2E7041B-2927-42fb-8E9F-7CE93B6D8819}*"
            ]
          },
          "selection_blackcat_specific": {
            "CommandLine": [
              "*--access-token*",
              "*--propagate*",
              "*--bypass-uac*"
            ]
          },
          "filter_legitimate_installers": {
            "Company": [
              "Microsoft Corporation",
              "Google LLC",
              "Adobe Inc."
            ],
            "Image": [
              "C:\\Windows\\System32\\*.exe",
              "C:\\Windows\\SysWOW64\\*.exe"
            ]
          },
          "filter_msiexec": {
            "ParentImage": "*\\msiexec.exe"
          },
          "condition": "(selection_integrity and (selection_parent_integrity or selection_blackcat_specific)) and not (filter_legitimate_installers or filter_msiexec)"
        },
        "falsepositives": [
          "Legitimate software installers or update agents that use COM interfaces for elevated installation tasks.",
          "Administrative tools or scripts designed to perform system maintenance requiring elevated privileges via documented COM objects."
        ],
        "level": "high",
        "raw": "title: UAC Bypass via COM Elevation Moniker\nid: 8c524b96-8492-4b4c-8f2a-19b6ecf484ca\nstatus: experimental\ndescription: Detects potential UAC bypass activity where a process is spawned with High Integrity from a Medium Integrity parent, often associated with the COM Elevation Moniker (ICMLuaUtil) used by BlackCat ransomware and other malware to escalate privileges.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.privilege_escalation\n  - attack.defense_evasion\n  - attack.t1548.002\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_integrity:\n    IntegrityLevel: High\n  selection_parent_integrity:\n    ParentCommandLine:\n      - \"* -m *\"\n      - \"* -u *\"\n      - \"* --uac-bypass *\"\n    CommandLine:\n      - \"*dllhost.exe*/Processid:{3E5FC7F9-9751-4367-B931-F30D1E5FDF6F}*\"\n      - \"*dllhost.exe*/Processid:{D2E7041B-2927-42fb-8E9F-7CE93B6D8819}*\"\n  selection_blackcat_specific:\n    CommandLine:\n      - \"*--access-token*\"\n      - \"*--propagate*\"\n      - \"*--bypass-uac*\"\n  filter_legitimate_installers:\n    Company:\n      - Microsoft Corporation\n      - Google LLC\n      - Adobe Inc.\n    Image:\n      - C:\\Windows\\System32\\*.exe\n      - C:\\Windows\\SysWOW64\\*.exe\n  filter_msiexec:\n    ParentImage: \"*\\\\msiexec.exe\"\n  condition: (selection_integrity and (selection_parent_integrity or selection_blackcat_specific)) and not (filter_legitimate_installers or filter_msiexec)\nfalsepositives:\n  - Legitimate software installers or update agents that use COM interfaces for elevated installation tasks.\n  - Administrative tools or scripts designed to perform system maintenance requiring elevated privileges via documented COM objects.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "8c524b96-8492-4b4c-8f2a-19b6ecf484ca",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "IntegrityLevel",
          "ParentCommandLine",
          "CommandLine",
          "Company",
          "Image",
          "ParentImage"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/potential_password_spraying_via_multiple_failed_logons_followed_by_success.yml",
      "rule": {
        "id": "ac7b2dff-5a7e-42fd-aefa-5edc0b45a107",
        "title": "Potential Password Spraying via Multiple Failed Logons Followed by Success",
        "status": "experimental",
        "description": "Detects a pattern of multiple failed logon attempts followed by a successful logon from the same source IP address. This behavior is characteristic of password spraying or brute force attacks where an actor attempts to gain initial access while avoiding account lockout policies.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1110.003"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_logon_failures": {
            "EventID": [
              4625
            ],
            "LogonType": [
              3,
              10
            ],
            "Status": [
              "0xC000006A",
              "0xc000006d"
            ]
          },
          "selection_logon_success": {
            "EventID": [
              4624
            ],
            "LogonType": [
              3,
              10
            ]
          },
          "filter_internal_noise": {
            "IpAddress": [
              "127.0.0.1",
              "::1"
            ],
            "TargetUserName": [
              "ANONYMOUS LOGON",
              "*$"
            ]
          },
          "filter_domain_controllers": {
            "SubjectUserName": [
              "*$"
            ],
            "ServiceName": [
              "krbtgt"
            ]
          },
          "condition": "(selection_logon_failures or selection_logon_success) | count(TargetUserName) by IpAddress > 5 and not filter_internal_noise and not filter_domain_controllers"
        },
        "falsepositives": [
          "Legacy applications or service accounts with expired credentials attempting to authenticate across multiple nodes",
          "Misconfigured vulnerability scanners or network inventory tools performing authenticated scans",
          "Users who recently changed their password but have multiple mapped network drives or applications using cached old credentials"
        ],
        "level": "high",
        "raw": "title: Potential Password Spraying via Multiple Failed Logons Followed by Success\nid: ac7b2dff-5a7e-42fd-aefa-5edc0b45a107\nstatus: experimental\ndescription: Detects a pattern of multiple failed logon attempts followed by a successful logon from the same source IP address. This behavior is characteristic of password spraying or brute force attacks where an actor attempts to gain initial access while avoiding account lockout policies.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1110.003\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_logon_failures:\n    EventID:\n      - 4625\n    LogonType:\n      - 3\n      - 10\n    Status:\n      - \"0xC000006A\"\n      - \"0xc000006d\"\n  selection_logon_success:\n    EventID:\n      - 4624\n    LogonType:\n      - 3\n      - 10\n  filter_internal_noise:\n    IpAddress:\n      - 127.0.0.1\n      - ::1\n    TargetUserName:\n      - ANONYMOUS LOGON\n      - \"*$\"\n  filter_domain_controllers:\n    SubjectUserName:\n      - \"*$\"\n    ServiceName:\n      - krbtgt\n  condition: (selection_logon_failures or selection_logon_success) | count(TargetUserName) by IpAddress > 5 and not filter_internal_noise and not filter_domain_controllers\nfalsepositives:\n  - Legacy applications or service accounts with expired credentials attempting to authenticate across multiple nodes\n  - Misconfigured vulnerability scanners or network inventory tools performing authenticated scans\n  - Users who recently changed their password but have multiple mapped network drives or applications using cached old credentials\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "ac7b2dff-5a7e-42fd-aefa-5edc0b45a107",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "LogonType",
          "Status",
          "IpAddress",
          "TargetUserName",
          "SubjectUserName",
          "ServiceName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8571428571428571,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/suspicious_outbound_connection_from_web_server_processes_via_exploitation.yml",
      "rule": {
        "id": "624c87d5-5a5c-4713-8382-7f37cd27f222",
        "title": "Suspicious Outbound Connection from Web Server Processes via Exploitation",
        "status": "experimental",
        "description": "Detects outbound network connections initiated by web server processes or scripting shells spawned by web servers following exploitation of public-facing applications. This behavior indicates potential command execution and C2 establishment following successful exploitation of vulnerabilities such as those in Ivanti Connect Secure VPN (CVE-2023-46805 and CVE-2024-21887).",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1190",
          "attack.execution",
          "attack.t1059"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_process": {
            "Image": [
              "*\\w3wp.exe",
              "*\\httpd.exe",
              "*\\nginx.exe",
              "*\\php-cgi.exe",
              "*\\cmd.exe",
              "*\\powershell.exe",
              "*\\pwsh.exe",
              "*\\python.exe",
              "*\\perl.exe",
              "*\\wscript.exe",
              "*\\cscript.exe"
            ]
          },
          "selection_outbound": {
            "Initiated": [
              true
            ]
          },
          "filter_common_ports": {
            "DestinationPort": [
              53,
              80,
              443,
              123,
              389,
              636,
              88,
              445,
              3389
            ]
          },
          "filter_internal_ips": {
            "DestinationIp": [
              "10.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "192.168.*",
              "127.*",
              "::1",
              "fe80:*"
            ]
          },
          "condition": "selection_process and selection_outbound and not filter_common_ports and not filter_internal_ips"
        },
        "falsepositives": [
          "Web servers making legitimate outbound connections to backend databases, APIs, or update servers on non-standard ports",
          "Administrative scripts executed by web servers for maintenance tasks that require external network access to specific internal hosts"
        ],
        "level": "high",
        "raw": "title: Suspicious Outbound Connection from Web Server Processes via Exploitation\nid: 624c87d5-5a5c-4713-8382-7f37cd27f222\nstatus: experimental\ndescription: Detects outbound network connections initiated by web server processes or scripting shells spawned by web servers following exploitation of public-facing applications. This behavior indicates potential command execution and C2 establishment following successful exploitation of vulnerabilities such as those in Ivanti Connect Secure VPN (CVE-2023-46805 and CVE-2024-21887).\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1190\n  - attack.execution\n  - attack.t1059\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_process:\n    Image:\n      - \"*\\\\w3wp.exe\"\n      - \"*\\\\httpd.exe\"\n      - \"*\\\\nginx.exe\"\n      - \"*\\\\php-cgi.exe\"\n      - \"*\\\\cmd.exe\"\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n      - \"*\\\\python.exe\"\n      - \"*\\\\perl.exe\"\n      - \"*\\\\wscript.exe\"\n      - \"*\\\\cscript.exe\"\n  selection_outbound:\n    Initiated:\n      - true\n  filter_common_ports:\n    DestinationPort:\n      - 53\n      - 80\n      - 443\n      - 123\n      - 389\n      - 636\n      - 88\n      - 445\n      - 3389\n  filter_internal_ips:\n    DestinationIp:\n      - 10.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 192.168.*\n      - 127.*\n      - ::1\n      - fe80:*\n  condition: selection_process and selection_outbound and not filter_common_ports and not filter_internal_ips\nfalsepositives:\n  - Web servers making legitimate outbound connections to backend databases, APIs, or update servers on non-standard ports\n  - Administrative scripts executed by web servers for maintenance tasks that require external network access to specific internal hosts\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "624c87d5-5a5c-4713-8382-7f37cd27f222",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "DestinationIp"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/sigma/potential_defense_evasion_via_log_clearing_or_service_tampering.yml",
      "rule": {
        "id": "77b00240-d8f1-4671-bf14-80beb8bfec6a",
        "title": "Potential Defense Evasion via Log Clearing or Service Tampering",
        "status": "experimental",
        "description": "Detects attempts to clear security logs or tamper with services, which aligns with observed attacker behavior on Ivanti appliances where system logging was disabled and logs were wiped to hide webshell activity and integrity checker modifications.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562.001",
          "attack.t1070.001"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_log_cleared": {
            "EventID": [
              1102,
              4719
            ]
          },
          "selection_service_tamper": {
            "EventID": [
              4697,
              4699
            ],
            "ServiceName": [
              "*EventLog*",
              "*Syslog*",
              "*Integrity*"
            ]
          },
          "selection_suspicious_ips": {
            "IpAddress": [
              "206.189.208.156",
              "75.145.243.85",
              "47.207.9.89",
              "98.160.48.170",
              "173.220.106.166",
              "73.128.178.221",
              "50.243.177.161",
              "50.213.208.89",
              "64.24.179.210",
              "75.145.224.109",
              "50.215.39.49",
              "71.127.149.194",
              "173.53.43.7"
            ]
          },
          "filter_legitimate_admins": {
            "SubjectUserName": [
              "MSOL_*",
              "HealthService",
              "SYSTEM"
            ],
            "SubjectDomainName": [
              "NT AUTHORITY"
            ]
          },
          "condition": "(selection_log_cleared or (selection_service_tamper and selection_suspicious_ips)) and not filter_legitimate_admins"
        },
        "falsepositives": [
          "Legitimate log rotation or maintenance scripts executed by domain administrators during scheduled windows.",
          "Automated security auditing tools or vulnerability scanners that temporarily modify service states for compliance testing."
        ],
        "level": "high",
        "raw": "title: Potential Defense Evasion via Log Clearing or Service Tampering\nid: 77b00240-d8f1-4671-bf14-80beb8bfec6a\nstatus: experimental\ndescription: Detects attempts to clear security logs or tamper with services, which aligns with observed attacker behavior on Ivanti appliances where system logging was disabled and logs were wiped to hide webshell activity and integrity checker modifications.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1562.001\n  - attack.t1070.001\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_log_cleared:\n    EventID:\n      - 1102\n      - 4719\n  selection_service_tamper:\n    EventID:\n      - 4697\n      - 4699\n    ServiceName:\n      - \"*EventLog*\"\n      - \"*Syslog*\"\n      - \"*Integrity*\"\n  selection_suspicious_ips:\n    IpAddress:\n      - 206.189.208.156\n      - 75.145.243.85\n      - 47.207.9.89\n      - 98.160.48.170\n      - 173.220.106.166\n      - 73.128.178.221\n      - 50.243.177.161\n      - 50.213.208.89\n      - 64.24.179.210\n      - 75.145.224.109\n      - 50.215.39.49\n      - 71.127.149.194\n      - 173.53.43.7\n  filter_legitimate_admins:\n    SubjectUserName:\n      - MSOL_*\n      - HealthService\n      - SYSTEM\n    SubjectDomainName:\n      - NT AUTHORITY\n  condition: (selection_log_cleared or (selection_service_tamper and selection_suspicious_ips)) and not filter_legitimate_admins\nfalsepositives:\n  - Legitimate log rotation or maintenance scripts executed by domain administrators during scheduled windows.\n  - Automated security auditing tools or vulnerability scanners that temporarily modify service states for compliance testing.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "77b00240-d8f1-4671-bf14-80beb8bfec6a",
        "format": "sigma",
        "overallScore": 8.6,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "ServiceName",
          "IpAddress",
          "SubjectUserName",
          "SubjectDomainName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/intersections/sigma/suspicious_network_connection_by_python_dropper_via_ingress_tool_transfer.yml",
      "rule": {
        "id": "1b153c2f-4fe5-49a3-934d-4033af8bd196",
        "title": "Suspicious Network Connection by Python Dropper via Ingress Tool Transfer",
        "status": "experimental",
        "description": "Detects network connections initiated by Python processes or scripts (like testSpeed.py or FinderTools) to suspicious external destinations. This behavior is consistent with multi-stage droppers used to fetch secondary payloads, often observed in campaigns like KANDYKORN where Python scripts download Mach-O binaries.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.command_and_control",
          "attack.t1105"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_python_process": {
            "Image": [
              "*\\python.exe",
              "*\\python3.exe",
              "*\\pythonw.exe",
              "*\\FinderTools",
              "*\\testSpeed.py"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_suspicious_dest": {
            "DestinationPort": [
              80,
              443,
              8080,
              8443
            ],
            "DestinationHostname": [
              "*tp-globa.xyz",
              "*linkpc.net",
              "*bitscrunnch*"
            ]
          },
          "filter_legitimate_python_traffic": {
            "DestinationHostname": [
              "*.pypi.org",
              "*.python.org",
              "*.github.com",
              "*.google.com",
              "*.microsoft.com",
              "*.amazonaws.com"
            ],
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ]
          },
          "condition": "selection_python_process and selection_suspicious_dest and not filter_legitimate_python_traffic"
        },
        "falsepositives": [
          "Legitimate Python-based update scripts or monitoring tools connecting to internal or well-known cloud repositories",
          "Developers using Python scripts to automate data retrieval from custom domains or non-standard web services"
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection by Python Dropper via Ingress Tool Transfer\nid: 1b153c2f-4fe5-49a3-934d-4033af8bd196\nstatus: experimental\ndescription: Detects network connections initiated by Python processes or scripts (like testSpeed.py or FinderTools) to suspicious external destinations. This behavior is consistent with multi-stage droppers used to fetch secondary payloads, often observed in campaigns like KANDYKORN where Python scripts download Mach-O binaries.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.command_and_control\n  - attack.t1105\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_python_process:\n    Image:\n      - \"*\\\\python.exe\"\n      - \"*\\\\python3.exe\"\n      - \"*\\\\pythonw.exe\"\n      - \"*\\\\FinderTools\"\n      - \"*\\\\testSpeed.py\"\n    Initiated:\n      - true\n  selection_suspicious_dest:\n    DestinationPort:\n      - 80\n      - 443\n      - 8080\n      - 8443\n    DestinationHostname:\n      - \"*tp-globa.xyz\"\n      - \"*linkpc.net\"\n      - \"*bitscrunnch*\"\n  filter_legitimate_python_traffic:\n    DestinationHostname:\n      - \"*.pypi.org\"\n      - \"*.python.org\"\n      - \"*.github.com\"\n      - \"*.google.com\"\n      - \"*.microsoft.com\"\n      - \"*.amazonaws.com\"\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n  condition: selection_python_process and selection_suspicious_dest and not filter_legitimate_python_traffic\nfalsepositives:\n  - Legitimate Python-based update scripts or monitoring tools connecting to internal or well-known cloud repositories\n  - Developers using Python scripts to automate data retrieval from custom domains or non-standard web services\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "1b153c2f-4fe5-49a3-934d-4033af8bd196",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationPort",
          "DestinationHostname",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/intersections/sigma/discord_execution_flow_hijacking_via_malicious_image_load.yml",
      "rule": {
        "id": "e724aea3-a871-4ad5-b4e5-eb4638d2b4f6",
        "title": "Discord Execution Flow Hijacking via Malicious Image Load",
        "status": "experimental",
        "description": "Detects the loading of suspicious or unsigned modules by a process masquerading as Discord, or Discord loading unusual hidden files. This behavior is consistent with HLOADER and KANDYKORN malware which renames the legitimate Discord binary to a hidden file like '.lock' and replaces it with a malicious loader.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1574.006"
        ],
        "logsource": {
          "product": "windows",
          "category": "image_load"
        },
        "detection": {
          "selection_discord_process": {
            "Image": [
              "*\\Discord.exe",
              "*\\Discord.app\\*"
            ]
          },
          "selection_suspicious_load": {
            "ImageLoaded": [
              "*\\.lock",
              "*\\.log",
              "*\\.sld",
              "*\\MacOS.tmp",
              "*\\temp.dat"
            ]
          },
          "selection_unsigned_loader": {
            "Image": [
              "*\\Discord.exe",
              "*\\Discord.app\\*"
            ],
            "Signed": [
              "false"
            ],
            "SignatureStatus": [
              "Unavailable",
              "Invalid"
            ]
          },
          "filter_legitimate_discord": {
            "Company": [
              "Discord Inc."
            ],
            "Signed": [
              "true"
            ],
            "SignatureStatus": [
              "Valid"
            ]
          },
          "condition": "(selection_discord_process and selection_suspicious_load) or (selection_unsigned_loader and not filter_legitimate_discord)"
        },
        "falsepositives": [
          "Legitimate Discord updates where the temporary installer has not yet been fully verified by the OS",
          "Security software or monitoring tools injecting modules into the Discord process space",
          "Developer environments where Discord components are being modified or debugged locally"
        ],
        "level": "high",
        "raw": "title: Discord Execution Flow Hijacking via Malicious Image Load\nid: e724aea3-a871-4ad5-b4e5-eb4638d2b4f6\nstatus: experimental\ndescription: Detects the loading of suspicious or unsigned modules by a process masquerading as Discord, or Discord loading unusual hidden files. This behavior is consistent with HLOADER and KANDYKORN malware which renames the legitimate Discord binary to a hidden file like '.lock' and replaces it with a malicious loader.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1574.006\nlogsource:\n  product: windows\n  category: image_load\ndetection:\n  selection_discord_process:\n    Image:\n      - \"*\\\\Discord.exe\"\n      - \"*\\\\Discord.app\\\\*\"\n  selection_suspicious_load:\n    ImageLoaded:\n      - \"*\\\\.lock\"\n      - \"*\\\\.log\"\n      - \"*\\\\.sld\"\n      - \"*\\\\MacOS.tmp\"\n      - \"*\\\\temp.dat\"\n  selection_unsigned_loader:\n    Image:\n      - \"*\\\\Discord.exe\"\n      - \"*\\\\Discord.app\\\\*\"\n    Signed:\n      - \"false\"\n    SignatureStatus:\n      - Unavailable\n      - Invalid\n  filter_legitimate_discord:\n    Company:\n      - Discord Inc.\n    Signed:\n      - \"true\"\n    SignatureStatus:\n      - Valid\n  condition: (selection_discord_process and selection_suspicious_load) or (selection_unsigned_loader and not filter_legitimate_discord)\nfalsepositives:\n  - Legitimate Discord updates where the temporary installer has not yet been fully verified by the OS\n  - Security software or monitoring tools injecting modules into the Discord process space\n  - Developer environments where Discord components are being modified or debugged locally\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "e724aea3-a871-4ad5-b4e5-eb4638d2b4f6",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "ImageLoaded",
          "Signed",
          "SignatureStatus",
          "Company"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/intersections/sigma/suspicious_network_connection_from_python_ide_process.yml",
      "rule": {
        "id": "79584b06-e2c9-46e7-b1ca-38f26f5e4c6e",
        "title": "Suspicious Network Connection from Python IDE Process",
        "status": "experimental",
        "description": "Detects Python interpreters or IDE-related processes (like PyCharm) initiating outbound network connections to external hosting services or suspicious domains. This behavior is consistent with multi-stage malware infections where a victim is social-engineered into running a malicious script (e.g., an arbitrage bot) that fetches secondary payloads.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1566.003",
          "attack.command_and_control",
          "attack.t1105"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_ide_python": {
            "Image": [
              "*\\python.exe",
              "*\\pythonw.exe",
              "*\\pycharm64.exe",
              "*\\pycharm.exe",
              "*\\jetbrains\\*"
            ],
            "Initiated": [
              true
            ]
          },
          "selection_suspicious_destinations": {
            "DestinationHostname": [
              "*drive.google.com",
              "*tp-globa.xyz",
              "*linkpc.net",
              "*discord.app",
              "*discord.com"
            ]
          },
          "filter_internal": {
            "DestinationIp": [
              "10.*",
              "192.168.*",
              "172.16.*",
              "172.17.*",
              "172.18.*",
              "172.19.*",
              "172.20.*",
              "172.21.*",
              "172.22.*",
              "172.23.*",
              "172.24.*",
              "172.25.*",
              "172.26.*",
              "172.27.*",
              "172.28.*",
              "172.29.*",
              "172.30.*",
              "172.31.*",
              "127.*"
            ]
          },
          "filter_updates": {
            "DestinationHostname": [
              "*jetbrains.com",
              "*python.org",
              "*pypi.org",
              "*github.com"
            ]
          },
          "condition": "selection_ide_python and selection_suspicious_destinations and not (filter_internal or filter_updates)"
        },
        "falsepositives": [
          "Developers using Python scripts to automate data downloads from Google Drive for legitimate projects.",
          "IDE plugins checking for updates or telemetry from non-standard developer-related domains.",
          "Legitimate use of Discord webhooks by custom Python notification scripts."
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection from Python IDE Process\nid: 79584b06-e2c9-46e7-b1ca-38f26f5e4c6e\nstatus: experimental\ndescription: Detects Python interpreters or IDE-related processes (like PyCharm) initiating outbound network connections to external hosting services or suspicious domains. This behavior is consistent with multi-stage malware infections where a victim is social-engineered into running a malicious script (e.g., an arbitrage bot) that fetches secondary payloads.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1566.003\n  - attack.command_and_control\n  - attack.t1105\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_ide_python:\n    Image:\n      - \"*\\\\python.exe\"\n      - \"*\\\\pythonw.exe\"\n      - \"*\\\\pycharm64.exe\"\n      - \"*\\\\pycharm.exe\"\n      - \"*\\\\jetbrains\\\\*\"\n    Initiated:\n      - true\n  selection_suspicious_destinations:\n    DestinationHostname:\n      - \"*drive.google.com\"\n      - \"*tp-globa.xyz\"\n      - \"*linkpc.net\"\n      - \"*discord.app\"\n      - \"*discord.com\"\n  filter_internal:\n    DestinationIp:\n      - 10.*\n      - 192.168.*\n      - 172.16.*\n      - 172.17.*\n      - 172.18.*\n      - 172.19.*\n      - 172.20.*\n      - 172.21.*\n      - 172.22.*\n      - 172.23.*\n      - 172.24.*\n      - 172.25.*\n      - 172.26.*\n      - 172.27.*\n      - 172.28.*\n      - 172.29.*\n      - 172.30.*\n      - 172.31.*\n      - 127.*\n  filter_updates:\n    DestinationHostname:\n      - \"*jetbrains.com\"\n      - \"*python.org\"\n      - \"*pypi.org\"\n      - \"*github.com\"\n  condition: selection_ide_python and selection_suspicious_destinations and not (filter_internal or filter_updates)\nfalsepositives:\n  - Developers using Python scripts to automate data downloads from Google Drive for legitimate projects.\n  - IDE plugins checking for updates or telemetry from non-standard developer-related domains.\n  - Legitimate use of Discord webhooks by custom Python notification scripts.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "79584b06-e2c9-46e7-b1ca-38f26f5e4c6e",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Initiated",
          "DestinationHostname",
          "DestinationIp"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/intersections/sigma/reflective_code_loading_via_nscreateobjectfileimagefrommemory_pattern.yml",
      "rule": {
        "id": "798b8c2d-93c3-4ee6-96bd-ec53d8d5678d",
        "title": "Reflective Code Loading via NSCreateObjectFileImageFromMemory Pattern",
        "status": "experimental",
        "description": "Detects the execution of processes that exhibit patterns associated with reflective Mach-O loading, specifically targeting the use of NSCreateObjectFileImageFromMemory-related artifacts or command-line indicators often seen in SUGARLOADER and KANDYKORN payloads. This technique allows execution of binaries directly in memory to evade disk-based security scanners.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1620"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_reflective_indicators": {
            "CommandLine": [
              "*NSCreateObjectFileImageFromMemory*",
              "*NSLinkModule*",
              "*cffaedfe*"
            ]
          },
          "selection_suspicious_paths": {
            "CurrentDirectory": [
              "*\\tmp\\*",
              "*\\var\\tmp\\*",
              "*\\Users\\Public\\*"
            ],
            "CommandLine": [
              "*/tmp/*",
              "*/var/tmp/*"
            ]
          },
          "filter_legitimate_apps": {
            "Company": [
              "Apple Inc.",
              "Microsoft Corporation",
              "Google LLC"
            ],
            "Image": [
              "*\\Xcode.app\\*",
              "*\\Visual Studio\\*"
            ]
          },
          "filter_system_procs": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "IntegrityLevel": [
              "System"
            ]
          },
          "condition": "(selection_reflective_indicators or selection_suspicious_paths) and not (filter_legitimate_apps or filter_system_procs)"
        },
        "falsepositives": [
          "Legitimate developer tools or debuggers (like Xcode or LLDB) that manipulate object files in memory during compilation or debugging sessions.",
          "Security software or endpoint agents that perform memory scanning or self-integrity checks using similar API patterns."
        ],
        "level": "high",
        "raw": "title: Reflective Code Loading via NSCreateObjectFileImageFromMemory Pattern\nid: 798b8c2d-93c3-4ee6-96bd-ec53d8d5678d\nstatus: experimental\ndescription: Detects the execution of processes that exhibit patterns associated with reflective Mach-O loading, specifically targeting the use of NSCreateObjectFileImageFromMemory-related artifacts or command-line indicators often seen in SUGARLOADER and KANDYKORN payloads. This technique allows execution of binaries directly in memory to evade disk-based security scanners.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1620\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_reflective_indicators:\n    CommandLine:\n      - \"*NSCreateObjectFileImageFromMemory*\"\n      - \"*NSLinkModule*\"\n      - \"*cffaedfe*\"\n  selection_suspicious_paths:\n    CurrentDirectory:\n      - \"*\\\\tmp\\\\*\"\n      - \"*\\\\var\\\\tmp\\\\*\"\n      - \"*\\\\Users\\\\Public\\\\*\"\n    CommandLine:\n      - \"*/tmp/*\"\n      - \"*/var/tmp/*\"\n  filter_legitimate_apps:\n    Company:\n      - Apple Inc.\n      - Microsoft Corporation\n      - Google LLC\n    Image:\n      - \"*\\\\Xcode.app\\\\*\"\n      - \"*\\\\Visual Studio\\\\*\"\n  filter_system_procs:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    IntegrityLevel:\n      - System\n  condition: (selection_reflective_indicators or selection_suspicious_paths) and not (filter_legitimate_apps or filter_system_procs)\nfalsepositives:\n  - Legitimate developer tools or debuggers (like Xcode or LLDB) that manipulate object files in memory during compilation or debugging sessions.\n  - Security software or endpoint agents that perform memory scanning or self-integrity checks using similar API patterns.\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "798b8c2d-93c3-4ee6-96bd-ec53d8d5678d",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "CommandLine",
          "CurrentDirectory",
          "Company",
          "Image",
          "User",
          "IntegrityLevel"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/svr-cyber/sigma/suspicious_microsoft_graph_or_azure_cli_token_acquisition_via_command_line.yml",
      "rule": {
        "id": "b6d124fa-e33e-4216-9748-4fe1afc2790e",
        "title": "Suspicious Microsoft Graph or Azure CLI Token Acquisition via Command Line",
        "status": "experimental",
        "description": "Detects the use of command-line tools to acquire or use OAuth access tokens for cloud services, which can be a precursor to token theft or replay attacks as seen in SVR actor TTPs. Attackers often use CLI tools to export tokens or authenticate using stolen secrets to access sensitive cloud data like emails and files.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1550.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_cli_tools": {
            "Image": [
              "*\\az.exe",
              "*\\microsoft-graph-cli*",
              "*\\mgc.exe"
            ],
            "CommandLine": [
              "*account get-access-token*",
              "*login --service-principal*",
              "*auth login*",
              "*--client-secret*",
              "*--client-id*"
            ]
          },
          "selection_powershell_graph": {
            "CommandLine": [
              "*Get-MgContext*",
              "*Connect-MgGraph*",
              "*Get-AzAccessToken*",
              "*-Scopes *Mail.Read*",
              "*-Scopes *Files.Read*",
              "*-Scopes *Directory.Read.All*"
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ]
          },
          "condition": "(selection_cli_tools or selection_powershell_graph) and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Legitimate cloud administrators using Azure CLI or Microsoft Graph PowerShell for automation",
          "Managed Service Provider (MSP) scripts for tenant management",
          "DevOps CI/CD pipelines running on local runners"
        ],
        "level": "high",
        "raw": "title: Suspicious Microsoft Graph or Azure CLI Token Acquisition via Command Line\nid: b6d124fa-e33e-4216-9748-4fe1afc2790e\nstatus: experimental\ndescription: Detects the use of command-line tools to acquire or use OAuth access tokens for cloud services, which can be a precursor to token theft or replay attacks as seen in SVR actor TTPs. Attackers often use CLI tools to export tokens or authenticate using stolen secrets to access sensitive cloud data like emails and files.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1550.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_cli_tools:\n    Image:\n      - \"*\\\\az.exe\"\n      - \"*\\\\microsoft-graph-cli*\"\n      - \"*\\\\mgc.exe\"\n    CommandLine:\n      - \"*account get-access-token*\"\n      - \"*login --service-principal*\"\n      - \"*auth login*\"\n      - \"*--client-secret*\"\n      - \"*--client-id*\"\n  selection_powershell_graph:\n    CommandLine:\n      - \"*Get-MgContext*\"\n      - \"*Connect-MgGraph*\"\n      - \"*Get-AzAccessToken*\"\n      - \"*-Scopes *Mail.Read*\"\n      - \"*-Scopes *Files.Read*\"\n      - \"*-Scopes *Directory.Read.All*\"\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n  condition: (selection_cli_tools or selection_powershell_graph) and not filter_legitimate_admin\nfalsepositives:\n  - Legitimate cloud administrators using Azure CLI or Microsoft Graph PowerShell for automation\n  - Managed Service Provider (MSP) scripts for tenant management\n  - DevOps CI/CD pipelines running on local runners\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "b6d124fa-e33e-4216-9748-4fe1afc2790e",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/svr-cyber/sigma/potential_password_spraying_attack_via_windows_security_event_logs.yml",
      "rule": {
        "id": "dc579214-71d3-4d7d-b14f-7ed2d77aa9fc",
        "title": "Potential Password Spraying Attack via Windows Security Event Logs",
        "status": "experimental",
        "description": "Detects a high volume of failed logon attempts (Event ID 4625) across multiple unique target usernames from a single source IP address. This behavior is characteristic of password spraying, where an attacker tests a common password against many accounts to gain initial access.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.initial_access",
          "attack.t1110.003"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_failed_logon": {
            "EventID": [
              4625
            ],
            "LogonType": [
              3,
              8,
              10
            ],
            "Status": [
              "0xC000006A",
              "0xc000006a"
            ]
          },
          "filter_local_system": {
            "TargetUserName": [
              "SYSTEM",
              "*$*",
              "ANONYMOUS LOGON"
            ]
          },
          "condition": "selection_failed_logon and not filter_local_system | count(TargetUserName) by IpAddress > 15"
        },
        "falsepositives": [
          "Misconfigured applications or services attempting to authenticate with expired credentials across a fleet",
          "Security scanning tools performing authorized vulnerability assessments",
          "Internal servers or proxies that aggregate authentication traffic from multiple users"
        ],
        "level": "high",
        "raw": "title: Potential Password Spraying Attack via Windows Security Event Logs\nid: dc579214-71d3-4d7d-b14f-7ed2d77aa9fc\nstatus: experimental\ndescription: Detects a high volume of failed logon attempts (Event ID 4625) across multiple unique target usernames from a single source IP address. This behavior is characteristic of password spraying, where an attacker tests a common password against many accounts to gain initial access.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.initial_access\n  - attack.t1110.003\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_failed_logon:\n    EventID:\n      - 4625\n    LogonType:\n      - 3\n      - 8\n      - 10\n    Status:\n      - \"0xC000006A\"\n      - \"0xc000006a\"\n  filter_local_system:\n    TargetUserName:\n      - SYSTEM\n      - \"*$*\"\n      - ANONYMOUS LOGON\n  condition: selection_failed_logon and not filter_local_system | count(TargetUserName) by IpAddress > 15\nfalsepositives:\n  - Misconfigured applications or services attempting to authenticate with expired credentials across a fleet\n  - Security scanning tools performing authorized vulnerability assessments\n  - Internal servers or proxies that aggregate authentication traffic from multiple users\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "dc579214-71d3-4d7d-b14f-7ed2d77aa9fc",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "LogonType",
          "Status",
          "TargetUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/svr-cyber/sigma/suspicious_network_connection_to_known_residential_proxy_services.yml",
      "rule": {
        "id": "138226a4-bb87-4158-85c7-56b2712702fd",
        "title": "Suspicious Network Connection to Known Residential Proxy Services",
        "status": "experimental",
        "description": "Detects network connections to known residential proxy provider infrastructure. Attackers use these services to route malicious traffic through residential IP space to evade IP-based reputation filtering and geolocation-based conditional access policies.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.command_and_control",
          "attack.t1090.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_proxy_destinations": {
            "DestinationHostname": [
              "*brightdata.com",
              "*luminati.io",
              "*oxylabs.io",
              "*smartproxy.com",
              "*soax.com",
              "*infatica.io",
              "*netnut.io",
              "*geosurf.io",
              "*packetstream.io",
              "*microleaves.com",
              "*shifter.io"
            ]
          },
          "selection_proxy_ports": {
            "DestinationPort": [
              8888,
              9999,
              10000,
              10001,
              12321,
              20000,
              3128,
              8080
            ]
          },
          "filter_legitimate_browsers": {
            "Image": [
              "*\\chrome.exe",
              "*\\msedge.exe",
              "*\\firefox.exe"
            ],
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ]
          },
          "condition": "(selection_proxy_destinations or selection_proxy_ports) and not filter_legitimate_browsers"
        },
        "falsepositives": [
          "Marketing departments using residential proxies for localized SEO or ad verification",
          "Developers testing geolocation-aware applications",
          "Legitimate use of corporate web proxies that happen to use similar port numbers"
        ],
        "level": "high",
        "raw": "title: Suspicious Network Connection to Known Residential Proxy Services\nid: 138226a4-bb87-4158-85c7-56b2712702fd\nstatus: experimental\ndescription: Detects network connections to known residential proxy provider infrastructure. Attackers use these services to route malicious traffic through residential IP space to evade IP-based reputation filtering and geolocation-based conditional access policies.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.command_and_control\n  - attack.t1090.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_proxy_destinations:\n    DestinationHostname:\n      - \"*brightdata.com\"\n      - \"*luminati.io\"\n      - \"*oxylabs.io\"\n      - \"*smartproxy.com\"\n      - \"*soax.com\"\n      - \"*infatica.io\"\n      - \"*netnut.io\"\n      - \"*geosurf.io\"\n      - \"*packetstream.io\"\n      - \"*microleaves.com\"\n      - \"*shifter.io\"\n  selection_proxy_ports:\n    DestinationPort:\n      - 8888\n      - 9999\n      - 10000\n      - 10001\n      - 12321\n      - 20000\n      - 3128\n      - 8080\n  filter_legitimate_browsers:\n    Image:\n      - \"*\\\\chrome.exe\"\n      - \"*\\\\msedge.exe\"\n      - \"*\\\\firefox.exe\"\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n  condition: (selection_proxy_destinations or selection_proxy_ports) and not filter_legitimate_browsers\nfalsepositives:\n  - Marketing departments using residential proxies for localized SEO or ad verification\n  - Developers testing geolocation-aware applications\n  - Legitimate use of corporate web proxies that happen to use similar port numbers\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "138226a4-bb87-4158-85c7-56b2712702fd",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "DestinationHostname",
          "DestinationPort",
          "Image",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/svr-cyber/sigma/potential_mfa_fatigue_attack_via_repeated_logon_failures.yml",
      "rule": {
        "id": "2677e05c-72ce-4d2e-bc77-5a37abdb8452",
        "title": "Potential MFA Fatigue Attack via Repeated Logon Failures",
        "status": "experimental",
        "description": "Detects potential MFA bombing or fatigue attacks where a high volume of logon failures or challenges occur for a single user account within a short period. This behavior is characteristic of attackers attempting to exhaust a user into approving a push notification.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1621"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_mfa_events": {
            "EventID": [
              4625,
              4648
            ],
            "Status": [
              "0xC000006A",
              "0xC000006D"
            ]
          },
          "filter_machine_accounts": {
            "TargetUserName": [
              "*$"
            ]
          },
          "condition": "selection_mfa_events and not filter_machine_accounts | count(EventID) by TargetUserName > 5"
        },
        "falsepositives": [
          "Users who have forgotten their passwords and are repeatedly attempting to log in",
          "Misconfigured applications or service accounts with expired credentials",
          "Legacy applications that do not support modern authentication and trigger repeated prompts"
        ],
        "level": "high",
        "raw": "title: Potential MFA Fatigue Attack via Repeated Logon Failures\nid: 2677e05c-72ce-4d2e-bc77-5a37abdb8452\nstatus: experimental\ndescription: Detects potential MFA bombing or fatigue attacks where a high volume of logon failures or challenges occur for a single user account within a short period. This behavior is characteristic of attackers attempting to exhaust a user into approving a push notification.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1621\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_mfa_events:\n    EventID:\n      - 4625\n      - 4648\n    Status:\n      - \"0xC000006A\"\n      - \"0xC000006D\"\n  filter_machine_accounts:\n    TargetUserName:\n      - \"*$\"\n  condition: selection_mfa_events and not filter_machine_accounts | count(EventID) by TargetUserName > 5\nfalsepositives:\n  - Users who have forgotten their passwords and are repeatedly attempting to log in\n  - Misconfigured applications or service accounts with expired credentials\n  - Legacy applications that do not support modern authentication and trigger repeated prompts\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "2677e05c-72ce-4d2e-bc77-5a37abdb8452",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Status",
          "TargetUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.6666666666666666,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/svr-cyber/sigma/unauthorized_device_registration_via_windows_security_events.yml",
      "rule": {
        "id": "9991dd14-2a7f-48d6-9f05-f8b3f4975efb",
        "title": "Unauthorized Device Registration via Windows Security Events",
        "status": "experimental",
        "description": "Detects potential unauthorized device registration activity by monitoring for specific service-related events and logon patterns associated with device enrollment. Attackers register unauthorized devices to bypass conditional access policies and maintain persistence within a tenant.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1098.005"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_device_registration": {
            "EventID": [
              4768,
              4769
            ],
            "ServiceName": [
              "Microsoft Device Registration Service",
              "Device Registration Service",
              "Enterprise Registration Service"
            ]
          },
          "selection_privileged_accounts": {
            "TargetUserName": [
              "admin*",
              "svc*",
              "*-admin",
              "*-svc"
            ]
          },
          "filter_local_system": {
            "SubjectUserName": [
              "SYSTEM",
              "NETWORK SERVICE",
              "LOCAL SERVICE"
            ]
          },
          "condition": "selection_device_registration and selection_privileged_accounts and not filter_local_system"
        },
        "falsepositives": [
          "Legitimate hardware refreshes where administrators register new corporate devices",
          "Automated deployment of virtual desktops or containers using service accounts",
          "Initial setup of new administrative workstations"
        ],
        "level": "high",
        "raw": "title: Unauthorized Device Registration via Windows Security Events\nid: 9991dd14-2a7f-48d6-9f05-f8b3f4975efb\nstatus: experimental\ndescription: Detects potential unauthorized device registration activity by monitoring for specific service-related events and logon patterns associated with device enrollment. Attackers register unauthorized devices to bypass conditional access policies and maintain persistence within a tenant.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1098.005\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_device_registration:\n    EventID:\n      - 4768\n      - 4769\n    ServiceName:\n      - Microsoft Device Registration Service\n      - Device Registration Service\n      - Enterprise Registration Service\n  selection_privileged_accounts:\n    TargetUserName:\n      - admin*\n      - svc*\n      - \"*-admin\"\n      - \"*-svc\"\n  filter_local_system:\n    SubjectUserName:\n      - SYSTEM\n      - NETWORK SERVICE\n      - LOCAL SERVICE\n  condition: selection_device_registration and selection_privileged_accounts and not filter_local_system\nfalsepositives:\n  - Legitimate hardware refreshes where administrators register new corporate devices\n  - Automated deployment of virtual desktops or containers using service accounts\n  - Initial setup of new administrative workstations\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "9991dd14-2a7f-48d6-9f05-f8b3f4975efb",
        "format": "sigma",
        "overallScore": 8.3,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 8,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "ServiceName",
          "TargetUserName",
          "SubjectUserName"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.75,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/potential_kerberoasting_activity_via_weak_encryption_type.yml",
      "rule": {
        "id": "2c2363e6-7365-4dc4-b1c6-0bc0899ca776",
        "title": "Potential Kerberoasting Activity via Weak Encryption Type",
        "status": "experimental",
        "description": "Detects Kerberos service ticket requests (Event ID 4769) using RC4 encryption (0x17). This is a common indicator of Kerberoasting attacks where threat actors request tickets for service accounts to crack the hashes offline, as seen in campaigns involving custom stealers and keyloggers.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.credential_access",
          "attack.t1558.003"
        ],
        "logsource": {
          "product": "windows",
          "service": "security"
        },
        "detection": {
          "selection_kerberoast": {
            "EventID": 4769,
            "TicketEncryptionType": "0x17",
            "Status": "0x0"
          },
          "filter_machine_accounts": {
            "TargetUserName": "*$"
          },
          "filter_domain_controllers": {
            "IpAddress": [
              "::1",
              "127.0.0.1"
            ]
          },
          "condition": "selection_kerberoast and not (filter_machine_accounts or filter_domain_controllers)"
        },
        "falsepositives": [
          "Legacy applications that do not support AES encryption for Kerberos",
          "Environment configurations where DES or RC4 is still explicitly required for specific service principal names (SPNs)",
          "Older Windows operating systems (e.g., Windows Server 2003) still present in the environment"
        ],
        "level": "high",
        "raw": "title: Potential Kerberoasting Activity via Weak Encryption Type\nid: 2c2363e6-7365-4dc4-b1c6-0bc0899ca776\nstatus: experimental\ndescription: Detects Kerberos service ticket requests (Event ID 4769) using RC4 encryption (0x17). This is a common indicator of Kerberoasting attacks where threat actors request tickets for service accounts to crack the hashes offline, as seen in campaigns involving custom stealers and keyloggers.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.credential_access\n  - attack.t1558.003\nlogsource:\n  product: windows\n  service: security\ndetection:\n  selection_kerberoast:\n    EventID: 4769\n    TicketEncryptionType: \"0x17\"\n    Status: \"0x0\"\n  filter_machine_accounts:\n    TargetUserName: \"*$\"\n  filter_domain_controllers:\n    IpAddress:\n      - ::1\n      - 127.0.0.1\n  condition: selection_kerberoast and not (filter_machine_accounts or filter_domain_controllers)\nfalsepositives:\n  - Legacy applications that do not support AES encryption for Kerberos\n  - Environment configurations where DES or RC4 is still explicitly required for specific service principal names (SPNs)\n  - Older Windows operating systems (e.g., Windows Server 2003) still present in the environment\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": [
          "Detection field \"EventID\" is not known for logsource product=\"windows\", category=\"\""
        ]
      },
      "qualityScore": {
        "ruleId": "2c2363e6-7365-4dc4-b1c6-0bc0899ca776",
        "format": "sigma",
        "overallScore": 9,
        "dimensions": {
          "syntaxValidity": 9,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "TicketEncryptionType",
          "Status",
          "TargetUserName",
          "IpAddress"
        ],
        "invalidFields": [
          "EventID"
        ],
        "fieldValidityRate": 0.8,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/masquerading_as_legitimate_software_via_interlock_ransomware_patterns.yml",
      "rule": {
        "id": "9801d2a0-cc62-411d-96ea-fcf632139547",
        "title": "Masquerading as Legitimate Software via Interlock Ransomware Patterns",
        "status": "experimental",
        "description": "Detects the execution of processes masquerading as legitimate software such as conhost.exe, FortiClient, or GlobalProtect, which is a technique observed in Interlock Ransomware campaigns. Specifically, it identifies conhost.exe running from non-standard paths and other enterprise software names that lack expected company metadata or are executed from suspicious locations.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1036.005"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_conhost_misplaced": {
            "Image": [
              "*\\conhost.exe"
            ]
          },
          "filter_conhost_legit": {
            "Image": [
              "C:\\Windows\\System32\\conhost.exe",
              "C:\\Windows\\SysWOW64\\conhost.exe"
            ]
          },
          "selection_masquerading_names": {
            "Image": [
              "*\\FortiClient.exe",
              "*\\GlobalProtect.exe",
              "*\\Webex.exe",
              "*\\CiscoCollabHost.exe"
            ]
          },
          "filter_legit_metadata": {
            "Company": [
              "Fortinet*",
              "Palo Alto Networks*",
              "Cisco Systems*",
              "Microsoft Corporation"
            ]
          },
          "selection_hashes": {
            "Hashes": [
              "*IMPHASH=e86bb8361c436be94b0901e5b39db9b6666134f23cce1e5581421c2981405cb1*",
              "*SHA256=e86bb8361c436be94b0901e5b39db9b6666134f23cce1e5581421c2981405cb1*",
              "*SHA256=c733d85f445004c9d6918f7c09a1e0d38a8f3b37ad825cd544b865dba36a1ba6*",
              "*SHA256=c20baba26ebb596de14b403b9f78ddc3c13ce9870eea332476ac2c1dd582aa07*",
              "*SHA256=a4f0b68052e8da9a80b70407a92400c6a5def19717e0240ac608612476e1137e*",
              "*SHA256=1845a910dcde8c6e45ad2e0c48439e5ab8bbbeb731f2af11a1b7bbab3bfe0127*"
            ]
          },
          "condition": "(selection_conhost_misplaced and not filter_conhost_legit) or (selection_masquerading_names and not filter_legit_metadata) or selection_hashes"
        },
        "falsepositives": [
          "Legitimate portable versions of enterprise software executed from non-standard directories",
          "Security software updates that temporarily place binaries in staging folders",
          "Administrative tools or scripts that use conhost.exe in custom environments (rare)"
        ],
        "level": "high",
        "raw": "title: Masquerading as Legitimate Software via Interlock Ransomware Patterns\nid: 9801d2a0-cc62-411d-96ea-fcf632139547\nstatus: experimental\ndescription: Detects the execution of processes masquerading as legitimate software such as conhost.exe, FortiClient, or GlobalProtect, which is a technique observed in Interlock Ransomware campaigns. Specifically, it identifies conhost.exe running from non-standard paths and other enterprise software names that lack expected company metadata or are executed from suspicious locations.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1036.005\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_conhost_misplaced:\n    Image:\n      - \"*\\\\conhost.exe\"\n  filter_conhost_legit:\n    Image:\n      - C:\\Windows\\System32\\conhost.exe\n      - C:\\Windows\\SysWOW64\\conhost.exe\n  selection_masquerading_names:\n    Image:\n      - \"*\\\\FortiClient.exe\"\n      - \"*\\\\GlobalProtect.exe\"\n      - \"*\\\\Webex.exe\"\n      - \"*\\\\CiscoCollabHost.exe\"\n  filter_legit_metadata:\n    Company:\n      - Fortinet*\n      - Palo Alto Networks*\n      - Cisco Systems*\n      - Microsoft Corporation\n  selection_hashes:\n    Hashes:\n      - \"*IMPHASH=e86bb8361c436be94b0901e5b39db9b6666134f23cce1e5581421c2981405cb1*\"\n      - \"*SHA256=e86bb8361c436be94b0901e5b39db9b6666134f23cce1e5581421c2981405cb1*\"\n      - \"*SHA256=c733d85f445004c9d6918f7c09a1e0d38a8f3b37ad825cd544b865dba36a1ba6*\"\n      - \"*SHA256=c20baba26ebb596de14b403b9f78ddc3c13ce9870eea332476ac2c1dd582aa07*\"\n      - \"*SHA256=a4f0b68052e8da9a80b70407a92400c6a5def19717e0240ac608612476e1137e*\"\n      - \"*SHA256=1845a910dcde8c6e45ad2e0c48439e5ab8bbbeb731f2af11a1b7bbab3bfe0127*\"\n  condition: (selection_conhost_misplaced and not filter_conhost_legit) or (selection_masquerading_names and not filter_legit_metadata) or selection_hashes\nfalsepositives:\n  - Legitimate portable versions of enterprise software executed from non-standard directories\n  - Security software updates that temporarily place binaries in staging folders\n  - Administrative tools or scripts that use conhost.exe in custom environments (rare)\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "9801d2a0-cc62-411d-96ea-fcf632139547",
        "format": "sigma",
        "overallScore": 9.3,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 9
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "Company",
          "Hashes"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/indicator_removal_via_cleanup_dll_file_deletion.yml",
      "rule": {
        "id": "9ab9c379-3dcc-442c-bd46-f31a3bcd4c4e",
        "title": "Indicator Removal via Cleanup DLL File Deletion",
        "status": "experimental",
        "description": "Detects the deletion of files, specifically targeting the removal of ransomware encryption binaries or forensic artifacts by a cleanup DLL (e.g., tmp41.wasd) typically executed via rundll32.exe. This behavior is associated with defense evasion and indicator removal after an encryption process.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.defense_evasion",
          "attack.t1070.004"
        ],
        "logsource": {
          "product": "windows",
          "category": "file_event"
        },
        "detection": {
          "selection_cleanup_process": {
            "Image": [
              "*\\rundll32.exe"
            ]
          },
          "selection_suspicious_extensions": {
            "TargetFilename": [
              "*.wasd",
              "*.tmp",
              "*\\tmp41.wasd"
            ]
          },
          "selection_common_locations": {
            "TargetFilename": [
              "C:\\Users\\Public\\*",
              "C:\\Windows\\Temp\\*",
              "C:\\Users\\*\\AppData\\Local\\Temp\\*"
            ]
          },
          "filter_legitimate_rundll32": {
            "TargetFilename": [
              "*.dll",
              "*.cpl",
              "*.inf"
            ]
          },
          "condition": "selection_cleanup_process and (selection_suspicious_extensions or selection_common_locations) and not filter_legitimate_rundll32"
        },
        "falsepositives": [
          "Legitimate software installers using rundll32 to clean up temporary installation files",
          "Administrative scripts performing automated maintenance in temp directories",
          "Antivirus or security software performing file operations"
        ],
        "level": "high",
        "raw": "title: Indicator Removal via Cleanup DLL File Deletion\nid: 9ab9c379-3dcc-442c-bd46-f31a3bcd4c4e\nstatus: experimental\ndescription: Detects the deletion of files, specifically targeting the removal of ransomware encryption binaries or forensic artifacts by a cleanup DLL (e.g., tmp41.wasd) typically executed via rundll32.exe. This behavior is associated with defense evasion and indicator removal after an encryption process.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.defense_evasion\n  - attack.t1070.004\nlogsource:\n  product: windows\n  category: file_event\ndetection:\n  selection_cleanup_process:\n    Image:\n      - \"*\\\\rundll32.exe\"\n  selection_suspicious_extensions:\n    TargetFilename:\n      - \"*.wasd\"\n      - \"*.tmp\"\n      - \"*\\\\tmp41.wasd\"\n  selection_common_locations:\n    TargetFilename:\n      - C:\\Users\\Public\\*\n      - C:\\Windows\\Temp\\*\n      - C:\\Users\\*\\AppData\\Local\\Temp\\*\n  filter_legitimate_rundll32:\n    TargetFilename:\n      - \"*.dll\"\n      - \"*.cpl\"\n      - \"*.inf\"\n  condition: selection_cleanup_process and (selection_suspicious_extensions or selection_common_locations) and not filter_legitimate_rundll32\nfalsepositives:\n  - Legitimate software installers using rundll32 to clean up temporary installation files\n  - Administrative scripts performing automated maintenance in temp directories\n  - Antivirus or security software performing file operations\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "9ab9c379-3dcc-442c-bd46-f31a3bcd4c4e",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "TargetFilename"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/exfiltration_to_azure_blob_storage_via_azcopy_or_winscp.yml",
      "rule": {
        "id": "dba970c3-089e-43cb-a88e-75dce955b8ca",
        "title": "Exfiltration to Azure Blob Storage via AzCopy or WinSCP",
        "status": "experimental",
        "description": "Detects network connections to Azure Blob Storage endpoints initiated by tools commonly used for data exfiltration such as AzCopy, WinSCP, or Azure Storage Explorer. Attackers leverage these legitimate tools to move stolen data to attacker-controlled cloud infrastructure.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.exfiltration",
          "attack.t1567.002"
        ],
        "logsource": {
          "product": "windows",
          "category": "network_connection"
        },
        "detection": {
          "selection_tools": {
            "Image": [
              "*\\azcopy.exe",
              "*\\winscp.exe",
              "*\\StorageExplorer.exe"
            ]
          },
          "selection_destination": {
            "DestinationHostname": [
              "*.blob.core.windows.net*"
            ]
          },
          "selection_initiated": {
            "Initiated": [
              true
            ]
          },
          "filter_legitimate_admin": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "CloudAdmin*"
            ]
          },
          "condition": "(selection_tools and selection_destination and selection_initiated) and not filter_legitimate_admin"
        },
        "falsepositives": [
          "Legitimate use of AzCopy by database administrators for backups to Azure",
          "Authorized developers using Azure Storage Explorer for application debugging",
          "Automated cloud synchronization tasks using WinSCP to Azure endpoints"
        ],
        "level": "high",
        "raw": "title: Exfiltration to Azure Blob Storage via AzCopy or WinSCP\nid: dba970c3-089e-43cb-a88e-75dce955b8ca\nstatus: experimental\ndescription: Detects network connections to Azure Blob Storage endpoints initiated by tools commonly used for data exfiltration such as AzCopy, WinSCP, or Azure Storage Explorer. Attackers leverage these legitimate tools to move stolen data to attacker-controlled cloud infrastructure.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.exfiltration\n  - attack.t1567.002\nlogsource:\n  product: windows\n  category: network_connection\ndetection:\n  selection_tools:\n    Image:\n      - \"*\\\\azcopy.exe\"\n      - \"*\\\\winscp.exe\"\n      - \"*\\\\StorageExplorer.exe\"\n  selection_destination:\n    DestinationHostname:\n      - \"*.blob.core.windows.net*\"\n  selection_initiated:\n    Initiated:\n      - true\n  filter_legitimate_admin:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - CloudAdmin*\n  condition: (selection_tools and selection_destination and selection_initiated) and not filter_legitimate_admin\nfalsepositives:\n  - Legitimate use of AzCopy by database administrators for backups to Azure\n  - Authorized developers using Azure Storage Explorer for application debugging\n  - Automated cloud synchronization tasks using WinSCP to Azure endpoints\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "dba970c3-089e-43cb-a88e-75dce955b8ca",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "DestinationHostname",
          "Initiated",
          "User"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/persistence_via_chrome_updater_registry_run_key.yml",
      "rule": {
        "id": "12700bbc-d2ce-40bb-bd43-937ce24c82a4",
        "title": "Persistence via Chrome Updater Registry Run Key",
        "status": "experimental",
        "description": "Detects the creation of a suspicious 'Chrome Updater' registry value within the Windows Run keys, a technique used by Interlock malware and other threat actors to establish persistence. This specific implementation often points to non-standard files like .log files or malicious executables to ensure automatic execution upon user logon.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.persistence",
          "attack.t1547.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "registry_set"
        },
        "detection": {
          "selection_key_name": {
            "TargetObject": [
              "*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Chrome Updater",
              "*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Chrome"
            ]
          },
          "selection_suspicious_details": {
            "Details": [
              "*.log*",
              "*.tmp*",
              "*AppData\\Local\\Temp\\*",
              "*C:\\Users\\Public\\*"
            ]
          },
          "filter_legitimate_chrome": {
            "Details": [
              "*\\Google\\Chrome\\Application\\chrome.exe*",
              "*\\Google\\Update\\GoogleUpdate.exe*"
            ]
          },
          "condition": "selection_key_name and (selection_suspicious_details or not filter_legitimate_chrome)"
        },
        "falsepositives": [
          "Legitimate software updates that might use similar naming conventions (though Google Chrome typically uses 'Google Update' or 'Gupdate')",
          "Administrative scripts intentionally named to blend in with system processes"
        ],
        "level": "high",
        "raw": "title: Persistence via Chrome Updater Registry Run Key\nid: 12700bbc-d2ce-40bb-bd43-937ce24c82a4\nstatus: experimental\ndescription: Detects the creation of a suspicious 'Chrome Updater' registry value within the Windows Run keys, a technique used by Interlock malware and other threat actors to establish persistence. This specific implementation often points to non-standard files like .log files or malicious executables to ensure automatic execution upon user logon.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.persistence\n  - attack.t1547.001\nlogsource:\n  product: windows\n  category: registry_set\ndetection:\n  selection_key_name:\n    TargetObject:\n      - \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Chrome Updater\"\n      - \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Chrome\"\n  selection_suspicious_details:\n    Details:\n      - \"*.log*\"\n      - \"*.tmp*\"\n      - \"*AppData\\\\Local\\\\Temp\\\\*\"\n      - \"*C:\\\\Users\\\\Public\\\\*\"\n  filter_legitimate_chrome:\n    Details:\n      - \"*\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe*\"\n      - \"*\\\\Google\\\\Update\\\\GoogleUpdate.exe*\"\n  condition: selection_key_name and (selection_suspicious_details or not filter_legitimate_chrome)\nfalsepositives:\n  - Legitimate software updates that might use similar naming conventions (though Google Chrome typically uses 'Google Update' or 'Gupdate')\n  - Administrative scripts intentionally named to blend in with system processes\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "12700bbc-d2ce-40bb-bd43-937ce24c82a4",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "TargetObject",
          "Details"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/execution_of_suspicious_powershell_via_windows_run_dialog_clickfix.yml",
      "rule": {
        "id": "47197369-0dd2-42f5-980f-bd863f82f301",
        "title": "Execution of Suspicious PowerShell via Windows Run Dialog (ClickFix)",
        "status": "experimental",
        "description": "Detects the execution of PowerShell with encoded or obfuscated commands where the parent process is explorer.exe, a pattern highly indicative of 'ClickFix' social engineering. In this attack, users are tricked into pasting malicious commands into the Windows Run (Win+R) dialog box.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.execution",
          "attack.t1204.002",
          "attack.t1059.001"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_parent": {
            "ParentImage": [
              "*\\explorer.exe"
            ]
          },
          "selection_powershell": {
            "Image": [
              "*\\powershell.exe",
              "*\\pwsh.exe"
            ],
            "CommandLine": [
              "*-enc*",
              "*-EncodedCommand*",
              "*-e *"
            ]
          },
          "selection_clickfix_patterns": {
            "CommandLine": [
              "*FromBase64String*",
              "*Net.WebClient*",
              "*DownloadString*",
              "*Invoke-Expression*",
              "*iex*",
              "*mshta*",
              "*http*"
            ]
          },
          "filter_legitimate_scripts": {
            "CommandLine": [
              "*\\Program Files\\*",
              "*\\Windows\\System32\\*"
            ]
          },
          "condition": "selection_parent and selection_powershell and selection_clickfix_patterns and not filter_legitimate_scripts"
        },
        "falsepositives": [
          "PowerShell scripts manually executed by administrators via the Run dialog for troubleshooting",
          "Legacy internal tools that rely on explorer.exe to launch shell commands"
        ],
        "level": "high",
        "raw": "title: Execution of Suspicious PowerShell via Windows Run Dialog (ClickFix)\nid: 47197369-0dd2-42f5-980f-bd863f82f301\nstatus: experimental\ndescription: Detects the execution of PowerShell with encoded or obfuscated commands where the parent process is explorer.exe, a pattern highly indicative of 'ClickFix' social engineering. In this attack, users are tricked into pasting malicious commands into the Windows Run (Win+R) dialog box.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.execution\n  - attack.t1204.002\n  - attack.t1059.001\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_parent:\n    ParentImage:\n      - \"*\\\\explorer.exe\"\n  selection_powershell:\n    Image:\n      - \"*\\\\powershell.exe\"\n      - \"*\\\\pwsh.exe\"\n    CommandLine:\n      - \"*-enc*\"\n      - \"*-EncodedCommand*\"\n      - \"*-e *\"\n  selection_clickfix_patterns:\n    CommandLine:\n      - \"*FromBase64String*\"\n      - \"*Net.WebClient*\"\n      - \"*DownloadString*\"\n      - \"*Invoke-Expression*\"\n      - \"*iex*\"\n      - \"*mshta*\"\n      - \"*http*\"\n  filter_legitimate_scripts:\n    CommandLine:\n      - \"*\\\\Program Files\\\\*\"\n      - \"*\\\\Windows\\\\System32\\\\*\"\n  condition: selection_parent and selection_powershell and selection_clickfix_patterns and not filter_legitimate_scripts\nfalsepositives:\n  - PowerShell scripts manually executed by administrators via the Run dialog for troubleshooting\n  - Legacy internal tools that rely on explorer.exe to launch shell commands\nlevel: high\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "47197369-0dd2-42f5-980f-bd863f82f301",
        "format": "sigma",
        "overallScore": 8.8,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 7,
          "attackMapping": 8,
          "falsePosHandling": 7
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, ATT&CK mapping."
      },
      "fieldValidation": {
        "validFields": [
          "ParentImage",
          "Image",
          "CommandLine"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    },
    {
      "filePath": "rules/interlock/sigma/system_information_discovery_via_native_tools_and_powershell.yml",
      "rule": {
        "id": "07f5ad97-38ad-4b81-85e7-2e319e16a494",
        "title": "System Information Discovery via Native Tools and PowerShell",
        "status": "experimental",
        "description": "Detects the execution of multiple system discovery commands such as systeminfo, tasklist, and arp, or specific PowerShell enumeration cmdlets like Get-PSDrive. These are frequently used by attackers during the reconnaissance phase to identify system configurations, running services, and network topology.",
        "references": [],
        "author": "DetectForge",
        "date": "2026/02/11",
        "modified": "2026/02/11",
        "tags": [
          "attack.discovery",
          "attack.t1082",
          "attack.t1057",
          "attack.t1018",
          "attack.t1135"
        ],
        "logsource": {
          "product": "windows",
          "category": "process_creation"
        },
        "detection": {
          "selection_native_tools": {
            "Image": [
              "*\\systeminfo.exe",
              "*\\tasklist.exe",
              "*\\arp.exe"
            ],
            "CommandLine": [
              "* /svc*",
              "* -a*"
            ]
          },
          "selection_powershell_recon": {
            "CommandLine": [
              "*Get-PSDrive*",
              "*WindowsIdentity.GetCurrent()*",
              "*Get-Service*",
              "*Get-NetIPConfiguration*"
            ]
          },
          "filter_legitimate_admins": {
            "User": [
              "NT AUTHORITY\\SYSTEM",
              "NT AUTHORITY\\NETWORK SERVICE"
            ],
            "IntegrityLevel": [
              "System"
            ]
          },
          "condition": "(selection_native_tools or selection_powershell_recon) and not filter_legitimate_admins"
        },
        "falsepositives": [
          "System administration scripts for inventory management",
          "Help desk troubleshooting activities",
          "Security auditing tools or vulnerability scanners",
          "Software installers checking for system requirements"
        ],
        "level": "medium",
        "raw": "title: System Information Discovery via Native Tools and PowerShell\nid: 07f5ad97-38ad-4b81-85e7-2e319e16a494\nstatus: experimental\ndescription: Detects the execution of multiple system discovery commands such as systeminfo, tasklist, and arp, or specific PowerShell enumeration cmdlets like Get-PSDrive. These are frequently used by attackers during the reconnaissance phase to identify system configurations, running services, and network topology.\nauthor: DetectForge\ndate: 2026/02/11\nmodified: 2026/02/11\ntags:\n  - attack.discovery\n  - attack.t1082\n  - attack.t1057\n  - attack.t1018\n  - attack.t1135\nlogsource:\n  product: windows\n  category: process_creation\ndetection:\n  selection_native_tools:\n    Image:\n      - \"*\\\\systeminfo.exe\"\n      - \"*\\\\tasklist.exe\"\n      - \"*\\\\arp.exe\"\n    CommandLine:\n      - \"* /svc*\"\n      - \"* -a*\"\n  selection_powershell_recon:\n    CommandLine:\n      - \"*Get-PSDrive*\"\n      - \"*WindowsIdentity.GetCurrent()*\"\n      - \"*Get-Service*\"\n      - \"*Get-NetIPConfiguration*\"\n  filter_legitimate_admins:\n    User:\n      - NT AUTHORITY\\SYSTEM\n      - NT AUTHORITY\\NETWORK SERVICE\n    IntegrityLevel:\n      - System\n  condition: (selection_native_tools or selection_powershell_recon) and not filter_legitimate_admins\nfalsepositives:\n  - System administration scripts for inventory management\n  - Help desk troubleshooting activities\n  - Security auditing tools or vulnerability scanners\n  - Software installers checking for system requirements\nlevel: medium\n"
      },
      "validation": {
        "valid": true,
        "syntaxValid": true,
        "schemaValid": true,
        "errors": [],
        "warnings": []
      },
      "qualityScore": {
        "ruleId": "07f5ad97-38ad-4b81-85e7-2e319e16a494",
        "format": "sigma",
        "overallScore": 9.1,
        "dimensions": {
          "syntaxValidity": 10,
          "detectionLogic": 10,
          "documentation": 8,
          "attackMapping": 8,
          "falsePosHandling": 8
        },
        "explanation": "High quality rule with strong detection logic. Strongest areas: syntax validity, detection logic, documentation, ATT&CK mapping, false positive handling."
      },
      "fieldValidation": {
        "validFields": [
          "Image",
          "CommandLine",
          "User",
          "IntegrityLevel"
        ],
        "invalidFields": [],
        "fieldValidityRate": 1,
        "unknownLogsource": false
      }
    }
  ]
}