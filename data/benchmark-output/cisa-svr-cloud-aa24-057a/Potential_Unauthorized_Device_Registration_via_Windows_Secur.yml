title: Potential Unauthorized Device Registration via Windows Security Logs
id: 709dba92-acc6-4517-bd08-6b99113e1ee1
status: experimental
description: Detects potential unauthorized device registration or enrollment activity by monitoring for specific service-related events and logon patterns associated with device management. Attackers register unauthorized devices to bypass conditional access policies and maintain persistence within a cloud-integrated environment.
author: DetectForge
date: 2026/02/10
modified: 2026/02/10
tags:
  - attack.persistence
  - attack.t1098.005
logsource:
  product: windows
  service: security
detection:
  selection_device_service:
    EventID:
      - 4697
      - 4624
    ServiceName:
      - "*DeviceRegistrationService*"
      - "*DsSvc*"
      - "*Workplace Join Service*"
  selection_suspicious_logon:
    LogonType:
      - 3
      - 10
    IpAddress:
      - 127.0.0.1
      - ::1
  filter_internal_ips:
    IpAddress:
      - 10.*
      - 192.168.*
      - 172.16.*
      - 172.17.*
      - 172.18.*
      - 172.19.*
      - 172.20.*
      - 172.21.*
      - 172.22.*
      - 172.23.*
      - 172.24.*
      - 172.25.*
      - 172.26.*
      - 172.27.*
      - 172.28.*
      - 172.29.*
      - 172.30.*
      - 172.31.*
  condition: selection_device_service and not (selection_suspicious_logon or filter_internal_ips)
falsepositives:
  - Legitimate automated device enrollment during initial workstation setup
  - IT administrators performing bulk device registration for new hardware deployments
  - Users registering personal devices for Bring Your Own Device (BYOD) programs if permitted by policy
level: high
