title: LSASS Memory Credential Dumping via Mimikatz
id: c5473fab-d9a8-4b0a-b1e1-8d98d140c93b
status: experimental
description: >
  Detects credential dumping from LSASS memory using behavioral patterns
  including Mimikatz execution, comsvcs.dll MiniDump, encoded PowerShell
  targeting LSASS, and generic LSASS command-line references. Covers both
  direct tool execution and in-memory/encoded attack techniques.
author: DetectForge
date: 2026/02/10
modified: 2026/02/11
tags:
  - attack.credential_access
  - attack.t1003.001
logsource:
  product: windows
  category: process_creation
detection:
  selection_img:
    Image:
      - "*\\mimikatz.exe"
    OriginalFileName:
      - mimikatz.exe
  selection_cli:
    CommandLine:
      - "*sekurlsa::logonpasswords*"
      - "*sekurlsa::lsadump*"
      - "*sekurlsa::*"
      - "*privilege::debug*"
  selection_comsvcs:
    CommandLine|contains|all:
      - "comsvcs"
      - "MiniDump"
  selection_procdump:
    CommandLine|contains|all:
      - "procdump"
      - "lsass"
  selection_rundll_dump:
    Image|endswith: "\\rundll32.exe"
    CommandLine|contains:
      - "MiniDump"
  selection_encoded_ps:
    Image|endswith:
      - "\\powershell.exe"
      - "\\pwsh.exe"
    CommandLine|contains:
      - "-enc"
      - "-encodedcommand"
      - "-EncodedCommand"
  selection_parent_encoded_ps:
    ParentImage|endswith:
      - "\\powershell.exe"
      - "\\pwsh.exe"
    ParentCommandLine|contains:
      - "-enc"
      - "-encodedcommand"
      - "-EncodedCommand"
  selection_lsass_cmdline:
    CommandLine|contains: "lsass"
  filter_legitimate_admin:
    User:
      - NT AUTHORITY\SYSTEM
    ParentImage:
      - "*\\services.exe"
  filter_legitimate_tasklist:
    Image|endswith:
      - "\\tasklist.exe"
      - "\\taskmgr.exe"
      - "\\wmic.exe"
  condition: (selection_img or selection_cli or selection_comsvcs or selection_procdump or selection_rundll_dump or selection_encoded_ps or selection_parent_encoded_ps or selection_lsass_cmdline) and not filter_legitimate_admin and not filter_legitimate_tasklist
falsepositives:
  - Authorized penetration testing activities
  - Security researchers performing memory forensics
  - Task listing tools that reference lsass by name
  - Legacy administrative scripts (rare for Mimikatz)
level: critical
