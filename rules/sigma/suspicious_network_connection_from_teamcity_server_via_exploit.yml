title: Suspicious Network Connection from TeamCity Server via Exploit
id: fd4398ad-1fa7-4b40-a766-1d17f655bd88
status: experimental
description: Detects suspicious network connections initiated by the JetBrains TeamCity server process, which may indicate post-exploitation activity following the abuse of CVE-2023-42793. Attackers exploit this vulnerability to gain initial access and subsequently establish command and control or download additional payloads.
author: DetectForge
date: 2026/02/11
modified: 2026/02/11
tags:
  - attack.initial_access
  - attack.t1190
logsource:
  product: windows
  category: network_connection
detection:
  selection_teamcity_process:
    Image:
      - "*\\TeamCity\\bin\\tomcat8.exe"
      - "*\\TeamCity\\bin\\tomcat9.exe"
      - "*\\TeamCity\\jre\\bin\\java.exe"
    Initiated:
      - true
  selection_suspicious_destinations:
    DestinationPort:
      - 80
      - 443
      - 4444
      - 8080
      - 8888
  filter_internal_comms:
    DestinationIp:
      - 10.*
      - 192.168.*
      - 172.16.*
      - 172.17.*
      - 172.18.*
      - 172.19.*
      - 172.20.*
      - 172.21.*
      - 172.22.*
      - 172.23.*
      - 172.24.*
      - 172.25.*
      - 172.26.*
      - 172.27.*
      - 172.28.*
      - 172.29.*
      - 172.30.*
      - 172.31.*
      - 127.0.0.1
  filter_updates:
    DestinationHostname:
      - "*.jetbrains.com"
      - "*.apache.org"
      - "*.microsoft.com"
      - "*.ubuntu.com"
  condition: selection_teamcity_process and selection_suspicious_destinations and not (filter_internal_comms or filter_updates)
falsepositives:
  - Legitimate TeamCity plugins or integrations communicating with external APIs or version control systems (e.g., GitHub, GitLab, Bitbucket)
  - Automatic update checks performed by the TeamCity server or its underlying Java runtime environment
level: high
