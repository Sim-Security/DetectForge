title: Credential Exfiltration via Compromised Web Portal Network Connection
id: 2216adcf-8d60-4fec-aeed-84830812b54c
status: experimental
description: Detects suspicious outbound network connections from web server processes to external IP addresses on standard HTTP/HTTPS ports, indicative of credential exfiltration following modification of legitimate JavaScript files on VPN portals (T1056.003). Attackers compromise files such as lastauthserverused.js to intercept login form submissions, base64-encode harvested credentials, and exfiltrate them via GET requests to attacker-controlled domains. This rule identifies the network exfiltration phase by monitoring for unusual outbound connections from web server worker processes that deviate from expected internal traffic patterns.
author: DetectForge
date: 2026/02/11
modified: 2026/02/11
tags:
  - attack.credential_access
  - attack.t1056.003
logsource:
  product: windows
  service: security
detection:
  selection_web_process:
    EventID:
      - 5156
    ProcessName:
      - "*\\w3wp.exe"
      - "*\\nginx.exe"
      - "*\\httpd.exe"
      - "*\\tomcat*.exe"
      - "*\\php*.exe"
      - "*\\python*.exe"
  selection_exfil_channel:
    IpPort:
      - 80
      - 443
  filter_internal_dest:
    IpAddress:
      - 10.*
      - 172.16.*
      - 172.17.*
      - 172.18.*
      - 172.19.*
      - 172.20.*
      - 172.21.*
      - 172.22.*
      - 172.23.*
      - 172.24.*
      - 172.25.*
      - 172.26.*
      - 172.27.*
      - 172.28.*
      - 172.29.*
      - 172.30.*
      - 172.31.*
      - 192.168.*
      - 127.*
      - 169.254.*
      - ::1
      - fe80:*
      - fc00:*
      - fd00:*
  condition: selection_web_process and selection_exfil_channel and not filter_internal_dest
falsepositives:
  - Legitimate outbound connections from web servers to external APIs, content delivery networks (CDNs), or cloud-based management and monitoring services
  - Reverse proxy or load balancer configurations where the web server process legitimately connects to external backend application servers or health check endpoints
level: high
