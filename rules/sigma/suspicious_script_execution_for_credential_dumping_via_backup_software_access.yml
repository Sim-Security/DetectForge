title: Suspicious Script Execution for Credential Dumping via Backup Software Access
id: 01779099-0e38-4937-966e-ef6b5757c798
status: experimental
description: Detects the execution of scripting engines such as PowerShell or Command Prompt by non-system user accounts, which may indicate an attempt to dump credentials from backup software configuration databases. This behavior is commonly observed when attackers target Veeam and similar enterprise backup solutions using publicly available scripts to extract stored credentials from configuration files and databases.
author: DetectForge
date: 2026/02/11
modified: 2026/02/11
tags:
  - attack.credential_access
  - attack.t1555
logsource:
  product: windows
  service: security
detection:
  selection_event:
    EventID:
      - 4688
  selection_process:
    ProcessName:
      - "*\\powershell.exe"
      - "*\\pwsh.exe"
      - "*\\cmd.exe"
      - "*\\wscript.exe"
      - "*\\cscript.exe"
      - "*\\mshta.exe"
  filter_legitimate:
    SubjectUserName:
      - SYSTEM
      - NETWORK SERVICE
      - LOCAL SERVICE
  condition: selection_event and selection_process and not filter_legitimate
falsepositives:
  - Legitimate administrative scripts executed by backup operators or system administrators during scheduled maintenance or configuration updates
  - Automated deployment tools and configuration management agents (e.g., SCCM, Puppet, Ansible) executing scripts under service accounts not explicitly listed in the filter
level: high
