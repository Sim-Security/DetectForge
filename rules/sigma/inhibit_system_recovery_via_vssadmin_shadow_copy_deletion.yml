title: Inhibit System Recovery via Vssadmin Shadow Copy Deletion
id: f94c6e9f-15ec-4c1b-b2ce-f028a10d977c
status: experimental
description: Detects the use of vssadmin.exe to delete volume shadow copies, a common technique used by ransomware like Black Basta to prevent data recovery. The rule looks for the specific 'delete shadows' command-line arguments which are rarely used in legitimate administrative workflows.
author: DetectForge
date: 2026/02/11
modified: 2026/02/11
tags:
  - attack.impact
  - attack.t1490
logsource:
  product: windows
  category: process_creation
detection:
  selection_vssadmin:
    Image:
      - "*\\vssadmin.exe"
    OriginalFileName: VSSADMIN.EXE
  selection_args:
    CommandLine:
      - "*delete*shadows*"
      - "*/all*"
      - "*/quiet*"
  filter_legitimate_admin:
    ParentImage:
      - "*\\Windows\\System32\\msiexec.exe"
      - "*\\Windows\\System32\\wbem\\WmiPrvSE.exe"
    User:
      - NT AUTHORITY\SYSTEM
  condition: selection_vssadmin and selection_args and not filter_legitimate_admin
falsepositives:
  - Legitimate backup software or disaster recovery solutions that manage shadow copies as part of their cleanup routine
  - System administrators performing manual maintenance or troubleshooting of the Volume Shadow Copy Service
level: high
