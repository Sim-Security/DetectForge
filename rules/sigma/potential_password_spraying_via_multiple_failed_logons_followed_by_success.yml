title: Potential Password Spraying via Multiple Failed Logons Followed by Success
id: ac7b2dff-5a7e-42fd-aefa-5edc0b45a107
status: experimental
description: Detects a pattern of multiple failed logon attempts followed by a successful logon from the same source IP address. This behavior is characteristic of password spraying or brute force attacks where an actor attempts to gain initial access while avoiding account lockout policies.
author: DetectForge
date: 2026/02/11
modified: 2026/02/11
tags:
  - attack.initial_access
  - attack.t1110.003
logsource:
  product: windows
  service: security
detection:
  selection_logon_failures:
    EventID:
      - 4625
    LogonType:
      - 3
      - 10
    Status:
      - "0xC000006A"
      - "0xc000006d"
  selection_logon_success:
    EventID:
      - 4624
    LogonType:
      - 3
      - 10
  filter_internal_noise:
    IpAddress:
      - 127.0.0.1
      - ::1
    TargetUserName:
      - ANONYMOUS LOGON
      - "*$"
  filter_domain_controllers:
    SubjectUserName:
      - "*$"
    ServiceName:
      - krbtgt
  condition: (selection_logon_failures or selection_logon_success) | count(TargetUserName) by IpAddress > 5 and not filter_internal_noise and not filter_domain_controllers
falsepositives:
  - Legacy applications or service accounts with expired credentials attempting to authenticate across multiple nodes
  - Misconfigured vulnerability scanners or network inventory tools performing authenticated scans
  - Users who recently changed their password but have multiple mapped network drives or applications using cached old credentials
level: high
