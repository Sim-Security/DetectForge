title: Suspicious Outbound Connection from Web Server Processes via Exploitation
id: 624c87d5-5a5c-4713-8382-7f37cd27f222
status: experimental
description: Detects outbound network connections initiated by web server processes or scripting shells spawned by web servers following exploitation of public-facing applications. This behavior indicates potential command execution and C2 establishment following successful exploitation of vulnerabilities such as those in Ivanti Connect Secure VPN (CVE-2023-46805 and CVE-2024-21887).
author: DetectForge
date: 2026/02/11
modified: 2026/02/11
tags:
  - attack.initial_access
  - attack.t1190
  - attack.execution
  - attack.t1059
logsource:
  product: windows
  category: network_connection
detection:
  selection_process:
    Image:
      - "*\\w3wp.exe"
      - "*\\httpd.exe"
      - "*\\nginx.exe"
      - "*\\php-cgi.exe"
      - "*\\cmd.exe"
      - "*\\powershell.exe"
      - "*\\pwsh.exe"
      - "*\\python.exe"
      - "*\\perl.exe"
      - "*\\wscript.exe"
      - "*\\cscript.exe"
  selection_outbound:
    Initiated:
      - true
  filter_common_ports:
    DestinationPort:
      - 53
      - 80
      - 443
      - 123
      - 389
      - 636
      - 88
      - 445
      - 3389
  filter_internal_ips:
    DestinationIp:
      - 10.*
      - 172.16.*
      - 172.17.*
      - 172.18.*
      - 172.19.*
      - 172.20.*
      - 172.21.*
      - 172.22.*
      - 172.23.*
      - 172.24.*
      - 172.25.*
      - 172.26.*
      - 172.27.*
      - 172.28.*
      - 172.29.*
      - 172.30.*
      - 172.31.*
      - 192.168.*
      - 127.*
      - ::1
      - fe80:*
  condition: selection_process and selection_outbound and not filter_common_ports and not filter_internal_ips
falsepositives:
  - Web servers making legitimate outbound connections to backend databases, APIs, or update servers on non-standard ports
  - Administrative scripts executed by web servers for maintenance tasks that require external network access to specific internal hosts
level: high
