title: Suspicious Remote Symlink Evaluation Modification via Fsutil
id: c8160424-2860-47dc-b550-59a7eac0a5e8
status: experimental
description: >
  Detects fsutil.exe being used to modify symbolic link evaluation settings,
  specifically enabling remote-to-local (R2L) or remote-to-remote (R2R)
  symlink evaluation. Attackers such as BlackCat ransomware operators enable
  remote symlinks to traverse and encrypt files across network shares.
  This is a process_creation rule detecting the fsutil execution itself,
  not the subsequent network activity.
author: DetectForge
date: 2026/02/11
modified: 2026/02/12
tags:
  - attack.defense_evasion
  - attack.t1562
  - attack.lateral_movement
  - attack.t1021.002
logsource:
  product: windows
  category: process_creation
detection:
  selection_fsutil:
    Image|endswith: "\\fsutil.exe"
    CommandLine|contains|all:
      - "behavior"
      - "symlink"
  selection_enable_remote:
    CommandLine|contains:
      - "set SymlinkEvaluation R2L:1"
      - "set SymlinkEvaluation R2R:1"
      - "SymlinkEvaluation R2L:1"
      - "SymlinkEvaluation R2R:1"
  filter_system:
    ParentImage|endswith:
      - "\\svchost.exe"
      - "\\services.exe"
    User:
      - "NT AUTHORITY\\SYSTEM"
  condition: selection_fsutil and selection_enable_remote and not filter_system
falsepositives:
  - Administrative activity where symlink evaluation is modified for legitimate file share access
  - Storage migration scripts that temporarily enable remote symlink evaluation
level: high
